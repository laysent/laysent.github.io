{"data":{"site":{"siteMetadata":{"title":"LaySent's Site"}},"allMarkdownRemark":{"edges":[{"node":{"id":"05365d56-a756-56f8-8132-d6b6f77ab537","html":"<p>Glob 类似于 Regular Expression，主要的使用场景是用于批量的文件匹配，在 bash 或是配置文件中常常被使用。下面列举了一些常见的语法规则：</p>\n<ul>\n<li><code class=\"language-text\">*</code> 匹配任意多个字符（包括匹配零个）</li>\n<li><code class=\"language-text\">?</code> 匹配任意一个字符</li>\n<li><code class=\"language-text\">[abc]</code> 匹配方括号中的任意一个字符</li>\n<li><code class=\"language-text\">[!abc]</code> 或 <code class=\"language-text\">[^abc]</code> 匹配除了方括号中定义的三个字符外的任意字符</li>\n<li><code class=\"language-text\">[a-z]</code> 匹配方括号定义范围内的任意一个字符</li>\n<li><code class=\"language-text\">[!a-z]</code> 或 <code class=\"language-text\">[^a-z]</code> 匹配除了方括号定义范围内的任意一个字符</li>\n<li><code class=\"language-text\">{ab,cd,ef}</code> 匹配花括号中定义的三个字符串中的任意一个</li>\n</ul>\n<p>举个例子，如果 Jest 的单元测试文件命名规范的正则表达式是：<code class=\"language-text\">.+\\.(?:test|spec)\\.[tj]sx?$</code>，也就是匹配下面的这些文件：</p>\n<ul>\n<li>a.test.js</li>\n<li>b.test.jsx</li>\n<li>c.test.ts</li>\n<li>d.test.tsx</li>\n<li>e.spec.js</li>\n<li>f.spec.jsx</li>\n<li>g.spec.ts</li>\n<li>h.spec.tsx</li>\n</ul>\n<p>那么，相应的 Glob 可以写：<code class=\"language-text\">*.{test,spec}.{js,jsx,ts,tsx}</code>。</p>\n<p>如果不涉及到 React 的代码（没有 jsx），可以写成：<code class=\"language-text\">*.{test,spec}.[tj]s</code>。</p>\n<p>参考文档：</p>\n<ul>\n<li><a href=\"https://en.wikipedia.org/wiki/Glob_(programming)\">Wikipedia</a></li>\n<li><a href=\"http://www.jedit.org/users-guide/globs.html\">Glob Patterns</a></li>\n<li><a href=\"http://www.globtester.com/\">globtester</a></li>\n</ul>","frontmatter":{"date":"2019-06-02","title":"glob","category":"Bash"}}},{"node":{"id":"25c60151-a022-5098-8ea0-5c8eb172e4b3","html":"<p>以下整理了一些可用的占位图片服务：</p>\n<section><h2>lorempixel</h2><p>地址：<a href=\"http://lorempixel.com/\">http://lorempixel.com/</a></p><p>参考引用方法：</p><div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>http://lorempixel.com/400/200<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>placeholder image<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div><p>服务会返回随机的照片。可以通过参数选择需要返回的照片的类别（具体方法参考网站上的文档）。</p><p>效果：</p><img src=\"http://lorempixel.com/400/200\" alt=\"placeholder image\"></section>\n<section><h2>lorem picsum</h2><p>地址：<a href=\"https://picsum.photos/\">https://picsum.photos/</a></p><p>参考引用方法：</p><div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://picsum.photos/400/200<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>placeholder image<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div><p>服务会返回随机的照片。可以通过参数选择需要返回的照片的类别（具体方法参考网站上的文档）。</p><p>效果：</p><img src=\"https://picsum.photos/400/200\" alt=\"placeholder image\"></section>\n<section><h2>placeholder</h2><p>地址：<a href=\"https://placeholder.com\">https://placeholder.com</a></p><p>参考引用方法：</p><div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://via.placeholder.com/400x200.png<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">alt</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>placeholder image<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div><p>服务器会根据要求返回需要的图片，可以指定背景颜色/文字/大小等，具体配置的方法见网站上的文档。</p><p>效果：</p><img src=\"https://via.placeholder.com/400x200.png\" alt=\"placeholder image\"></section>\n<section><h2>其他</h2><p>其他可以参考的类似服务有：</p><ul>\n<li><a href=\"https://docs.imgix.com/apis/url/text/txt\">imgix</a></li>\n</ul></section>","frontmatter":{"date":"2019-05-31","title":"Placeholder Images","category":"Service"}}},{"node":{"id":"cfcc5715-dc41-5ff2-a216-1b5ae28c3f5f","html":"<p>默认情况下，Jest 配置文件中的 <code class=\"language-text\">transform</code> 属性，是不会被应用到 node_modules 目录下的。如果引用的库本身使用了非 JavaScript 文件（比如 CSS 文件），会造成 Jest 无法正确处理。</p>\n<p>一个可行的替代方案，是用 <code class=\"language-text\">moduleNameMapper</code> 来代替 <code class=\"language-text\">transform</code> 的功能。</p>\n<p>以 CSS 的处理为例：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  transform<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"^.+\\\\.(less|css)$\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jest-transform-stub\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上面这个是常规方案，但是对 CSS / Less 的处理不包含 node_modules 的部分。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  moduleNameMapper<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"^.+\\\\.(less|css)$\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jest-transform-stub\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上面这个方案，可以达到一样的效果，但是 node_module 内的 CSS 引用也会被正确的处理。</p>\n<p>两种方案没有优劣，主要是看使用的场景。</p>","frontmatter":{"date":"2019-05-30","title":"Transform node_modules in Jest","category":"JavaScript"}}},{"node":{"id":"fb7226ce-2605-5daf-87c4-e8147ba6cc32","html":"<p>一个网站的 Style Guide 可以方便的展示出基础 HTML 元素的样式，方便查看整体的效果。</p>\n<p>一些值得参考的 Style Guide</p>\n<ul>\n<li><a href=\"https://www.poormansstyleguide.com/\">Poor Man’s Style Guide</a></li>\n<li><a href=\"https://www.chenhuijing.com/styleguide/\">Chen Hui Jing’s Style Guide</a></li>\n</ul>\n<p>本网站使用的 <a href=\"/styleguide\">Style Guide</a>。</p>","frontmatter":{"date":"2019-05-29","title":"Style Guide","category":"HTML"}}},{"node":{"id":"f397fea6-d6b4-5fd1-b8f6-27f16b387261","html":"<p><code class=\"language-text\">npm</code> 和 <code class=\"language-text\">yarn</code> 都提供升级依赖的命令。</p>\n<p>针对 <code class=\"language-text\">npm</code>，可以使用 <code class=\"language-text\">npm update</code> 来执行，命令格式如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">npm update [-g] [&lt;pkg&gt;...]</code></pre></div>\n<p>更新的时候，默认会更新 <code class=\"language-text\">package.json</code> 文件，可以通过增加 <code class=\"language-text\">--no-save</code> 标记来禁用这一改动。</p>\n<p><code class=\"language-text\">npm</code> 的文档可以看<a href=\"https://docs.npmjs.com/cli/update\">这里</a>。</p>\n<p><code class=\"language-text\">yarn</code> 的命令会更加丰富一些，命令格式如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">yarn upgrade [package | package@tag | package@version | @scope/]... [--pattern]</code></pre></div>\n<p>其中，<code class=\"language-text\">--pattern</code> 后面可以跟 grep 的 pattern，只有匹配到的依赖会被升级。</p>\n<p>默认情况下，升级会参考 <code class=\"language-text\">package.json</code> 里定义的依赖允许的升级范围来选择可行的最高版本进行升级。如果希望直接升级到最新版本（往往意味着会有 breaking change），那么可以加上 <code class=\"language-text\">--latest</code> 标志。</p>\n<p><code class=\"language-text\">yarn</code> 的文档可以看<a href=\"https://yarnpkg.com/lang/en/docs/cli/upgrade/\">这里</a>。</p>","frontmatter":{"date":"2019-05-28","title":"Upgrade Npm Dependencies","category":"Bash"}}},{"node":{"id":"fc5319b0-0f0a-5ebf-9e57-069b0cbf41a4","html":"<p>以下 Bash 代码可以递归删除指定的 <code class=\"language-text\">.map</code> 文件。</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">find</span> <span class=\"token keyword\">.</span> -type f -name <span class=\"token string\">'*.map'</span> -delete</code></pre></div>\n<p>如果同时希望删除 <code class=\"language-text\">.map</code> 和 <code class=\"language-text\">.xxx</code> 文件，可以加上 <code class=\"language-text\">-o</code> flag</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">find</span> <span class=\"token keyword\">.</span> -type f -name <span class=\"token string\">'*.map'</span> -o -name <span class=\"token string\">'.*'</span> -delete</code></pre></div>\n<p>一些参数说明：</p>\n<ul>\n<li><code class=\"language-text\">-type f</code> 表示需要查找的是文件</li>\n<li><code class=\"language-text\">-name &#39;xxx&#39;</code> 定义需要匹配的文件名</li>\n<li><code class=\"language-text\">-o</code> 表示 or，后面可以跟新的匹配规则</li>\n<li><code class=\"language-text\">-delete</code> 表示匹配到的文件需要被删除</li>\n</ul>","frontmatter":{"date":"2019-05-27","title":"Recursively delete files by type","category":"Bash"}}},{"node":{"id":"2e9caaef-2c20-5c1c-91b9-6bc4f57f84bc","html":"<p><code class=\"language-text\">prefers-color-scheme</code> 这个 Media Query 可以用于检测当前的操作系统是否选择了 Dark Mode。这是一个依然处于初始草案阶段的功能（见 <a href=\"https://drafts.csswg.org/mediaqueries-5/#descdef-media-prefers-color-scheme\">Draft</a>），不过 Safari (12.1) / Chrome (76) / Firefox (67) 的最新版本都已经做了支持。</p>\n<p>示例代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@media</span> <span class=\"token punctuation\">(</span><span class=\"token property\">prefers-color-scheme</span><span class=\"token punctuation\">:</span> dark<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #333<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">:not(pre) > code[class*=\"language-\"]</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>255,229,100,0.8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>下面是一个可编辑的 CSS 代码，可以直接试一试：</p>\n<style>\nstyle.editable-style {\n  display: block;\n}\n</style>\n<p></p>\n<div class=\"gatsby-highlight\" style=\"border:1px solid red\">\n<pre class=\"language-css\"><code class=\"language-css\"><style contenteditable class=\"editable-style\">@media (prefers-color-scheme: dark) { body { /* try here */ } }</style></code></pre>\n</div>\n<p></p>\n<p>注：上面这段代码是可改的，修改后的 CSS 会直接生效。但是由于 <code class=\"language-text\">contenteditable</code> 的限制，所有代码需要在一行内完成。</p>\n<p>除了 <code class=\"language-text\">dark</code> 之外，<code class=\"language-text\">prefers-color-scheme</code> 可以接受的属性还有 <code class=\"language-text\">light</code> 和 <code class=\"language-text\">no-preference</code> 两种。其中，<code class=\"language-text\">light</code> 表示用户选择的是 Light 模式，<code class=\"language-text\">no-preference</code> 表示用户并没有做选择。</p>\n<p>在 JavaScript 中，也可以通过下面的代码来判断当前是否是 Dark Mode：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> ifDarkMode <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">matchMedia</span><span class=\"token punctuation\">(</span><span class=\"token string\">'(prefers-color-scheme: dark)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>matches<span class=\"token punctuation\">;</span></code></pre></div>\n<p>注：从当前的实验结果来看，<code class=\"language-text\">matchMedia</code> 的结果用 <code class=\"language-text\">.addListener</code> 注册回调事件并不能生效（Safari 12 测试）。</p>\n<p>如果图片的展示也需要区分，<code class=\"language-text\">mediaQuery</code> 也可以帮上忙：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>picture</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">srcset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>mojave-night.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">media</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>(prefers-color-scheme: dark)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>mojave-day.jpg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>picture</span><span class=\"token punctuation\">></span></span></code></pre></div>","frontmatter":{"date":"2019-05-24","title":"CSS for Dark Mode","category":"CSS"}}},{"node":{"id":"d88994f9-affc-55c4-9900-4567e4d96605","html":"<p>一直以来，<a href=\"https://github.com/ReactiveX/rxjs\">rxjs</a> 和 <a href=\"https://github.com/facebook/react\">react</a> 都不太搭，要在 React 中使用 rxjs 往往需要写并不怎么优雅的代码，比如：</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Example</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> initial <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      value<span class=\"token punctuation\">:</span> initial<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscription <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">.</span>value$ <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>value$<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">unregister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">unregister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscription <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>value$\n      <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">unregister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscription<span class=\"token punctuation\">)</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscription<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>Example value$<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">interval</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>上面这段代码，会根据 <code class=\"language-text\">value$</code> 这个 Observable 的数据，通过 React State 这个桥梁，去更新 UI。并且，代码考虑到了给定的 <code class=\"language-text\">value$</code> 可能后续变化的情况。如果不考虑后续 <code class=\"language-text\">props</code> 的修改，上面的代码依然需要在 <code class=\"language-text\">componentDidMount</code> 的时候注册回调并更新，然后在 <code class=\"language-text\">componentWillUnmount</code> 的时候注销，显得非常的啰嗦。</p>\n<p>LeetCode 提供的 <a href=\"https://github.com/LeetCode-OpenSource/rxjs-hooks\">rxjs-hooks</a> 提供了一个更为优雅的解决方案：</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Example</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> initial <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token function\">useObservable</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span>inputs$<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> inputs$<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>\n      <span class=\"token function\">switchMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>value$<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> value$<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    initial<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>value$<span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>Example value$<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">interval</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>rxjs-hooks 另外提供了 <code class=\"language-text\">useEventCallback</code> 来更好的处理事件流，具体可以查看官方的<a href=\"https://github.com/LeetCode-OpenSource/rxjs-hooks#useeventcallback\">文档</a>。</p>","frontmatter":{"date":"2019-05-23","title":"rxjs and hooks","category":"JavaScript"}}},{"node":{"id":"d56792bb-55db-5cb1-9c6b-2eb3542f617a","html":"<p>如果需要对目录下文件的占用空间做排序，可以使用下面的命令：</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">du</span> -d 3 -k <span class=\"token operator\">|</span> <span class=\"token function\">sort</span> -h</code></pre></div>\n<p>其中，<code class=\"language-text\">du -d 3</code> 表示，最多显示三层子目录，<code class=\"language-text\">-k</code> 会让输出以 <code class=\"language-text\">KB</code> 作为单位。<code class=\"language-text\">sort -h</code> 会对结果进行排序，排序的依据是文件夹的大小。这里，排序需要带上 <code class=\"language-text\">-h</code> 的标识位，不然以字符串进行排序的话，输出没有意义（比如，100 会排在 9 的前面）。</p>","frontmatter":{"date":"2019-05-22","title":"Disk Usage of Folder","category":"Bash"}}},{"node":{"id":"1fb93b09-bdfc-53b8-9493-0716267f233a","html":"<p>假设有一个 TypeScript 的类型是：</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Example</span> <span class=\"token punctuation\">{</span>\n  str<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">;</span>\n  num<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">;</span>\n  func1<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>param1<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> param2<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  func2<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>以下这个 TypeScript 的定义，可以用于将 <code class=\"language-text\">T</code> 中函数的部分抽离出来，形成新的类型：</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> Pick<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">K</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">keyof</span> <span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span><span class=\"token constant\">P</span> <span class=\"token keyword\">in</span> <span class=\"token constant\">K</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token constant\">P</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">type</span> FunctionPropertyNames<span class=\"token operator\">&lt;</span><span class=\"token constant\">T</span><span class=\"token operator\">></span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token punctuation\">[</span><span class=\"token constant\">K</span> <span class=\"token keyword\">in</span> keyof <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token constant\">T</span><span class=\"token punctuation\">[</span><span class=\"token constant\">K</span><span class=\"token punctuation\">]</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Function</span> <span class=\"token operator\">?</span> <span class=\"token constant\">K</span> <span class=\"token punctuation\">:</span> never<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">[</span>keyof <span class=\"token constant\">T</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>最终，新类型的定义如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">type</span> Result <span class=\"token operator\">=</span> Pick<span class=\"token operator\">&lt;</span>Example<span class=\"token punctuation\">,</span> FunctionPropertyNames<span class=\"token operator\">&lt;</span>Example<span class=\"token operator\">>></span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>等价于：</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">Equivalent</span> <span class=\"token punctuation\">{</span>\n  func1<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span>param1<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span><span class=\"token punctuation\">,</span> param2<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  func2<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">void</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"date":"2019-05-21","title":"Extract all function properties from given type","category":"TypeScript"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":true}}
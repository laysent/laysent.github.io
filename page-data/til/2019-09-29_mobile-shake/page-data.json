{"componentChunkName":"component---src-templates-til-js","path":"/til/2019-09-29_mobile-shake","result":{"data":{"markdownRemark":{"id":"27ff91be-e0ae-5169-a594-b6e813c36527","html":"<p>JavaScript 中提供了 <code class=\"language-text\">devicemotion</code> 事件，可以用于监听设备各个方向上受到的力（加速度）。有了这个事件，就可以用于判断当前用户是否在进行类似“摇一摇”之类的操作，方便开发基于特定交互的一些功能。</p>\n<p>具体来说，<code class=\"language-text\">devicemotion</code> 事件会提供 <code class=\"language-text\">accelerationIncludingGravity</code> 数据，作为一个对象分别提供 <code class=\"language-text\">x</code>，<code class=\"language-text\">y</code> 和 <code class=\"language-text\">z</code> 三个方向上的加速度。通过不同时间点上加速度值的不同，就可以判断当前用户是否在进行摇晃手机的操作了。</p>\n<p>使用 <code class=\"language-text\">devicemotion</code> 的示例代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>accelerationIncludingGravity<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// do stuff here</span>\n<span class=\"token punctuation\">}</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'devicemotion'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>判断是否在摇晃手机，简单来说，只需要判断当前的各方向加速度之差，是否有至少两个超过了给定的阈值。<a href=\"https://github.com/alexgibson/shake.js\">shake.js</a> 中就使用了这样的方法来判断当前用户是否在摇晃手机，具体的代码可以参考<a href=\"https://github.com/alexgibson/shake.js/blob/d232eee7a5f31e9fd37aa79aa83f1f206035ccc9/shake.js#L104\">源码</a>。</p>\n<p><code class=\"language-text\">devicemotion</code> 更多的信息，可以参考 <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/devicemotion_event\">MDN</a>。</p>","frontmatter":{"title":"Mobile Shake","category":"JavaScript","date":"2019-09-29"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"time":"2019-09-29","title":"Mobile Shake","previous":{"time":"2019-09-27","title":"SourceMap in Webpack"},"next":{"time":"2019-09-30","title":"Performance Measure"}}}}
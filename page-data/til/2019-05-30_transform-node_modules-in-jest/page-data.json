{"componentChunkName":"component---src-templates-til-js","path":"/til/2019-05-30_transform-node_modules-in-jest","result":{"data":{"markdownRemark":{"id":"222c8e73-0ed7-5131-a264-185f704ea6de","html":"<p>默认情况下，Jest 配置文件中的 <code class=\"language-text\">transform</code> 属性，是不会被应用到 node_modules 目录下的。如果引用的库本身使用了非 JavaScript 文件（比如 CSS 文件），会造成 Jest 无法正确处理。</p>\n<p>一个可行的替代方案，是用 <code class=\"language-text\">moduleNameMapper</code> 来代替 <code class=\"language-text\">transform</code> 的功能。</p>\n<p>以 CSS 的处理为例：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  transform<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"^.+\\\\.(less|css)$\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jest-transform-stub\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上面这个是常规方案，但是对 CSS / Less 的处理不包含 node_modules 的部分。</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  moduleNameMapper<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"^.+\\\\.(less|css)$\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jest-transform-stub\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>上面这个方案，可以达到一样的效果，但是 node_module 内的 CSS 引用也会被正确的处理。</p>\n<p>两种方案没有优劣，主要是看使用的场景。</p>","frontmatter":{"title":"Transform node_modules in Jest","category":"JavaScript","date":"2019-05-30"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"time":"2019-05-30","title":"Transform node_modules in Jest","previous":{"time":"2019-05-29","title":"Style Guide"},"next":{"time":"2019-05-31","title":"Placeholder Images"}}}}
{"componentChunkName":"component---src-templates-til-category-js","path":"/til/category/javascript","result":{"data":{"site":{"siteMetadata":{"title":"LaySent's Site"}},"allMarkdownRemark":{"edges":[{"node":{"id":"265be941-4b2a-5bcb-b8e5-b5bb85a52bb5","html":"<p>åœ¨ JavaScript çš„ DOM äº‹ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code class=\"language-text\">.stopPropagation</code> æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡ã€‚æ¯”å¦‚ï¼Œå¦‚æœæœ‰å¦‚ä¸‹çš„ä¸€ä¸ª DOM ç»“æ„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>parent</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>child</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>åŒæ—¶æœ‰å¦‚ä¸‹çš„ JavaScript ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> parent <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'parent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> child <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'child'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nparent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nchild<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (child): capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nchild<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (child): bubble'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nparent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): bubble'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é‚£ä¹ˆï¼Œç‚¹å‡» child å…ƒç´ ï¼Œconsole ä¸­çš„è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">click(parent): capture\nclick(child): capture\nclick(child): bubble\nclick(parent): bubble</code></pre></div>\n<p>è¿™é‡Œï¼Œä»£ç æœ‰æ„ä¿æŒè¾“å‡ºé¡ºåºå’Œå›è°ƒå‡½æ•°æ³¨å†Œé¡ºåºçš„ä¸€è‡´æ€§ã€‚å¦‚æœåœ¨ä¸Šé¢å››ä¸ªå›è°ƒå‡½æ•°ä¸­ä¾æ¬¡åŠ ä¸Š <code class=\"language-text\">event.stopPropagation()</code>ï¼Œé‚£ä¹ˆä¹‹åæ‰€æœ‰çš„å†…å®¹å°†ä¸ä¼šåœ¨ç»§ç»­è¾“å‡ºã€‚</p>\n<p>ä»¥ä¸Šæ˜¯å…³äº DOM ä¸­å†’æ³¡å’Œæ•è·äº‹ä»¶å¤„ç†çš„ä¸€èˆ¬æµç¨‹ã€‚è¿™é‡Œï¼Œå¦‚æœåœ¨ä¸€ä¸ª DOM èŠ‚ç‚¹ä¸Šæ³¨å†Œäº†ä¸æ­¢ä¸€ä¸ªçš„äº‹ä»¶å›è°ƒå‡½æ•°ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°†æŒ‰ç…§äº‹ä»¶æ³¨å†Œçš„å…ˆåé¡ºåºï¼Œä¾æ¬¡æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œ<code class=\"language-text\">event.stopPropagation()</code> æ˜¯æ— æ³•é˜»æ­¢åŒçº§å›è°ƒå‡½æ•°è¢«æ‰§è¡Œçš„ã€‚ç®€å•å°†ä¸Šé¢çš„ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æµ‹è¯•ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">parent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): first capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nparent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): second capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nchild<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (child): capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é‚£ä¹ˆï¼Œåœ¨ç‚¹å‡» child å…ƒç´ çš„æ—¶å€™ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„è¾“å‡ºç»“æœï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">click (parent): first capture\nclick (parent): second capture</code></pre></div>\n<p>parent ä¸Šçš„ click å›è°ƒå‡½æ•°éƒ½ä¾æ¬¡æ‰§è¡Œå®Œæ¯•äº†ï¼Œè€Œ child ä¸Šçš„éƒ¨åˆ†åˆ™å› ä¸º <code class=\"language-text\">event.stopPropagation()</code> æ²¡æœ‰è¢«æ‰§è¡Œåˆ°ã€‚è¿™é‡Œï¼Œå¦‚æœå¸Œæœ›è¿åŒå±‚çš„å…¶ä»–å›è°ƒå‡½æ•°ä¹Ÿä¸è¦ç»§ç»­æ‰§è¡Œï¼Œå¯ä»¥æ”¹ç”¨ <code class=\"language-text\">event.stopImmediatePropagation()</code>ï¼Œä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">parent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">stopImmediatePropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): first capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nparent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): second capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nchild<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (child): capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¿®æ”¹åçš„ä»£ç ï¼Œæ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">click (parent): first capture</code></pre></div>\n<p>å‡ ç‚¹è¯´æ˜ï¼š</p>\n<ol>\n<li>React çš„åˆæˆäº‹ä»¶åªæœ‰ <code class=\"language-text\">stopPropagation</code> æ²¡æœ‰ <code class=\"language-text\">stopImmediatePropagation</code>ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨çš„è¯ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹çš„æ–¹æ³•è°ƒç”¨çœŸæ­£çš„ DOM APIï¼š<code class=\"language-text\">.nativeEvent.stopImmediatePropagation</code>ã€‚è¿™é‡Œ React ä¸éœ€è¦ <code class=\"language-text\">stopImmediatePropagation</code> çš„ç†ç”±éå¸¸ç®€å•ï¼Œå› ä¸ºåœ¨ JSX ä¸­ï¼Œæ¯ä¸ªäº‹ä»¶åœ¨ Component ä¸Šåªèƒ½ç»‘å®šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå› æ­¤ <code class=\"language-text\">stopImmediatePropagation</code> æ˜¯å¤šä½™çš„ï¼›</li>\n<li>ç”±äºæµè§ˆå™¨å¤©ç„¶ç»´æŠ¤äº†ä¸€ä¸ª EventListener çš„é˜Ÿåˆ—ç”¨äºæŒ‰é¡ºåºæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œ<code class=\"language-text\">stopImmediatePropagation</code> é…åˆä¸Šå›è°ƒå‡½æ•°çš„æ³¨é”€ï¼ˆ<code class=\"language-text\">removeEventListener</code>ï¼‰ï¼Œå¯ä»¥ç”¨äºå°æˆæœ¬å®ç°ä¸€ä¸ª FIFO çš„é˜Ÿåˆ—ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dom</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>key <span class=\"token operator\">!==</span> <span class=\"token string\">'Escape'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">stopImmediatePropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keydown'</span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    dom<span class=\"token punctuation\">.</span>attributeStyleMap<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'display'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  dom<span class=\"token punctuation\">.</span>attributeStyleMap<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'display'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keydown'</span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nArray<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ul li'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>register<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä»¥ä¸Šä»£ç æ‰§è¡Œåï¼ŒæŒ‰ä¸‹ ESC é”®ï¼Œå°†ä¼šä¾æ¬¡å°† <code class=\"language-text\">ul</code> ä¸‹çš„ <code class=\"language-text\">li</code> å…ƒç´ ä¸€ä¸ªä¸€ä¸ªçš„éšè—ã€‚</p>\n<ol start=\"3\">\n<li><code class=\"language-text\">stopImmediatePropagation</code> API çš„æµè§ˆå™¨æ”¯æŒæ¯”è¾ƒå¥½ï¼Œåœ¨ IE 9 åŠä»¥ä¸Šçš„æµè§ˆå™¨ä¸­éƒ½å¯ä»¥ä½¿ç”¨ï¼Œå‚è€ƒ <a href=\"https://caniuse.com/#search=stopimmediatepropagation\">Can I Use</a>ï¼›</li>\n<li>æ›´å¤šå…³äºè¿™ä¸ª API çš„ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Event/stopImmediatePropagation\">MDN</a>ã€‚</li>\n</ol>","frontmatter":{"date":"2019-11-17","title":"stopImmediatePropagation","category":"JavaScript"}}},{"node":{"id":"17386daf-da8d-53b5-8e80-73d9d610875a","html":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">\b<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'incorrect statement'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'correct statement'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¸Šé¢çš„è¿™æ®µä»£ç ï¼Œçœ‹ä¸Šå»ä¸¤ä¸ª <code class=\"language-text\">if</code> è¯­å¥å¹¶æ— å·®åˆ«ã€‚ä½†æ˜¯åœ¨å®é™…æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå´ä¼šå‘ç°ï¼Œç¬¬ä¸€ä¸ª <code class=\"language-text\">if</code> è¯­å¥æœ‰è¯­æ³•æŠ¥é”™ï¼Œè€Œç¬¬äºŒä¸ª <code class=\"language-text\">if</code> è¯­å¥å´æ²¡æœ‰ã€‚TypeScript ç»™å‡ºçš„æŠ¥é”™ä¿¡æ¯æ˜¯ï¼š<code class=\"language-text\">Invalid character.(1127)</code>ã€‚</p>\n<p>â€œçœ‹ä¸Šå»â€ä¸€æ ·çš„ä»£ç ï¼Œåœ¨è§£é‡Šå™¨çœ‹æ¥å´éå¸¸ä¸åŒã€‚ç©¶å…¶åŸå› ï¼Œæ˜¯å› ä¸ºç¬¬ä¸€ä¸ª <code class=\"language-text\">if</code> è¯­å¥ä¸­ï¼Œæœ‰ä¸€ä¸ªâ€œçœ‹ä¸è§â€çš„å­—ç¬¦ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\bif (true) {</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ‰§è¡Œä¸Šé¢çš„è¿™æ®µä»£ç ï¼Œä¼šçœ‹åˆ°åœ¨ console ä¸­è¾“å‡º 8ã€‚è¿™é‡Œï¼Œ8 æ˜¯ Backspace çš„ ASCII ç ç¼–å·ã€‚åœ¨å¾ˆå¤šçš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œè¿™ç±»ç‰¹æ®Šå­—ç¬¦å¹¶ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œä½†å¯¹äºè§£é‡Šå™¨æ¥è¯´ï¼Œè¿™ä¸ªå­—ç¬¦ç¡®å®çœŸæ˜¯å­˜åœ¨çš„ã€‚ï¼ˆå½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ–‡æœ¬ç¼–è¾‘å™¨éƒ½ä¸ä¼šæ˜¾ç¤ºï¼Œæ¯”å¦‚æŠŠä¸Šé¢çš„ä»£ç å¤åˆ¶åˆ° Chrome DevTools ä¸­ï¼Œå°±ä¼šçœ‹åˆ°ä¸€ä¸ª <code class=\"language-text\">ğŸ”´</code> ç¬¦å·ï¼Œç”¨äºè¡¨ç¤ºè¿™ä¸ªçœ‹ä¸è§çš„ Backspaceï¼‰</p>\n<p>è¿™ä¸€ç±»çš„ç‰¹æ®Šå­—ç¬¦é™¤äº† Backspace è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ Unicode ä¸­çš„é›¶å®½ç©ºæ ¼ï¼ˆU+200bï¼‰ã€å·¦è‡³å³ç¬¦å·ï¼ˆU+200eï¼‰ã€å³è‡³å·¦ç¬¦å·ï¼ˆU+200fï¼‰ç­‰ã€‚</p>","frontmatter":{"date":"2019-11-13","title":"Invisible Characters","category":"JavaScript"}}},{"node":{"id":"d7ace064-8159-5fe0-ba4d-0b04683a001d","html":"<p>åœ¨ JavaScript ä¸­ï¼Œæ–°çš„<a href=\"https://github.com/tc39/proposal-object-rest-spread\">è§„èŒƒ</a>å®šä¹‰äº† object rest spread è¿ç®—ç¬¦ï¼Œå¯ä»¥ç”¨äºå¯¹è±¡çš„è§£æ„ã€‚</p>\n<p>ç®€å•çš„ç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> others<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é™¤äº†è¿™ç§è§£æ„åŒæ—¶èµ‹å€¼ç»™æ–°å˜é‡çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥é€šè¿‡è§£æ„è¿ç®—ï¼Œèµ‹å€¼ç»™ä¸€ä¸ªå·²æœ‰çš„å˜é‡ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token string\">'old'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">:</span> <span class=\"token string\">'new'</span><span class=\"token punctuation\">,</span> others<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè§£æ„åŠ èµ‹å€¼çš„è¿ç®—ï¼Œå¿…é¡»è¦åŠ ä¸Šæ‹¬å·ã€‚ä¸‹é¢çš„å†™æ³•ä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token string\">'old'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">:</span> <span class=\"token string\">'new'</span><span class=\"token punctuation\">,</span> others<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¼šæŠ¥é”™çš„åŸå› æ˜¯ï¼Œå‰é¢çš„ <code class=\"language-text\">{ value } =</code>ï¼Œå¦‚æœä¸åŠ ä¸Šæ‹¬å·ï¼Œä¼šè¢«å½“æˆä¸€èˆ¬çš„ä»£ç å—ï¼ˆBlockï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè§£æ„çš„å¯¹è±¡ï¼ˆObjectï¼‰ï¼Œå› æ­¤è§£æè¯­æ³•æ ‘çš„æ—¶å€™ï¼Œåœ¨ <code class=\"language-text\">=</code> è¿™é‡Œå°±æŠ¥é”™äº†ï¼ˆ<code class=\"language-text\">Uncaught SyntaxError: Unexpected token &#39;=&#39;</code>ï¼‰ã€‚æ³¨ï¼šå¦‚æœä¸åŠ æœ€åçš„ <code class=\"language-text\">;</code>ï¼Œè¯­æ³•ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</p>\n<p>æ›´å¤šç›¸å…³çš„ç›¸å…³ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Object_destructuring\">MDN</a>ã€‚</p>","frontmatter":{"date":"2019-11-07","title":"Object Deconstructing without Declaration","category":"JavaScript"}}},{"node":{"id":"4c12371e-1261-52ed-8522-aacc2f3a7626","html":"<p><code class=\"language-text\">console.assert</code> API å¯ä»¥ç”¨äºåˆ¤æ–­æŸä¸ªæ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œå¹¶åœ¨ä¸æ»¡è¶³çš„æ—¶å€™ï¼Œåœ¨ Console é‡Œæ‰“å°å‡ºç›¸å…³çš„æ•°æ®ã€‚æ•´ä½“ API å’Œ <code class=\"language-text\">console.error</code> æ¯”è¾ƒç±»ä¼¼ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ã€‚æ•´ä¸ªè°ƒç”¨ï¼Œåªä¼šåœ¨ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ falsy å€¼çš„æ—¶å€™ï¼Œæ‰ä¼šå°†åé¢çš„æ•°æ®æ‰“å°å‡ºæ¥ã€‚æ‰“å°çš„æ–¹å¼å’Œ <code class=\"language-text\">console.error</code> ç±»ä¼¼ï¼Œè¾“å‡ºçš„æ˜¯ error ä¿¡æ¯ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæ ¹æ® <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Console/assert\">MDN</a> çš„æè¿°ï¼Œåœ¨ Node.js 10 ç‰ˆæœ¬å‰ï¼Œé™¤äº†è¾“å‡ºä¹‹å¤–ï¼Œè¿˜ä¼šæŠ›å‡ºä¸€ä¸ª <code class=\"language-text\">AssertionError</code>ã€‚è¿™ä¸ªè¡Œä¸ºæ˜¯é”™è¯¯çš„ï¼Œconsole API ä¸åº”è¯¥å½±å“ä¸»æµç¨‹çš„ä»£ç ï¼ŒNode.js åœ¨ 10 ä¿®å¤äº†é—®é¢˜ã€‚</p>\n<p>ä¸‹é¢æ˜¯ä¸€æ®µç¤ºä¾‹ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'before'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">assert</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'incorrect with error message'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'after'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¾“å‡ºçš„ç»“æœæ˜¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">before\nincorrect with error message\nafter</code></pre></div>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">incorrect with error message</code> è¿™ä¸€æ¡ï¼Œè¿˜ä¼šé¢å¤–è¾“å‡ºè°ƒç”¨çš„å †æ ˆä¿¡æ¯ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚</p>\n<p>æ€»ç»“æ¥è¯´ï¼Œåœ¨ä»£ç ä¸­å®ç°ç±»ä¼¼ Chrome ä¸­ conditional breakpointï¼Œä½¿ç”¨ <code class=\"language-text\">console.assert</code> æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼šåªåœ¨å‡ºç°é—®é¢˜çš„æ—¶å€™æ‰“å°å¿…è¦çš„ä¿¡æ¯ï¼Œå¯ä»¥å°½å¯èƒ½çš„å‡å°‘å¯¹ Console è¾“å‡ºçš„æ±¡æŸ“ã€‚</p>","frontmatter":{"date":"2019-11-05","title":"console.assert","category":"JavaScript"}}},{"node":{"id":"df525546-37d6-5170-90fd-2fe8e78bc734","html":"<p><code class=\"language-text\">console.trace</code> API æ”¯æŒå¯é€‰å‚æ•°ï¼Œè¾“å‡ºçš„æ•ˆæœå’Œ <code class=\"language-text\">console.log</code> / <code class=\"language-text\">console.info</code> ç±»ä¼¼ã€‚ä½†æ˜¯é™¤äº†è¾“å‡ºå‚æ•°æŒ‡å®šçš„å†…å®¹ä¹‹å¤–ï¼Œè¿˜ä¼šè¿å¸¦å°†å½“å‰çš„è°ƒç”¨å †æ ˆä¸€èµ·è¾“å‡ºã€‚å¯ä»¥çœ‹ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Console/trace\">MDN</a> ä¸­ç»™å‡ºçš„ä¸€ä¸ªä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">trace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¾“å‡ºçš„ç»“æœç±»ä¼¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">bar\nfoo\n&lt;anonymous&gt;</code></pre></div>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">&lt;anonymous&gt;</code> æ˜¯å› ä¸º <code class=\"language-text\">foo</code> å‡½æ•°æ˜¯åœ¨ console ä¸­ç›´æ¥è¿è¡Œçš„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåªèƒ½åœ¨è°ƒè¯•é˜¶æ®µè¿›è¡Œä»£ç çš„æ£€æŸ¥ã€‚å¦‚æœéœ€è¦åœ¨çº¿ä¸Šç¯å¢ƒï¼Œå¯¹å¯èƒ½å‡ºé—®é¢˜çš„åœ°æ–¹æ”¶é›†è°ƒç”¨å †æ ˆä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨ <code class=\"language-text\">console.trace</code> å°±ä¸æ»¡è¶³éœ€æ±‚äº†ã€‚å¯ä»¥è½¬è€Œä½¿ç”¨ Error ä¸­çš„ stack å­—æ®µï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> error <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¾“å‡ºç»“æœç±»ä¼¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">Error\n    at bar (&lt;anonymous&gt;:3:19)\n    at foo (&lt;anonymous&gt;:6:3)\n    at &lt;anonymous&gt;:9:1</code></pre></div>","frontmatter":{"date":"2019-11-04","title":"console.trace","category":"JavaScript"}}},{"node":{"id":"332fb33c-4a96-53f4-bc6b-152610186b51","html":"<p>Mobx ä¸­ï¼Œå¯ä»¥ç›´æ¥é€šè¿‡ <code class=\"language-text\">observable</code> çš„æ–¹å¼æ¥æ§åˆ¶å†…éƒ¨çš„ stateï¼Œè€Œä¸å†ä½¿ç”¨ React è‡ªå¸¦çš„ state åŠŸèƒ½ã€‚ä¸€èˆ¬çš„å†™æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> React <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> observer <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> observable <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx'</span><span class=\"token punctuation\">;</span>\n\n@observer\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Demo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  @observable num<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function-variable function\">onClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">Clicked: </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™æ ·å†™çš„ä¼˜åŠ¿åœ¨äºï¼Œå¯ä»¥å°†ä½•æ—¶æ¸²æŸ“çš„åˆ¤æ–­äº¤ç»™äº† Mobx å»å¤„ç†ï¼Œä¸ç”¨æ‰‹åŠ¨å»å¤„ç†ã€‚</p>\n<p>å¯¹äºéœ€è¦ç”¨åˆ° <code class=\"language-text\">observable</code> ç»„åˆæ•°æ®çš„æƒ…å†µï¼Œå¯ä»¥ä½¿ç”¨ <code class=\"language-text\">computed</code> æ¥ç”Ÿæˆä¸€ä¸ªæ–°çš„ <code class=\"language-text\">observable</code> å€¼ï¼Œä¹Ÿå¯ä»¥ç›´æ¥ä½¿ç”¨ getter å‡½æ•°ã€‚ä»¥ä¸‹çš„ä¸¤ä¸ªæ–¹æ¡ˆåœ¨æ•ˆæœä¸Šæ˜¯ç­‰ä»·çš„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\">@observer\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Demo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  @observable num<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function-variable function\">onClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">get</span> <span class=\"token function\">isMany</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num <span class=\"token operator\">></span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        Clicked </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isMany <span class=\"token operator\">?</span> <span class=\"token string\">'many'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'few'</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<div class=\"gatsby-highlight\" data-language=\"tsx\"><pre class=\"language-tsx\"><code class=\"language-tsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> observable<span class=\"token punctuation\">,</span> computed <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx'</span><span class=\"token punctuation\">;</span>\n\n@observer\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Demo</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  @observable num<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function-variable function\">onClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num <span class=\"token operator\">+=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  @computed\n  <span class=\"token keyword\">get</span> <span class=\"token function\">isMany</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>num <span class=\"token operator\">></span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>onClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        Clicked </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>isMany <span class=\"token operator\">?</span> <span class=\"token string\">'many'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'few'</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\"> times\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¹‹æ‰€ä»¥ä¸¤è€…æ˜¯ç­‰ä»·çš„ï¼Œç†ç”±å¾ˆç®€å•ã€‚åœ¨æ‰§è¡Œ render å‡½æ•°çš„æ—¶å€™ï¼ŒMobx æ³¨æ„åˆ° <code class=\"language-text\">this.isMany</code> è¢«ä½¿ç”¨äº†ï¼Œè€Œåœ¨è°ƒç”¨è¿™ä¸ª getter å‡½æ•°çš„æ—¶å€™ï¼Œå®é™…ä½¿ç”¨åˆ°äº† <code class=\"language-text\">this.num</code> è¿™ä¸ª observableã€‚å› æ­¤ï¼Œå½“ <code class=\"language-text\">this.num</code> å‘ç”Ÿäº†å˜åŒ–ä¹‹åï¼ŒMobx çŸ¥é“éœ€è¦é‡æ–°è°ƒç”¨ render å‡½æ•°è¿›è¡Œç»˜åˆ¶ã€‚è€Œå¯¹äºä½¿ç”¨äº† computed çš„æƒ…å†µæ¥è¯´ï¼Œæƒ…å†µä¼šæ›´ç®€å•ä¸€äº›ï¼Œ<code class=\"language-text\">this.num</code> è¿™ä¸ª observable çš„å˜åŒ–è§¦å‘äº† <code class=\"language-text\">this.isMany</code> çš„é‡æ–°è®¡ç®—ï¼Œæœ€ç»ˆåœ¨ <code class=\"language-text\">this.isMany</code> å€¼å˜åŒ–ä¹‹åè§¦å‘äº† render å‡½æ•°çš„é‡æ–°è®¡ç®—ã€‚</p>\n<p>ç„¶è€Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä¸¤è€…åªæ˜¯åœ¨æ•ˆæœä¸Šç­‰ä»·ã€‚åœ¨å®é™…è¿ç®—è¿‡ç¨‹ä¸­ï¼Œcomputed çš„æ–¹æ¡ˆæœ‰ä¸¤ä¸ªä¼˜åŠ¿ï¼š</p>\n<ol>\n<li>ä»£ç çœ‹ä¸Šå»æ›´æ¸…æ™°ã€‚render æ˜¯å› ä¸º computed çš„æ•°æ®è§¦å‘çš„ï¼Œè¿™ä¸€ç‚¹åœ¨ä»£ç ä¸Šå¯ä»¥å¾ˆå®¹æ˜“çš„çœ‹å‡ºæ¥ï¼›è€Œç¬¬ä¸€ç§æ–¹æ¡ˆï¼Œæ˜¯å¦è§¦å‘ getter å‡½æ•°ï¼Œå…¶å®éœ€è¦å¤šæ€è€ƒä¸€ä¸‹æ‰èƒ½ç¡®å®šï¼›</li>\n<li>å®é™…æ‰§è¡Œæ•ˆç‡æ›´é«˜ã€‚ä½¿ç”¨ getter çš„æ–¹æ¡ˆï¼Œç”±äº render å‡½æ•°å®é™…ä¸Šæ˜¯å’Œ <code class=\"language-text\">this.num</code> è¿™ä¸ª observable è¿›è¡Œå…³è”çš„ï¼Œå› æ­¤å“ªæ€• <code class=\"language-text\">this.isMany</code> è¿™ä¸ª getter å‡½æ•°æ²¡æœ‰å‘ç”Ÿå€¼çš„å˜åŒ–ï¼Œåªè¦ <code class=\"language-text\">this.num</code> å˜äº†ï¼Œrender å‡½æ•°éƒ½éœ€è¦è¢«æ‰§è¡Œï¼›è€Œå¯¹äºä½¿ç”¨ computed çš„æƒ…å†µï¼Œå› ä¸º render æ˜¯å’Œ <code class=\"language-text\">this.isMany</code> è¿›è¡Œå…³è”çš„ï¼Œå®é™… <code class=\"language-text\">this.isMany</code> æ²¡æœ‰å˜åŒ–çš„æ—¶å€™ï¼Œæ˜¯ä¸éœ€è¦è§¦å‘é‡ç»˜çš„ã€‚æ¢å¥è¯è¯´ï¼Œå‰è€… getter çš„æ–¹æ¡ˆï¼Œåœ¨ <code class=\"language-text\">this.num</code> ä» 1 æ¶¨åˆ° 6 çš„è¿‡ç¨‹ä¸­ï¼Œä¸€å…±è§¦å‘äº†äº”æ¬¡é‡æ–°æ¸²æŸ“ï¼›è€Œåè€… <code class=\"language-text\">computed</code> çš„æ–¹æ¡ˆï¼Œåªè§¦å‘äº†ä¸€æ¬¡é‡æ–°æ¸²æŸ“ï¼ˆå½“ <code class=\"language-text\">this.num = 6</code> çš„æ—¶å€™ï¼‰</li>\n</ol>\n<p>é’ˆå¯¹ç¬¬äºŒç‚¹ï¼ŒMobx çš„ GitHub issue ä¸­ä½œè€…ä¹Ÿæœ‰ç›¸å…³çš„è¯´æ˜ï¼Œè§<a href=\"https://github.com/mobxjs/mobx/issues/161#issuecomment-196744152\">è¿™é‡Œ</a>ã€‚</p>","frontmatter":{"date":"2019-10-29","title":"computed and getter in Mobx","category":"JavaScript"}}},{"node":{"id":"15786218-7294-5212-8a5c-878f74283838","html":"<p>åœ¨ Node.js ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code class=\"language-text\">os</code> æ¨¡å—çš„ <code class=\"language-text\">networkInterfaces</code> API æ¥è·å–å½“å‰æœºå™¨çš„ IP æ•°æ®ã€‚è¿”å›çš„ç»“æœç±»ä¼¼äº <code class=\"language-text\">ifconfig</code> æˆ– <code class=\"language-text\">ipconfig</code> å‘½ä»¤ã€‚</p>\n<p>ä»¥è·å–å½“å‰ä¸»æœºçš„ IPv4 åœ°å€ä¸ºä¾‹ï¼Œå¯ä»¥å†™ç±»ä¼¼å¦‚ä¸‹çš„ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getIPAddress</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> interfaces <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'os'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">networkInterfaces</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> results <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">values</span><span class=\"token punctuation\">(</span>interfaces<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">flat</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">interface</span></span> <span class=\"token operator\">=></span> <span class=\"token keyword\">interface</span><span class=\"token punctuation\">.</span>family <span class=\"token operator\">===</span> <span class=\"token string\">'IPv4'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">interface</span></span> <span class=\"token operator\">=></span> <span class=\"token operator\">!</span><span class=\"token keyword\">interface</span><span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>results<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> results<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>address<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ç®€å•çš„è¯´æ˜å¦‚ä¸‹ï¼š</p>\n<ul>\n<li><code class=\"language-text\">internal</code> ç”¨äºè¡¨ç¤ºå½“å‰çš„åœ°å€æ˜¯å¦æ˜¯æœ¬åœ°å›ç¯åœ°å€æˆ–æ˜¯å…¶ä»–å¤–éƒ¨æ— æ³•è®¿é—®çš„åœ°å€ï¼ˆä¾‹ï¼š127.0.0.1ï¼‰ï¼›</li>\n<li><code class=\"language-text\">family</code> ç”¨äºè¡¨ç¤ºå½“å‰åœ°å€çš„ç±»å‹ï¼Œå°†ä¼šæ˜¯ <code class=\"language-text\">IPv4</code> æˆ– <code class=\"language-text\">IPv6</code> ä¸­çš„ä¸€ç§ï¼›</li>\n<li><code class=\"language-text\">address</code> ç”¨äºè¡¨ç¤ºå½“å‰çš„ IP åœ°å€ï¼›</li>\n<li><code class=\"language-text\">os.networkInterfaces</code> çš„è¿”å›æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œkey ç”¨äºè¡¨ç¤º network interfaceï¼Œæ¯”å¦‚å¸¸è§çš„ <code class=\"language-text\">lo</code> æˆ–è€… <code class=\"language-text\">eth0</code> ç­‰ã€‚</li>\n</ul>\n<p>æ›´å¤šçš„è¿”å›æ•°æ®åŠè§£é‡Šï¼Œå¯ä»¥å‚è€ƒ<a href=\"https://nodejs.org/api/os.html#os_os_networkinterfaces\">å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>","frontmatter":{"date":"2019-10-28","title":"Get Current IP Address","category":"JavaScript"}}},{"node":{"id":"9c56df61-73a4-5eb4-a4eb-4158947a5a66","html":"<p><code class=\"language-text\">document.designMode</code> è¿™ä¸ªå±æ€§ï¼Œå¯ä»¥ç”¨äºæ§åˆ¶å½“å‰çš„æ•´ä¸ªé¡µé¢æ˜¯å¦å¯ä»¥ç›´æ¥è¢«ç¼–è¾‘ã€‚å¯ä»¥è®¾ç½®çš„å±æ€§å€¼åŒ…æ‹¬ <code class=\"language-text\">on</code> å’Œ <code class=\"language-text\">off</code> ä¸¤ç§ã€‚å¦‚æœè®¾ç½®ä¸º <code class=\"language-text\">on</code>ï¼Œé‚£ä¹ˆç›¸å½“äºå¼€å¯äº†å…¨é¡µé¢èŒƒå›´çš„ <code class=\"language-text\">contenteditable=true</code>ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ªå€¼æ˜¯ <code class=\"language-text\">off</code>ã€‚</p>\n<p>é€šè¿‡å¼€å…³è¿™ä¸ªå€¼ï¼Œéç¨‹åºå‘˜ä¹Ÿå¯ä»¥è½»æ¾çš„å¯¹å½“å‰é¡µé¢è¿›è¡Œç®€å•çš„ä¿®æ”¹ï¼ˆä¸»è¦æ˜¯æ–‡æ¡ˆçš„éƒ¨åˆ†ï¼‰ã€‚ä¸€äº›ç®€å•çš„éœ€æ±‚ï¼ŒPM å’Œ UX å°±å¯ä»¥ç›´æ¥è¿›è¡Œå°è¯•ï¼Œè€Œä¸éœ€è¦å†å€ŸåŠ©ç¨‹åºå‘˜çš„å¸®å¿™äº†ã€‚å½“ç„¶ï¼Œå¯¹é¡µé¢â€œé€ å‡â€çš„é—¨æ§›ä¹Ÿå˜ä½äº†ã€‚</p>\n<p>å¯ä»¥é€šè¿‡ä¸‹é¢çš„æŒ‰é’®æ¥å®é™…ä½“éªŒä¸€ä¸‹è¿™ä¸ªåŠŸèƒ½ã€‚</p>\n<p>\n  <button onclick=\"document.designMode=(document.designMode==='off'?'on':'off')\">\n    Toggle Design Mode\n  </button>\n</p>\n<p>æ›´å¤šçš„è¯´æ˜åŠæµè§ˆå™¨æ”¯æŒæƒ…å†µï¼ˆåŸºæœ¬å¯ä»¥è®¤ä¸ºå…¨æ”¯æŒï¼‰ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Document/designMode\">MDN</a>ã€‚</p>","frontmatter":{"date":"2019-10-22","title":"Document DesignMode","category":"JavaScript"}}},{"node":{"id":"c53d17b5-4c70-5421-bcc4-1ee6a0e8cffc","html":"<p>è¦è·å–ä¸€ä¸ª NPM åŒ…æ‰€æœ‰çš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¯ä»¥ä½¿ç”¨ <code class=\"language-text\">npm view</code> è¿™ä¸ªå‘½ä»¤ã€‚æ¯”å¦‚ï¼Œæ£€æŸ¥ React è¿™ä¸ªåŒ…çš„æ‰€æœ‰ç‰ˆæœ¬ï¼Œå¹¶è¾“å‡ºæˆ JSON æ ¼å¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> view react versions --json</code></pre></div>\n<p>å½“ç„¶ï¼Œä»¥ä¸Šåªæ˜¯ CLI çš„æ“ä½œæ–¹å¼ï¼Œå¦‚æœå¸Œæœ›å¯ä»¥é€šè¿‡ç¼–ç¨‹çš„æ–¹å¼å»äº†è§£ä¸€ä¸ª NPM åŒ…çš„ç›¸å…³ä¿¡æ¯ï¼Œéœ€è¦æ¢ä¸€ä¸ªæ–¹å¼ã€‚æ³¨æ„åˆ° NPM æœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ª <a href=\"https://www.npmjs.com/package/npm\">NPM åŒ…</a>ï¼Œå¯¹åº”çš„æºç å¯ä»¥åœ¨ <a href=\"https://github.com/npm/cli\">GitHub</a> ä¸Šæ‰¾åˆ°ã€‚å…¶ä¸­ï¼Œ<code class=\"language-text\">npm view</code> è¿™ä¸ªå‘½ä»¤ï¼Œå¯¹åº”çš„ä»£ç æ˜¯ <a href=\"https://github.com/npm/cli/blob/c1522be2406a0ea4f14c85753edd42ddd8d7e180/lib/view.js\">lib/view.js</a>ã€‚</p>\n<p>é€šè¿‡è§‚å¯Ÿè¿™ä¸ªæ–‡ä»¶ï¼Œä¸éš¾å‘ç°ï¼ŒNPM åº•å±‚ä¾èµ–çš„å…¶å®æ˜¯ <a href=\"https://www.npmjs.com/package/libnpm\">libnpm</a> è¿™ä¸ªåº“ã€‚å…¶ä¸­ï¼Œè·å–åŒ…ä¿¡æ¯çš„éƒ¨åˆ†ï¼Œä½¿ç”¨çš„æ˜¯ <code class=\"language-text\">libnpm/packument</code> è¿™ä¸ªéƒ¨åˆ†ã€‚è€Œæ ¹æ®æ–‡æ¡£ï¼Œè¿™é‡Œ <code class=\"language-text\">libnpm/packument</code> æœ¬è´¨ä¸Šå°±æ˜¯å°† <a href=\"https://www.npmjs.com/package/pacote\">pacote</a> ä¸­çš„ <code class=\"language-text\">packument</code> æ¥å£å¼€æ”¾äº†å‡ºæ¥ã€‚</p>\n<p>å®é™…çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> packument <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'libnpm/packument'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">getVersions</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">package</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> versions <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">packument</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">package</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// to use custom registry</span>\n    registry<span class=\"token punctuation\">:</span> <span class=\"token string\">'https://registry.npm.taobao.org'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// get all meta data</span>\n    fullMetadata<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    <span class=\"token comment\">// prefer to get latest online data</span>\n    <span class=\"token string\">'prefer-online'</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> versions<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">packument</code> è¿™ä¸ª API çš„è¿”å›æ•°æ®æ ¼å¼ï¼Œå¯ä»¥å‚è€ƒ <code class=\"language-text\">@types/pacote</code> ä¸­çš„ç›¸å…³<a href=\"https://github.com/DefinitelyTyped/DefinitelyTyped/blob/25fe77861d42ff01903fe2e2d1014b3ed354bfde/types/pacote/index.d.ts#L98\">å®šä¹‰</a>ã€‚</p>\n<p>éœ€è¦é¢å¤–æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼šnpm å’Œä¸€äº› registry æœåŠ¡ä½¿ç”¨çš„æ•°æ®æ ¼å¼å¯èƒ½ç•¥æœ‰åŒºåˆ«ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œnpm çš„è¿”å›æ•°æ®é‡Œï¼Œæ¯ä¸ªç‰ˆæœ¬çš„ <code class=\"language-text\">dist</code> ä¸­å¯èƒ½åŒ…å« <code class=\"language-text\">unpackedSize</code> æ•°æ®ï¼ˆoptionalï¼‰ï¼Œè¡¨ç¤ºè¯¥ç‰ˆæœ¬æ–‡ä»¶å®é™…çš„å¤§å°ï¼›è€Œ <a href=\"https://github.com/npm/cli\">cnpm</a> è¿”å›çš„æ•°æ®ä¸­ï¼Œ<code class=\"language-text\">dist</code> å†…åŒ…å«çš„æ˜¯ <code class=\"language-text\">size</code> æ•°æ®ï¼ˆ<a href=\"https://github.com/cnpm/cnpmjs.org/blob/26d7147562a1ae21db8bfec26983daf311353d96/models/module.js#L74\">æºä»£ç </a>ï¼‰ï¼Œè¡¨ç¤ºè¯¥ç‰ˆæœ¬çš„å‹ç¼©æ–‡ä»¶ tar çš„å¤§å°ã€‚</p>","frontmatter":{"date":"2019-10-21","title":"Get Npm Package Info","category":"JavaScript"}}},{"node":{"id":"cd182026-2d57-5a6b-83b4-a7f384ce0957","html":"<p>åœ¨æ—¥å¸¸çš„å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå¯¹äºä¸€ä¸ªæŒ‰é’®æˆ–è€…é“¾æ¥ï¼Œä¸€èˆ¬ä¼šé™„ä¸Šä¸€ä¸ª <code class=\"language-text\">onClick</code> äº‹ä»¶ï¼Œä»¥å“åº”ç”¨æˆ·çš„ç‚¹å‡»æ“ä½œã€‚å½“ç”¨æˆ·å®é™…æŒ‰ä¸‹æŒ‰é’®æˆ–é“¾æ¥ä¹‹åï¼Œå†é€šè¿‡ <code class=\"language-text\">onClick</code> äº‹ä»¶å»è§¦å‘ä¹‹åè¦è¿›è¡Œçš„æµç¨‹ï¼ˆæ¯”å¦‚ç½‘ç»œè¯·æ±‚æˆ–æ˜¯é“¾æ¥è·³è½¬ç­‰ï¼‰ã€‚</p>\n<p>å¦‚æœå¯¹äºç”¨æˆ·æ“ä½œåçš„åé¦ˆé€Ÿåº¦æœ‰ä¸€å®šçš„è¦æ±‚ï¼Œè¿™é‡Œçš„è¡Œä¸ºå°±éœ€è¦è¿›è¡Œä¼˜åŒ–ã€‚ä»¥é“¾æ¥ä¸ºä¾‹ï¼Œä¸€ä¸ªå¸¸è§çš„æ“ä½œæ–¹æ³•æ˜¯ï¼ˆæ¯”å¦‚ <a href=\"https://github.com/GoogleChromeLabs/quicklink\">quicklink</a>ï¼‰ï¼Œç”¨ç¨‹åºå¯¹å¯è§†èŒƒå›´å†…çš„é“¾æ¥åœ°å€è¿›è¡Œé¢„åŠ è½½ï¼ˆä½¿ç”¨ <code class=\"language-text\">prefetch</code>ï¼‰ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·çœŸæ­£ç‚¹å‡»çš„æ—¶å€™ï¼Œèµ„æºå¾ˆå¯èƒ½å·²ç»å¾—åˆ°äº†åŠ è½½ï¼Œæ‰“å¼€é€Ÿåº¦å°±ä¼šæ˜¾è‘—æå‡ã€‚</p>\n<p>å½“ç„¶ï¼Œè¿™æ ·çš„è¡Œä¸ºæ˜¯æ²¡æœ‰é¢„åˆ¤çš„ï¼Œçº¯ç²¹æš´åŠ›çš„è¿›è¡Œå¯èƒ½çš„é¢„å¤‡æ“ä½œã€‚å¦‚æœé¢„å¤‡æ“ä½œæŸè€—è¾ƒå¤šï¼Œè¿™æ ·çš„æ“ä½œå°±æ˜¾å¾—ä¸æ–¹ä¾¿äº†ã€‚</p>\n<p>ä¸€ä¸ªæ›´åŠ â€œæ™ºèƒ½â€çš„æ“ä½œæ˜¯ï¼Œä»…å½“ç”¨æˆ·â€œç‚¹å‡»â€äº†ä¹‹åæ‰è¿›è¡Œé¢„åŠ è½½ã€‚å®é™…ä¸Šï¼Œå³ä½¿æ˜¯ä¸€ä¸ªç‚¹å‡»çš„çš„æ“ä½œï¼Œä¹Ÿä¼šåˆ†æˆå¥½å‡ ä¸ªä¸åŒçš„äº‹ä»¶ï¼ŒåŒ…æ‹¬ <code class=\"language-text\">MouseDown</code>ï¼Œ<code class=\"language-text\">MouseUp</code> å’Œ <code class=\"language-text\">Click</code>ã€‚åœ¨ <code class=\"language-text\">MouseDown</code> å’Œ <code class=\"language-text\">Click</code> ä¹‹é—´ï¼Œå·®ç€å¤§çº¦ 100ms çš„æ—¶é—´ã€‚</p>\n<p>æ¢å¥è¯è¯´ï¼Œå¦‚æœåœ¨ <code class=\"language-text\">MouseDown</code> çš„æ—¶å€™å°±å¼€å§‹é¢„å¤„ç†ï¼Œç­‰åˆ° <code class=\"language-text\">Click</code> æ—¶æ‰çœŸæ­£è¿›è¡ŒåŠ è½½ï¼Œé‚£ä¹ˆæ•´ä½“çš„åŠ è½½æ—¶é—´ä¼šå‡å°‘ 100ms å·¦å³ã€‚åœ¨æŸäº›æƒ…å†µä¸‹ï¼Œè¿™ä¹Ÿæ˜¯ä¸ªä¸å°çš„æå‡äº†ã€‚</p>\n<p>å¯ä»¥ç”¨ä¸‹é¢çš„è¿™æ®µä»£ç å®é™…æµ‹è¯•ä¸€ä¸‹ï¼Œ<code class=\"language-text\">MouseDown</code> äº‹ä»¶å’Œ <code class=\"language-text\">Click</code> äº‹ä»¶ä¹‹é—´çš„æ—¶é—´å·®ï¼ˆå…·ä½“æ—¶é—´å·®å› äººè€Œå¼‚ï¼‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> button <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'button'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span>textContent <span class=\"token operator\">=</span> <span class=\"token string\">'Click Me'</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmousedown</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Mousedown: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nbutton<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Click: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>Date<span class=\"token punctuation\">.</span><span class=\"token function\">now</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>button<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¹Ÿå¯ä»¥ç›´æ¥ç‚¹å‡»ä¸‹é¢è¿™ä¸ªæŒ‰é’®å°è¯•ï¼š</p>\n<button onmousedown=\"window.__down=Date.now()\" onclick=\"this.textContent='Took:'+(Date.now() - window.__down)+' ms'\">\n  Click Me\n</button>\n<p></p>\n<p>å½“ç„¶ï¼Œæ¯”è¿™ä¸ªç•¥æ¿€è¿›çš„æ“ä½œï¼Œå¯ä»¥å°† <code class=\"language-text\">MouseDown</code> äº‹ä»¶æ¢æˆ <code class=\"language-text\">MouseEnter</code> äº‹ä»¶ï¼Œè¿™æ ·åœ¨ Hover çš„æ—¶å€™å°±ä¼šå¼€å§‹é¢„åŠ è½½ã€‚å¤§æ¦‚èƒ½æå‰ 300ms å·¦å³å¼€å§‹æ“ä½œï¼Œå½“ç„¶å­˜åœ¨ä¸€å®šçš„è¯¯åˆ¤é£é™©ï¼ˆæ¯”å¦‚ç”¨æˆ·åªæ˜¯åˆ’è¿‡äº†é¼ æ ‡ï¼Œå¹¶æ²¡æœ‰æƒ³è¦ç‚¹å‡»çš„æ„æ„¿ï¼‰ã€‚</p>\n<p>å¯ä»¥å‚è€ƒ <a href=\"http://instantclick.io/\">InstantClick</a> äº†è§£æ›´å¤šå®ç°çš„ç»†èŠ‚ã€‚</p>","frontmatter":{"date":"2019-10-15","title":"MouseDown to Click","category":"JavaScript"}}},{"node":{"id":"d2c713ba-83c1-5c25-8d75-4bb1aece6f6b","html":"<p>æµè§ˆå™¨æä¾›äº† <code class=\"language-text\">performance</code> ç”¨äºæµ‹é‡ JavaScript çš„ä¸€äº›è¿è¡Œæ•ˆç‡ï¼Œå¹¶åœ¨æµè§ˆå™¨çš„å¯¹åº”ä½ç½®ï¼ˆå¦‚ Chrome çš„ Performance Tabï¼‰ç”Ÿæˆç«ç„°å›¾ï¼Œå¯ä»¥æ–¹ä¾¿çš„æŸ¥çœ‹ç¨‹åºè°ƒç”¨æ ˆçš„æ‰§è¡Œæ•ˆç‡ã€‚ç®€å•çš„æ“ä½œå¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getMarkName</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">mark: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">beginMark</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  performance<span class=\"token punctuation\">.</span><span class=\"token function\">mark</span><span class=\"token punctuation\">(</span><span class=\"token function\">getMarkName</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">endMark</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> markName <span class=\"token operator\">=</span> <span class=\"token function\">getMarkName</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    performance<span class=\"token punctuation\">.</span><span class=\"token function\">measure</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">,</span> markName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// å¦‚æœ markName æ— æ³•è¢«æ‰¾åˆ°ï¼ˆä¹Ÿå°±æ˜¯ beginMark å‡½æ•°æ²¡æœ‰è¢«è°ƒç”¨ï¼‰</span>\n    <span class=\"token comment\">// é‚£ä¹ˆç¨‹åºåœ¨ performance.measure çš„æ—¶å€™ä¼šæŠ¥é”™</span>\n    <span class=\"token comment\">// è¿™é‡Œæ— éœ€å°†æŠ¥é”™æŠ›å‡ºï¼Œç›´æ¥åæ‰å°±å¯ä»¥äº†</span>\n  <span class=\"token punctuation\">}</span>\n  performance<span class=\"token punctuation\">.</span><span class=\"token function\">clearMarks</span><span class=\"token punctuation\">(</span>markName<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  performance<span class=\"token punctuation\">.</span><span class=\"token function\">clearMeasure</span><span class=\"token punctuation\">(</span>name<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">main</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">beginMark</span><span class=\"token punctuation\">(</span><span class=\"token string\">'label name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// éœ€è¦è¿›è¡Œçš„æ“ä½œ</span>\n  <span class=\"token function\">endMark</span><span class=\"token punctuation\">(</span><span class=\"token string\">'label name'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å…·ä½“æ¥è¯´ï¼Œé€šè¿‡ <code class=\"language-text\">performance.mark</code> å‡½æ•°æ ‡è®°ä¸€ä¸ªç‚¹ï¼Œç„¶ååœ¨éœ€è¦æµ‹é‡çš„ç¨‹åºæ‰§è¡Œå®Œæˆä¹‹åï¼Œé€šè¿‡ <code class=\"language-text\">performance.measure</code> æ¥è®¡ç®—å½“å‰å’Œæœ€åˆ mark çš„ç‚¹ä¹‹é—´çš„è¿è¡Œæ—¶é—´ã€‚æœ€ç»ˆï¼Œè¿™ä¸€æ®µç»“æœä¼šåœ¨ Chrome çš„ Performance Timings ä¸­å½¢æˆå¯¹åº”çš„ç«ç„°å›¾æ•°æ®ã€‚</p>\n<p><code class=\"language-text\">performance.measure</code> ä¹Ÿæ”¯æŒä¸‰ä¸ªå‚æ•°çš„è°ƒç”¨ï¼Œä¸‰ä¸ªå‚æ•°åˆ†åˆ«æ˜¯ label çš„åç§°ï¼Œèµ·å§‹ mark çš„åç§°ä»¥åŠç»ˆæ­¢ mark çš„åç§°ã€‚å¦‚æœçœç•¥æœ€åä¸€ä¸ªå‚æ•°ï¼Œé‚£ä¹ˆç»ˆæ­¢çš„æ—¶é—´ç‚¹å°±æ˜¯å½“å‰ <code class=\"language-text\">performance.measure</code> è°ƒç”¨çš„æ—¶é—´ç‚¹ã€‚</p>\n<p>æœ€åï¼Œé€šè¿‡ <code class=\"language-text\">performance.clearMarks</code> åŠ <code class=\"language-text\">performance.clearMeasure</code> åˆ é™¤æ ‡è®°ï¼Œæ¸…ç†ä¸å¿…è¦çš„å†…å­˜ä½¿ç”¨ã€‚</p>\n<p>æ›´å¤šçš„ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Performance\">MDN</a> çš„æ–‡æ¡£ã€‚React ä¸­ä¹Ÿä½¿ç”¨äº†ç±»ä¼¼çš„æŠ€æœ¯ç”¨äºåœ¨ Performance ä¸­ç”Ÿæˆæ¯ä¸ª Component æ¸²æŸ“èŠ±è´¹çš„æ—¶é—´ï¼Œç›¸å…³çš„ä»£ç å¯ä»¥å‚è€ƒ <a href=\"https://github.com/facebook/react/blob/50addf4c0e411e351de7290c8c60ec775c25c8c4/packages/react-reconciler/src/ReactDebugFiberPerf.js#L80\">ReactDebugFiberPerf.js</a>ã€‚</p>","frontmatter":{"date":"2019-09-30","title":"Performance Measure","category":"JavaScript"}}},{"node":{"id":"27ff91be-e0ae-5169-a594-b6e813c36527","html":"<p>JavaScript ä¸­æä¾›äº† <code class=\"language-text\">devicemotion</code> äº‹ä»¶ï¼Œå¯ä»¥ç”¨äºç›‘å¬è®¾å¤‡å„ä¸ªæ–¹å‘ä¸Šå—åˆ°çš„åŠ›ï¼ˆåŠ é€Ÿåº¦ï¼‰ã€‚æœ‰äº†è¿™ä¸ªäº‹ä»¶ï¼Œå°±å¯ä»¥ç”¨äºåˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦åœ¨è¿›è¡Œç±»ä¼¼â€œæ‘‡ä¸€æ‘‡â€ä¹‹ç±»çš„æ“ä½œï¼Œæ–¹ä¾¿å¼€å‘åŸºäºç‰¹å®šäº¤äº’çš„ä¸€äº›åŠŸèƒ½ã€‚</p>\n<p>å…·ä½“æ¥è¯´ï¼Œ<code class=\"language-text\">devicemotion</code> äº‹ä»¶ä¼šæä¾› <code class=\"language-text\">accelerationIncludingGravity</code> æ•°æ®ï¼Œä½œä¸ºä¸€ä¸ªå¯¹è±¡åˆ†åˆ«æä¾› <code class=\"language-text\">x</code>ï¼Œ<code class=\"language-text\">y</code> å’Œ <code class=\"language-text\">z</code> ä¸‰ä¸ªæ–¹å‘ä¸Šçš„åŠ é€Ÿåº¦ã€‚é€šè¿‡ä¸åŒæ—¶é—´ç‚¹ä¸ŠåŠ é€Ÿåº¦å€¼çš„ä¸åŒï¼Œå°±å¯ä»¥åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦åœ¨è¿›è¡Œæ‘‡æ™ƒæ‰‹æœºçš„æ“ä½œäº†ã€‚</p>\n<p>ä½¿ç”¨ <code class=\"language-text\">devicemotion</code> çš„ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">handler</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> x<span class=\"token punctuation\">,</span> y<span class=\"token punctuation\">,</span> z <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>accelerationIncludingGravity<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// do stuff here</span>\n<span class=\"token punctuation\">}</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'devicemotion'</span><span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åˆ¤æ–­æ˜¯å¦åœ¨æ‘‡æ™ƒæ‰‹æœºï¼Œç®€å•æ¥è¯´ï¼Œåªéœ€è¦åˆ¤æ–­å½“å‰çš„å„æ–¹å‘åŠ é€Ÿåº¦ä¹‹å·®ï¼Œæ˜¯å¦æœ‰è‡³å°‘ä¸¤ä¸ªè¶…è¿‡äº†ç»™å®šçš„é˜ˆå€¼ã€‚<a href=\"https://github.com/alexgibson/shake.js\">shake.js</a> ä¸­å°±ä½¿ç”¨äº†è¿™æ ·çš„æ–¹æ³•æ¥åˆ¤æ–­å½“å‰ç”¨æˆ·æ˜¯å¦åœ¨æ‘‡æ™ƒæ‰‹æœºï¼Œå…·ä½“çš„ä»£ç å¯ä»¥å‚è€ƒ<a href=\"https://github.com/alexgibson/shake.js/blob/d232eee7a5f31e9fd37aa79aa83f1f206035ccc9/shake.js#L104\">æºç </a>ã€‚</p>\n<p><code class=\"language-text\">devicemotion</code> æ›´å¤šçš„ä¿¡æ¯ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Window/devicemotion_event\">MDN</a>ã€‚</p>","frontmatter":{"date":"2019-09-29","title":"Mobile Shake","category":"JavaScript"}}},{"node":{"id":"1b9a898d-4d6f-5201-8c9a-05733edf90ee","html":"<p>åœ¨ç”¨ React å¤„ç†ä¸šåŠ¡çš„è¿‡ç¨‹ä¸­ï¼Œç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„åœºæ™¯ï¼šæŸä¸€ä¸ª UI éœ€è¦ç­‰å¾…ç½‘ç»œè¯·æ±‚æ¥å±•ç¤ºï¼Œåœ¨ç­‰å¾…çš„è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æ˜¾ç¤º Loading ç•Œé¢ï¼Œå¹¶åœ¨è¯·æ±‚å®Œæˆåï¼Œæ˜¾ç¤ºçœŸæ­£çš„ UIã€‚è¿™ç§æƒ…å†µï¼Œå’ŒæŒ‰éœ€åŠ è½½æ¨¡å—çš„è¡Œä¸ºéå¸¸ç±»ä¼¼ã€‚æ—¢ç„¶ React.Suspense + React.lazy å¯ä»¥ç»„åˆç”¨äºæŒ‰éœ€åŠ è½½æ¨¡å—æ—¶å€™çš„ UI å±•ç¤ºï¼Œé‚£ä¹ˆæ˜¯å¦å¯ä»¥ä½¿ç”¨åŒæ ·çš„ç»„åˆæ¥å®Œæˆç±»ä¼¼ç­‰å¾…ç½‘ç»œè¯·æ±‚çš„ UI æ˜¾ç¤ºå‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ã€‚ä¸‹é¢ç»™å‡ºä¸€ä¸ªç¤ºä¾‹ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">time</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span> <span class=\"token operator\">=></span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span>resolve<span class=\"token punctuation\">,</span> time<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fakeFetch</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token string\">\"finished!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> Component <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">lazy</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span>\n  <span class=\"token function\">fakeFetch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">text</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n    <span class=\"token function-variable function\">default</span><span class=\"token punctuation\">:</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>text<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"App\"</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>React<span class=\"token punctuation\">.</span>Suspense fallback<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>loading<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Hello World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Component <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>React<span class=\"token punctuation\">.</span>Suspense<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å¦‚æ­¤ä¸€æ¥ï¼Œåœ¨ Promise æ²¡æœ‰è¿”å›çš„æ—¶å€™ï¼Œç»„ä»¶ä¼šæ˜¾ç¤º <code class=\"language-text\">&lt;div&gt;loading...&lt;/div&gt;</code>ã€‚è€Œç­‰åˆ° Promise resolve ä¹‹åï¼Œå°±ä¼šæ˜¾ç¤ºçœŸæ­£çš„ UIã€‚</p>\n<p>å‡ ç‚¹è¯´æ˜ï¼š</p>\n<ol>\n<li><code class=\"language-text\">React.lazy</code> æœ¬èº«æ˜¯ä¸º <code class=\"language-text\">import()</code> è®¾è®¡çš„ï¼Œæ‰€ä»¥åœ¨ Promise è¿”å›çš„æ—¶å€™ï¼Œéœ€è¦å°†ç»„ä»¶æ”¾åˆ° <code class=\"language-text\">default</code> å±æ€§ä¸‹é¢ï¼Œä¿æŒå’Œ <code class=\"language-text\">import()</code> çš„è¡Œä¸ºä¸€è‡´ï¼›</li>\n<li><code class=\"language-text\">React.Suspense</code> å’Œ <code class=\"language-text\">React.lazy</code> çš„ç»„åˆï¼Œæœ¬è´¨ä¸Šå†…éƒ¨æ˜¯ä½¿ç”¨äº† <code class=\"language-text\">throw</code> + <code class=\"language-text\">componentDidCatch</code> çš„æ–¹å¼è¿›è¡Œå®ç°çš„ï¼Œå› è€Œå¦‚æœä¸ä½¿ç”¨ <code class=\"language-text\">React.lazy</code>ï¼Œç›´æ¥åœ¨ç»„ä»¶å†… <code class=\"language-text\">throw Promise</code>ï¼Œä¹Ÿå¯ä»¥è¾¾åˆ°ç±»ä¼¼çš„æ•ˆæœï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">fakeFetch</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">fn</span> <span class=\"token operator\">=></span> <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">fn</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"finished!\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">let</span> data <span class=\"token operator\">=</span> <span class=\"token string\">\"before\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Component</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data <span class=\"token operator\">===</span> <span class=\"token string\">\"before\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">throw</span> <span class=\"token function\">fakeFetch</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">newData</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      data <span class=\"token operator\">=</span> newData<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>data<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">App</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token operator\">&lt;</span>div className<span class=\"token operator\">=</span><span class=\"token string\">\"App\"</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>React<span class=\"token punctuation\">.</span>Suspense fallback<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>loading<span class=\"token operator\">...</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h1<span class=\"token operator\">></span>Hello World<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Component <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>React<span class=\"token punctuation\">.</span>Suspense<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"date":"2019-09-24","title":"Suspense & Lazy in React","category":"JavaScript"}}},{"node":{"id":"6e987333-0e0f-57fb-8f42-eaa464ad5564","html":"<p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåªæœ‰å½“ç”¨æˆ·æœ‰æ“ä½œçš„æƒ…å†µä¸‹ï¼Œåœ¨ä¸€ä¸ª tick é‡Œï¼ŒJavaScript é€šè¿‡ <code class=\"language-text\">window.open</code> æˆ–æ˜¯ <code class=\"language-text\">&lt;a target=&quot;_blank&quot;&gt;</code> HTML å…ƒç´ ç›´æ¥ <code class=\"language-text\">click</code> æ‰“å¼€æ–°çš„çª—å£æ‰èƒ½æ­£å¸¸å¼¹å‡ºã€‚å¦‚æœä¸€æ—¦æ¶‰åŠåˆ°å¼‚æ­¥çš„æ“ä½œï¼Œå¼¹æ¡†å°±ä¼šé»˜è®¤è¢«æµè§ˆå™¨é˜»æ­¢ï¼Œæ— æ³•æ­£å¸¸æ˜¾ç¤ºã€‚</p>\n<p>è¿™æ ·è®¾è®¡çš„åˆè¡·ï¼Œæ˜¯ä¸ºäº†é˜²æ­¢å‰ç«¯éšæ„å¼¹æ¡†ï¼Œå½±å“åˆ°ç”¨æˆ·æ­£å¸¸çš„ä½“éªŒã€‚ç„¶è€Œï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œç”¨æˆ·æ“ä½œåéœ€è¦ç»è¿‡ç½‘ç»œè¯·æ±‚ï¼Œè¿”å›ç»“æœåæ‰çŸ¥é“åº”è¯¥å¦‚ä½•å±•ç¤ºå¼¹æ¡†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œç®€å•çš„ <code class=\"language-text\">fetch().then(() =&gt; window.open())</code> è‚¯å®šæ˜¯ä¸è¡Œçš„ã€‚éœ€è¦ä¸€äº› Hack çš„æ–¹æ¡ˆï¼Œå¦‚ä¸‹ã€‚</p>\n<p>åœ¨ç”¨æˆ·è¿›è¡Œäº†æ“ä½œä¹‹åï¼Œé¦–å…ˆå…ˆæ‰“å¼€ä¸€ä¸ªæ–°çš„çª—å£ï¼Œç­‰åˆ°å¼‚æ­¥æ“ä½œè¿”å›ä¹‹åï¼Œå†é€šè¿‡ JavaScript ä¿®æ”¹è¿™ä¸ªçª—å£çš„åœ°å€ï¼Œä»è€Œè¾¾åˆ°å¼‚æ­¥æ‰“å¼€çª—å£çš„ç›®çš„ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">element<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onclick</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> win <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">open</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// æ¨¡æ‹Ÿå¼‚æ­¥æ“ä½œ</span>\n  <span class=\"token keyword\">await</span> <span class=\"token function\">sleep</span><span class=\"token punctuation\">(</span><span class=\"token number\">5000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  win<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> <span class=\"token string\">'actual location'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™æ ·æ“ä½œå¯èƒ½çš„é—®é¢˜åŠè§£å†³æ–¹æ³•ï¼š</p>\n<ol>\n<li>å¦‚æœåœ¨å¼‚æ­¥çš„è¿‡ç¨‹ä¸­æœ¬çª—å£è¢«å…³é—­äº†ï¼Œå°±ä¼šç•™ä¸‹ä¸€ä¸ªç©ºç™½çš„æ–°çª—å£ã€‚å› è€Œï¼Œéœ€è¦ç›‘å¬ <code class=\"language-text\">beforeunload</code> äº‹ä»¶ï¼Œä»¥ä¿è¯å¿…è¦æ—¶å€™å¯ä»¥å…³é—­æ–°æ‰“å¼€çš„çª—å£ï¼›</li>\n<li>å¦‚æœå¼‚æ­¥çš„æ—¶é—´æ¯”è¾ƒé•¿ï¼Œæ‰“å¼€ä¸€ä¸ªç©ºç™½çš„çª—å£ç”¨æˆ·ä½“éªŒè¾ƒå·®ï¼ˆæ‰“å¼€åé»˜è®¤ä¼šè·å¾—ç„¦ç‚¹ï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå¯ä»¥æ‰“å¼€ä¸€ä¸ªé™æ€çš„é¡µé¢ï¼Œå±•ç¤ºä¸€ä¸ª loading çš„ UI ä»¥å‘Šè¯‰ç”¨æˆ·å½“å‰æ­£åœ¨è¿›è¡Œçš„æ“ä½œã€‚å¾…å¼‚æ­¥æ“ä½œå®Œæˆï¼Œå†é€šè¿‡ postMessage ç­‰æ–¹å¼é€šçŸ¥çª—å£è¿›è¡Œé¡µé¢çš„è·³è½¬ã€‚</li>\n</ol>","frontmatter":{"date":"2019-09-23","title":"Open Window Async","category":"JavaScript"}}},{"node":{"id":"36872891-c5a0-57ab-a5f7-a569c2473f52","html":"<p>åœ¨åˆ¤æ–­ä¸€ä¸ª DOM èŠ‚ç‚¹æ˜¯å¦åŒ…å«å¦ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œå¸¸å¸¸ç”¨åˆ° <code class=\"language-text\">contains</code> è¿™ä¸ª APIã€‚åœ¨å®é™…çš„ä½¿ç”¨ä»è¿‡ç¨‹ä¸­ï¼Œä¹Ÿç»å¸¸ä¼šé‡åˆ°è¿™æ ·çš„æƒ…å†µï¼Œéœ€è¦åˆ¤æ–­ A æ˜¯å¦åŒ…å« Bï¼Œè¿”å›æ˜¯ <code class=\"language-text\">false</code>ï¼Œä½†ç»è¿‡æ’æŸ¥ï¼Œå‘ç°å…¶å® A å’Œ B å°±æ˜¯åŒä¸€ä¸ªèŠ‚ç‚¹ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œå…‰ç”¨ <code class=\"language-text\">contains</code> API å°±æœ‰ç‚¹ä¸å¤Ÿç”¨äº†ã€‚åŒæ—¶ï¼Œä¹Ÿæš´éœ²äº†è¿™ä¸ª API æœ¬èº«èƒ½åŠ›çš„å±€é™æ€§ã€‚</p>\n<p>åœ¨ DOM Level 3 çš„<a href=\"https://www.w3.org/TR/DOM-Level-3-Core/core.html#Node3-compareDocumentPosition\">è§„èŒƒ</a>ä¸­ï¼Œå®šä¹‰äº†ä¸€ä¸ªæ–°çš„ APIï¼Œ<code class=\"language-text\">compareDocumentPosition</code>ã€‚ç›¸æ¯”äº <code class=\"language-text\">contains</code>ï¼Œ<code class=\"language-text\">compareDocumentPosition</code> æä¾›äº†æ›´å¼ºå¤§çš„åˆ¤æ–­ç»“æœã€‚</p>\n<p><code class=\"language-text\">compareDocumentPosition</code> è¿™ä¸ª API æ¯”è¾ƒåä¼šè¿”å›ä¸€ä¸ªæ•°å­—ï¼Œé€šè¿‡äºŒè¿›åˆ¶ä½çš„æ¯”è¾ƒï¼Œå¯ä»¥ç”¨äºåˆ¤æ–­ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„å…³ç³»ã€‚å‡è®¾è°ƒç”¨çš„å‡½æ•°ä¸º <code class=\"language-text\">A.compareDocumentPosition(B)</code>ï¼Œé‚£ä¹ˆè¿”å›å€¼å…·ä½“æ”¯æŒçš„ç±»å‹å¦‚ä¸‹ï¼š</p>\n<table>\n<thead>\n<tr>\n<th>å¸¸é‡å</th>\n<th>å€¼</th>\n<th>å«ä¹‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td><code class=\"language-text\">Node.DOCUMENT_POSITION_DISCONNECTED</code></td>\n<td>1</td>\n<td>ä¸åœ¨ä¸€ä¸ªæ–‡æ¡£ä¸­</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">Node.DOCUMENT_POSITION_PRECEDING</code></td>\n<td>2</td>\n<td>B åœ¨ A ä¹‹å‰</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">Node.DOCUMENT_POSITION_FOLLOWING</code></td>\n<td>4</td>\n<td>B åœ¨ A ä¹‹å</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">Node.DOCUMENT_POSITION_CONTAINS</code></td>\n<td>8</td>\n<td>B åŒ…å« A</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">Node.DOCUMENT_POSITION_CONTAINED_BY</code></td>\n<td>16</td>\n<td>A åŒ…å« B</td>\n</tr>\n<tr>\n<td><code class=\"language-text\">Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code></td>\n<td>32</td>\n<td>A å’Œ B çš„ä½ç½®å…³ç³»å–å†³äºå…·ä½“çš„å®ç°æ–¹å¼ï¼ˆä¸ç”±è§„èŒƒç¡®å®šï¼‰</td>\n</tr>\n</tbody>\n</table>\n<p>è¿™é‡Œä¹‹æ‰€ä»¥ä½¿ç”¨äºŒè¿›åˆ¶ä½è¡¨ç¤ºä½ç½®å…³ç³»ï¼Œä¸€ä¸ªå¾ˆé‡è¦çš„åŸå› å°±æ˜¯ï¼šAPI æœ‰å¯èƒ½ä¼šä¸€æ¬¡æ€§è¿”å›å¤šä¸ªç»“æœã€‚ä¸¾ä¸ªä¾‹å­ï¼Œå‡è®¾ <code class=\"language-text\">A.contains(B)</code> è¿”å› <code class=\"language-text\">true</code>ã€‚é‚£ä¹ˆï¼Œåœ¨è°ƒç”¨ <code class=\"language-text\">A.compareDocumentPosition(B)</code> çš„æ—¶å€™ï¼Œè¿”å›å€¼æ˜¯ <code class=\"language-text\">20</code>ï¼Œä¹Ÿå°±æ˜¯ <code class=\"language-text\">Node.DOCUMENT_POSITION_FOLLOWING | Node.DOCUMENT_POSITION_CONTAINED_BY</code> çš„ç»“æœã€‚æ¢å¥è¯è¯´ï¼ŒB å…ƒç´ åœ¨æ–‡æ¡£ä¸­çš„ä½ç½®åœ¨ A çš„åé¢ï¼ŒåŒæ—¶ B ä¹Ÿæ˜¯ A çš„ä¸€ä¸ªå­å…ƒç´ ã€‚</p>\n<p>è¿™é‡Œï¼Œ<code class=\"language-text\">Node.DOCUMENT_POSITION_DISCONNECTED</code> è¡¨ç¤ºä¸¤ä¸ªèŠ‚ç‚¹ä¸å†åŒä¸€ä¸ªæ–‡æ¡£ä¸­ï¼Œæœ‰å‡ ç§å¯èƒ½çš„æƒ…å†µï¼š</p>\n<ol>\n<li>A å’Œ B ä¸­æŸä¸€ä¸ªå­˜åœ¨äº iframe ä¸­ï¼Œå› è€Œä¸¤è€…ä¸å±äºåŒä¸€ä¸ªæ–‡æ¡£ï¼ˆ<code class=\"language-text\">A.ownerDocument !== B.ownerDocument</code>ï¼‰ï¼›</li>\n<li>A å’Œ B ä¸­æŸä¸€ä¸ªå…ƒç´ è¢«åˆ é™¤äº†ï¼ˆæˆ–æ²¡æœ‰æ’å…¥åˆ° DOM ä¸­ï¼‰ï¼Œå¯¼è‡´ä¸¤è€…ä¸å±äºåŒä¸€ä¸ªæ–‡æ¡£ï¼ˆå¯ä»¥é€šè¿‡ <code class=\"language-text\">A.parentElement</code> å’Œ <code class=\"language-text\">B.parentElement</code> åˆ¤æ–­æ˜¯å¦è¢«åˆ é™¤ï¼Œè¢«åˆ åå°±æ²¡æœ‰çˆ¶å…ƒç´ äº†ï¼‰</li>\n</ol>\n<p>å¦å¤–ï¼Œ<code class=\"language-text\">DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code> æœ‰ä¸¤ç§æƒ…å†µï¼š</p>\n<ol>\n<li>A å’Œ B æ²¡æœ‰ä»»ä½•ç›¸åŒçš„ containerï¼Œè¿™ç§æƒ…å†µå’Œ <code class=\"language-text\">Node.DOCUMENT_POSITION_DISCONNECTED</code> æ˜¯ç­‰ä»·çš„ã€‚æ¢å¥è¯è¯´ï¼Œå½“æœ‰ <code class=\"language-text\">Node.DOCUMENT_POSITION_DISCONNECTED</code> çš„æ—¶å€™ï¼Œä¸€å®šåŒæ—¶æœ‰ <code class=\"language-text\">Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code>ï¼›</li>\n<li>A å’Œ B æ˜¯åŒä¸€ä¸ªå…ƒç´ çš„ä¸¤ä¸ªå±æ€§å€¼ï¼Œè¿™ç§æƒ…å†µä¸‹ï¼Œè°å…ˆè°åæ˜¯ç”±å…·ä½“å®ç°å†³å®šçš„ã€‚æ¯”å¦‚ï¼Œ<code class=\"language-text\">Element.attributes</code> è¿”å›ä¸€ä¸ª <code class=\"language-text\">NamedNodeMap</code>ã€‚æ ¹æ®<a href=\"https://www.w3.org/TR/DOM-Level-3-Core/core.html#ID-1780488922\">è§„èŒƒ</a> çš„å®šä¹‰ï¼Œ<code class=\"language-text\">NamedNodeMap</code> ä¸ç»´æŠ¤ä¸€ä¸ªå…·ä½“çš„é¡ºåºï¼Œä½†åŒæ—¶æä¾›ä½¿ç”¨ index è®¿é—®çš„ APIã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code class=\"language-text\">Element.attributes</code> ä¸­çš„ä»»æ„ä¸¤ä¸ªå­—æ®µï¼Œæ˜¯æ²¡æœ‰å®šä¹‰ä¸Šçš„å…ˆåä¹‹åˆ†çš„ï¼ˆè™½ç„¶å¯èƒ½é€šè¿‡ä¸åŒçš„ä¸‹æ ‡è·å–åˆ°ï¼‰ã€‚å…·ä½“æ¥è¯´ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// div = &lt;div id=\"id\" class=\"class>&lt;/div></span>\n<span class=\"token keyword\">const</span> attributes <span class=\"token operator\">=</span> div<span class=\"token punctuation\">.</span>attributes<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> attributes<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">compareDocumentPosition</span><span class=\"token punctuation\">(</span>attributes<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// result = 36</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œï¼Œ<code class=\"language-text\">compareDocumentPosition</code> è¿”å›çš„ç»“æœæ˜¯ <code class=\"language-text\">36</code>ï¼Œå³ <code class=\"language-text\">Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC | Node.DOCUMENT_POSITION_PRECEDING</code>ã€‚å› æ­¤ï¼Œåœ¨å®é™…ä½¿ç”¨ API çš„æ—¶å€™ï¼Œæœ‰å¿…è¦æ£€æŸ¥æ˜¯å¦æœ‰ <code class=\"language-text\">Node.DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code> è¿™ä¸€ä½ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œå…¶ä»–çš„ç»“æœéƒ½å¯ä»¥å¿½ç•¥ä¸è®¡äº†ã€‚</p>\n<p>å¦å¤–ï¼Œå¦‚æœ A å’Œ B æ˜¯åŒä¸€ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆè¿”å›çš„ç»“æœå°†æ˜¯ <code class=\"language-text\">0</code>ï¼Œå› ä¸º A å’Œ B çš„å…³ç³»ä¸å±äºä¸Šé¢åˆ—å‡ºçš„ä»»ä½•ä¸€ç§æƒ…å†µã€‚åŒæ—¶ï¼Œä¹Ÿä¸éš¾å‘ç°ï¼Œåªæœ‰å½“ A å’Œ B æ˜¯åŒä¸€ä¸ªå…ƒç´ çš„æ—¶å€™ï¼Œæ‰ä¼šå‡ºç°è¿”å›å€¼æ˜¯ 0 çš„æƒ…å†µã€‚</p>","frontmatter":{"date":"2019-09-18","title":"compareDocumentPosition","category":"JavaScript"}}},{"node":{"id":"94771edf-9925-57ce-9664-d4ad9901aa9c","html":"<p>ç°åœ¨ Web ç«¯çš„è§†é¢‘æ’­æ”¾ï¼Œå¤§å¤šé‡‡ç”¨åŸºäº <a href=\"https://en.wikipedia.org/wiki/HTTP_Live_Streaming\">HLS</a> æˆ–æ˜¯ <a href=\"https://en.wikipedia.org/wiki/Dynamic_Adaptive_Streaming_over_HTTP\">MPEG Dash</a> çš„æ–¹æ¡ˆï¼Œå°†è§†é¢‘å†…å®¹åˆ†è§£æˆä¸€ç³»åˆ—å°å‹ HTTP æ–‡ä»¶ç‰‡æ®µï¼Œæ¯æ®µéƒ½åŒ…å«å¾ˆçŸ­é•¿åº¦çš„å¯æ’­æ”¾ç‰‡æ®µï¼Œç”±å‰ç«¯é€ä¸ªæ‹‰å–ç‰‡æ®µå¹¶æ’­æ”¾ï¼Œæœ€ç»ˆå½¢æˆå®Œæ•´çš„æ’­æ”¾è§†é¢‘ã€‚</p>\n<p>å¯¹äºä¸€äº›äº‘å­˜å‚¨ç½‘ç«™æ¥è¯´ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ç±»ä¼¼çš„æ–¹æ¡ˆæ¥ä¸ºç”¨æˆ·æä¾›ä¸‹è½½æœåŠ¡ã€‚åœ¨åˆ†ç‰‡ä¸‹è½½æ–‡ä»¶çš„è¿‡ç¨‹ä¸­ï¼ŒæœåŠ¡å•†å¯ä»¥å¯¹ä¸‹è½½çš„ç”¨æˆ·è¿›è¡Œæ ¡éªŒã€‚åŒæ—¶ï¼Œç”±äºéœ€è¦åˆ†æ®µä¸‹è½½å†…å®¹å¹¶æ‹¼æ¥ï¼Œé¿å…äº†å•ä¸€ URL é€ æˆç›—é“¾ç­‰é—®é¢˜ã€‚ç„¶è€Œï¼Œä¸€ä¸ªç”¨æˆ·ä½“éªŒçš„é—®é¢˜æ˜¯ï¼Œè¿™ç§å½¢å¼çš„ä¸‹è½½å¦‚ä½•å¯ä»¥ç»™ç”¨æˆ·ä¸€ä¸ªæ›´å¥½çš„ç”¨æˆ·ä½“éªŒï¼šæ˜¾ç„¶ä¸èƒ½å°†åˆ†æ®µçš„ä¸‹è½½å†…å®¹ç›´æ¥å‘ˆç°ç»™ç”¨æˆ·ï¼Œç”¨æˆ·ä¹Ÿä¸åº”è¯¥å…³å¿ƒè¿™äº›åˆ†ç‰‡çš„å†…å®¹ï¼›å¦‚æœè¦ç­‰åˆ°å‰ç«¯å°†æ‰€æœ‰å†…å®¹ä¸‹è½½å®Œæˆå¹¶æ‹¼æ¥åå†å‘ˆç°ç»™å®¢æˆ·ï¼Œé‚£ä¹ˆåœ¨æ–‡ä»¶è¾ƒå¤§çš„æ—¶å€™ä¼šè®©ç”¨æˆ·ç­‰å¾…å¾ˆä¹…ï¼Œç”¨æˆ·ä½“éªŒä¸ä½³ã€‚</p>\n<p>è¿™æ—¶å€™ï¼Œå°±å¯ä»¥ç”¨åˆ° Service Worker çš„ Proxy åŠŸèƒ½äº†ï¼Œå¯ä»¥åœ¨å‰ç«¯è¿›è¡Œæ‹¼æ¥æ•°æ®çš„è¿‡ç¨‹ä¸­ï¼Œç»™ç”¨æˆ·ç­‰åŒäºä¸€èˆ¬ä¸‹è½½æ–‡ä»¶çš„ä½“éªŒã€‚</p>\n<p>å¤§è‡´çš„æµç¨‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<p>é¦–å…ˆï¼Œéœ€è¦åœ¨ Service Worker å’Œ Main çº¿ç¨‹è§å»ºç«‹ä¸€ä¸ªé€šä¿¡æœºåˆ¶ã€‚æ¯”å¦‚ï¼Œå¯ä»¥é€‰æ‹©ä½¿ç”¨ MessageChannelã€‚åœ¨ Main çº¿ç¨‹åˆ›å»ºä¸€ä¸ª MessageChannelï¼Œç„¶åå°† Channel å‘é€ç»™ Service Workerã€‚ä¹‹åä¸¤è€…é€šè¿‡è¿™ä¸ª Channel è¿›è¡Œæ•°æ®çš„æ²Ÿé€šï¼ˆä¸»è¦æ˜¯ Main å°†ä¸‹è½½å¥½çš„æ–‡ä»¶ç‰‡æ®µå‘é€ç»™ Service Workerï¼‰ã€‚</p>\n<p>æ¥ç€ï¼Œåœ¨ Service Worker ç«¯çš„ MessageChannel æ”¶åˆ°æ–°çš„æ•°æ®ä¹‹åï¼Œåˆ›å»ºä¸€ä¸ª ReadableStream å¹¶å°†æ•°æ®å†™å…¥è¿™ä¸ª Streamã€‚</p>\n<p>æœ€åï¼ŒMain ä¼šé€šè¿‡ JavaScript è®¿é—®ä¸€ä¸ªä¸å­˜åœ¨çš„ä¸‹è½½é“¾æ¥ï¼Œé‡Œé¢åº”è¯¥åŒ…å«ä¸€ä¸ª IDï¼Œç”¨äºæŒ‡æ˜éœ€è¦çš„æ–‡ä»¶å…·ä½“æ˜¯å“ªä¸€ä¸ªï¼ˆä¸»è¦æ˜¯è€ƒè™‘åˆ°å¤šä¸ªæ–‡ä»¶åŒæ—¶ä¸‹è½½çš„æƒ…å†µï¼‰ã€‚Service Worker é€šè¿‡ fetch äº‹ä»¶æ‹¦æˆªè¿™ä¸ªè¯·æ±‚ï¼Œå¹¶é€šè¿‡ URL ä¸­çš„ ID æ‰¾åˆ°å¯¹åº”çš„ ReadableStreamï¼Œå¹¶å°†è¿™ä¸ª Stream ä½œä¸º Response è¿”å›ã€‚è¿™æ ·ï¼Œåœ¨æµè§ˆå™¨çš„ä¸‹è½½é¡µé¢å°±å¯ä»¥çœ‹åˆ°è¯¥æ–‡ä»¶æ­£åœ¨è¢«ä¸‹è½½ã€‚å’ŒåŸç”Ÿçš„ä¸‹è½½ä½“éªŒä¸€è‡´ï¼Œè¿™é‡Œä¹Ÿå¯ä»¥çœ‹åˆ°ä¸‹è½½çš„åç§°ã€å½“å‰çš„é€Ÿåº¦ã€å‰©ä½™çš„æ—¶é—´ç­‰ä¿¡æ¯ã€‚</p>\n<p>å¦‚æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„æµç¨‹å°±èµ°å®Œäº†ã€‚å‰ç«¯ä¸‹è½½æ–‡ä»¶åˆ†ç‰‡ï¼Œå°†åˆ†ç‰‡æ•°æ®å‘é€ç»™ Service Workerï¼ŒService Worker æ”¶åˆ°æ•°æ®ä¹‹åï¼Œå°†æ•°æ®å†™å…¥åˆ° ReadableStream ä¸­å»ï¼›åŒæ—¶ï¼Œè¿™ä¸ª ReadableStream ä»¥ Response çš„å½¢å¼è¿”å›ç»™ Main çº¿ç¨‹ï¼Œå°†è¿™ä¸ªæ‹¼æ¥ä¸­çš„æ–‡ä»¶é€æ­¥ä¸‹è½½åˆ°æœ¬åœ°ã€‚</p>\n<p>Fetch äº‹ä»¶çš„ä»£ç†ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">self<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onfetch</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> url <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// è·³è¿‡ä¸€èˆ¬çš„è¯·æ±‚</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isDownloadUrl</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> headers <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Headers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  headers<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'application/octet-stream; charset=UTF-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// è·å– URL ä¸­çš„ ID æ•°æ®</span>\n  <span class=\"token comment\">// ç›¸å½“äº Main çº¿ç¨‹é€šè¿‡ URL ä¼ é€’å‚æ•°ç»™ Service Workerï¼Œç”¨äºè¡¨ç¤ºæƒ³è¦ä¸‹è½½çš„å…·ä½“æ•°æ®</span>\n  <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token function\">getDownloadFileID</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> streamInfo <span class=\"token operator\">=</span> streamMapping<span class=\"token punctuation\">[</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>streamInfo<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// æ²¡æœ‰æ‰¾åˆ°æ•°æ®çš„æƒ…å†µï¼Œè¿”å› 404</span>\n    <span class=\"token keyword\">return</span> event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Not Found'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n      headers<span class=\"token punctuation\">,</span>\n      status<span class=\"token punctuation\">:</span> <span class=\"token number\">404</span><span class=\"token punctuation\">,</span>\n      statusText<span class=\"token punctuation\">:</span> <span class=\"token string\">'Not Found'</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> filename <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> streamInfo<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// Content-Disposition ä¸­çš„ filename å¿…é¡»æ˜¯ US-ASCII</span>\n  <span class=\"token comment\">// http://tools.ietf.org/html/rfc2183#section-2.3</span>\n  <span class=\"token keyword\">const</span> asciiName <span class=\"token operator\">=</span> filename<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/[^\\x20-\\x7e\\xa0-\\xff]/g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'?'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// é€šè¿‡ filename*=UTF-8''xxx è¿™æ ·çš„æ–¹å¼ï¼Œå¯ä»¥è®©æµè§ˆå™¨ä½¿ç”¨ UTF-8 çš„æ–‡ä»¶å</span>\n  <span class=\"token keyword\">const</span> encodedName <span class=\"token operator\">=</span> <span class=\"token function\">encodeURIComponent</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/['()]/g</span><span class=\"token punctuation\">,</span> escape<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/\\*/g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"%2A\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  headers<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span>\n    <span class=\"token string\">'Content-Disposition'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">attachment; filename=\"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>asciiName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\"; filename*=UTF-8''</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>encodedName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  headers<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Content-Length'</span><span class=\"token punctuation\">,</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>streamInfo<span class=\"token punctuation\">.</span>filesize<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  headers<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">'X-Content-Type-Options'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'nosniff'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// å°† Service Worker ä¸­çš„ stream ä½œä¸º Response è¿”å›</span>\n  <span class=\"token comment\">// åªè¦ Stream æ²¡æœ‰å®Œç»“ï¼Œæµè§ˆå™¨çš„ä¸‹è½½è¡Œä¸ºå°±ä¼šç»§ç»­ï¼Œç›´åˆ° Stream åœæ­¢</span>\n  <span class=\"token keyword\">return</span> event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span>streamInfo<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    headers\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å…³äºä¸Šé¢ä»£ç çš„ä¸¤ä¸ªå»¶ä¼¸é˜…è¯»ï¼š</p>\n<ol>\n<li>è™½ç„¶ Content-Disposition é»˜è®¤åªèƒ½å†™ ASCII çš„æ–‡ä»¶åï¼Œä½†æ˜¯ UTF-8 çš„æ–‡ä»¶åä¹Ÿæ˜¯å¯ä»¥è®¾ç½®çš„ã€‚å…³äº <code class=\"language-text\">filename*=UTF-8&#39;&#39;xxx</code> è¿™ç§è®¾ç½®æ–¹æ¡ˆï¼Œåœ¨ <a href=\"https://stackoverflow.com/questions/93551/how-to-encode-the-filename-parameter-of-content-disposition-header-in-http\">StackOverflow</a> ä¸Šæœ‰ç›¸å…³è®¨è®º</li>\n<li><code class=\"language-text\">X-COntent-Type-Options</code> è®¾ç½®ä¸º <code class=\"language-text\">nosniff</code> å¯ä»¥é˜»æ­¢æµè§ˆå™¨çš„ <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types#MIME_sniffing\">MIME ç±»å‹å—…æ¢</a>ï¼Œæ›´å¤šè®¨è®ºå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/X-Content-Type-Options\">MDN</a></li>\n</ol>\n<p>åˆ›å»ºå’Œä½¿ç”¨ Stream çš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> stream <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ReadableStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      <span class=\"token function-variable function\">start</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">controller</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span>stream<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n      <span class=\"token function-variable function\">pull</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">controller</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve<span class=\"token punctuation\">,</span> reject</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// å½“ä» Stream è·å–æ•°æ®çš„æ—¶å€™ï¼Œè¿”å›ä¸€ä¸ª Promise</span>\n          <span class=\"token comment\">// å¹¶åœ¨ onUpdate èµ‹å€¼ï¼Œç­‰å¾… Main çº¿ç¨‹çš„æ•°æ®</span>\n          <span class=\"token comment\">// å½“ Main çº¿ç¨‹ä¼ é€’æ–°æ•°æ®ä¹‹åï¼Œè°ƒç”¨è¿™é‡Œçš„ onUpdate å‡½æ•°ï¼Œå°† data ä¼ å…¥</span>\n          <span class=\"token comment\">// æ¥ä¸‹æ¥é€šè¿‡ FileReader è¯»å–æ•°æ®ï¼Œè½¬åŒ–æˆ Uint8Arrayï¼Œæ”¾å…¥ Stream ä¸­</span>\n          <span class=\"token comment\">// åœ¨æ¸…é™¤ onUpdate å‡½æ•°ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡ Pull</span>\n          streamInfo<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onUpdate</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">data<span class=\"token punctuation\">,</span> callback</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">const</span> reader <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">FileReader</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            reader<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onload</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">e</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n              <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> target <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> e<span class=\"token punctuation\">;</span>\n              <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>streamInfo<span class=\"token punctuation\">.</span>stream<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n                controller<span class=\"token punctuation\">.</span><span class=\"token function\">enqueue</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                streamInfo<span class=\"token punctuation\">.</span>onUpdate <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n                <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n                <span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n              <span class=\"token punctuation\">}</span>\n            <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n            reader<span class=\"token punctuation\">.</span><span class=\"token function\">readAsArrayBuffer</span><span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n          <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä» Main è·å–æ•°æ®å¹¶æ›´æ–°ç»™ Stream çš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">self<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmessage</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> data<span class=\"token punctuation\">,</span> ports <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> event<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>portA <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span> portB <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> ports<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> promise <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Promise</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">resolve</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// æ ¹æ®æ¶ˆæ¯ç±»å‹ï¼Œé€‰æ‹©åˆ›å»ºä¸€ä¸ªæ–°çš„ stream æˆ–æ˜¯å¾€ä¸€ä¸ªå·²ç»åˆ›å»ºçš„ stream ä¸­å†™å…¥æ•°æ®</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'create'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">getStream</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">stream</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        streamInfo<span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n          filesize<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">.</span>filesize<span class=\"token punctuation\">,</span>\n          filename<span class=\"token punctuation\">:</span> data<span class=\"token punctuation\">.</span>filename<span class=\"token punctuation\">,</span>\n          stream\n        <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>data<span class=\"token punctuation\">.</span>type <span class=\"token operator\">===</span> <span class=\"token string\">'insert'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      portB<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">onmessage</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> chunk <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> msg<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>streamInfo<span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span>onUpdate<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n          streamInfo<span class=\"token punctuation\">[</span>data<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">onUpdate</span><span class=\"token punctuation\">(</span>chunk<span class=\"token punctuation\">,</span> resolve<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n          <span class=\"token comment\">// ç­‰å¾… onUpdate API åˆ›å»º...</span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">waitUntil</span><span class=\"token punctuation\">(</span>promise<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><a href=\"https://www.myairbridge.com/en/\">MyAirBridge</a> ç½‘ç«™ä½¿ç”¨äº†ç±»ä¼¼ä¸Šé¢æåˆ°çš„æŠ€æœ¯æ¥ä¸‹è½½ä¸­çš„æ–‡ä»¶å†…å®¹ã€‚Service Worker çš„ä»£ç å‚è€ƒ<a href=\"https://www.myairbridge.com/media/js_compiled/sw-download-10bfedd.js\">è¿™é‡Œ</a>ã€‚</p>","frontmatter":{"date":"2019-09-16","title":"Download Chunk via ServiceWorker","category":"JavaScript"}}},{"node":{"id":"f7451aff-6ab3-5bdd-8b2b-72f907953d51","html":"<p>JavaScript æä¾›äº† copy äº‹ä»¶ï¼Œå¯ä»¥é’ˆå¯¹ä¸€èˆ¬çš„å¤åˆ¶åŠ¨ä½œè¿›è¡Œä¸€äº›é¢å¤–çš„æ“ä½œã€‚æ¯”å¦‚ï¼Œä¸€äº›ç½‘ç«™å‡ºäºç‰ˆæœ¬çš„è€ƒè™‘ï¼Œå¯èƒ½ä¼šç¦æ­¢æ‹·è´ï¼›æˆ–è€…ï¼Œä¸€äº›ç½‘ç«™å…è®¸æ‹·è´ï¼Œä½†æ˜¯ä¼šå¸Œæœ›åœ¨æ‹·è´çš„å†…å®¹åé¢åŠ ä¸Šä¸€äº›ç‰ˆæƒçš„å£°æ˜ã€‚è¿™äº›æ“ä½œï¼Œéƒ½å¯ä»¥é€šè¿‡ copy äº‹ä»¶è¿›è¡Œå¤„ç†ã€‚</p>\n<p>ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœå¸Œæœ›ç¦æ­¢ç½‘ç«™ä¸Šå†…å®¹çš„æ‹·è´ï¼Œå¯ä»¥å†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œé€šè¿‡ <code class=\"language-text\">event.preventDefault</code> API çš„è°ƒç”¨ï¼Œå¯ä»¥ç»„ç»‡æµè§ˆå™¨é»˜è®¤çš„å¤åˆ¶è¡Œä¸ºã€‚è¿™æ ·ï¼Œå³ä½¿ç”¨æˆ·è¿›è¡Œäº†å¤åˆ¶ï¼Œå®é™…ä¸Šå‰ªè´´æ¿ä¹Ÿä¸ä¼šè¢«æ›´æ–°ã€‚</p>\n<p>ç¬¬äºŒä¸ªä¾‹å­ï¼Œå‡è®¾å¸Œæœ›åœ¨å¤åˆ¶çš„å†…å®¹åé¢åŠ ä¸Šé¢å¤–çš„æ•°æ®ï¼Œå¯ä»¥å†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> selection <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getSelection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> text <span class=\"token operator\">=</span> selection<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  event<span class=\"token punctuation\">.</span>clipboardData<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text/plain'</span><span class=\"token punctuation\">,</span> text <span class=\"token operator\">+</span> <span class=\"token string\">'\\nExtra Text at Bottom'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>éœ€è¦æ³¨æ„å‡ ç‚¹ï¼š</p>\n<ol>\n<li><code class=\"language-text\">setData</code> çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®çš„æ ¼å¼ï¼Œæ”¯æŒçš„ç±»å‹å¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/DataTransfer/types\">MDN</a>ï¼Œä¸»è¦å°±æ˜¯ <a href=\"https://en.wikipedia.org/wiki/MIME\">MIME</a> ç±»å‹ï¼Œä¸€èˆ¬çº¯æ–‡æœ¬å¯ä»¥ä½¿ç”¨ <code class=\"language-text\">text/plain</code></li>\n<li>åœ¨è°ƒç”¨ <code class=\"language-text\">setData</code> ä¹‹åï¼Œéœ€è¦è°ƒç”¨ <code class=\"language-text\">event.preventDefault</code> æ‰èƒ½ä¿è¯è®¾ç½®æˆåŠŸï¼Œå¦åˆ™æœ€ç»ˆå¤åˆ¶å‡ºæ¥çš„ä¾ç„¶æ˜¯åŸå§‹çš„æ–‡æ¡ˆ</li>\n</ol>\n<p>æœ€åï¼Œéœ€è¦è¯´æ˜çš„ä¸€ç‚¹æ˜¯ï¼šå‡ºäºæµ‹è¯•æˆ–è€…å…¶ä»–ç›®çš„ï¼ŒJavaScript ä¹Ÿæ”¯æŒåˆ›å»ºä¸€ä¸ª ClipboardEvent å¹¶å‘é€ç»™ç›‘å¬çš„å…ƒç´ ï¼Œå¦‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy event triggered'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  event<span class=\"token punctuation\">.</span>clipboardData<span class=\"token punctuation\">.</span><span class=\"token function\">setData</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text/plain'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'hello world'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> event <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ClipboardEvent</span><span class=\"token punctuation\">(</span><span class=\"token string\">'copy'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> clipboardData<span class=\"token punctuation\">:</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">DataTransfer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nwindow<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é‚£ä¹ˆï¼Œå›è°ƒå‡½æ•°å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼ˆConsole å¯ä»¥çœ‹åˆ°è¾“å‡ºï¼‰ï¼Œä½†æ˜¯ event å†…å°è¯•è®¾ç½® Clipboard çš„æ•°æ®å¹¶ä¸ä¼šæˆåŠŸã€‚</p>\n<p>æ€»ä½“ä¸Šæ¥è¯´ï¼Œæµè§ˆå™¨ç«¯æä¾›çš„ Copy äº‹ä»¶ï¼Œåªèƒ½è·å–/ä¿®æ”¹æµè§ˆå™¨å†…å‘ç”Ÿçš„å‰ªè´´æ¿å¤åˆ¶æ“ä½œï¼›å¯¹äºç”¨æˆ·æœ¬èº«å‰ªè´´æ¿æ“ä½œå†…æœ‰çš„æ•°æ®æ˜¯æ— æ³•è¯»å–çš„ï¼Œåœ¨éç”¨æˆ·è§¦å‘çš„æƒ…å†µä¸‹ï¼Œå‰ªè´´æ¿çš„æ•°æ®ä¹Ÿæ˜¯æ— æ³•ç›´æ¥è¢«ä¿®æ”¹çš„ã€‚</p>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/ClipboardEvent\">å»¶ä¼¸é˜…è¯»</a>ã€‚</p>","frontmatter":{"date":"2019-09-10","title":"Clipboard Event","category":"JavaScript"}}},{"node":{"id":"03a25784-6757-5c28-9084-94b5270eb170","html":"<p>å‰ç«¯é¡¹ç›®ï¼Œæ€»å…ä¸äº†å†™ä¸€äº›æ“ä½œ URL ä¸­ query string çš„ API ä»£ç ï¼Œæ¯”å¦‚è¯»å–å½“å‰ URL ä¸­çš„ query æ•°æ®ï¼Œæˆ–æ˜¯æ ¹æ®ä¸€ä¸ª Object å¯¹è±¡æ‹¼æ¥å‡ºä¸€ä¸ª query stringï¼Œç­‰ç­‰ã€‚</p>\n<p>å…¶å®ï¼Œç°ä»£æµè§ˆå™¨ä¸­å·²ç»æä¾›äº† <code class=\"language-text\">URLSearchParams</code> ç±»ï¼Œå¯ä»¥å¤§å¤§ç®€åŒ–è¿™éƒ¨åˆ†çš„æ“ä½œï¼Œä¹Ÿæ— éœ€å†è‡ªå·±ç»´æŠ¤ä¸€ä¸ª <code class=\"language-text\">qs</code> æˆ–æ˜¯ç±»ä¼¼çš„åŒ…äº†ã€‚</p>\n<p>ä»¥ä¸‹ä»‹ç»å¦‚ä½•é€šè¿‡ <code class=\"language-text\">URLSearchParams</code> å®ç° <code class=\"language-text\">qs.stringify</code> å’Œ <code class=\"language-text\">qs.parse</code> API çš„æ–¹æ³•ï¼š</p>\n<p><code class=\"language-text\">qs.parse</code> çš„æ–¹æ³•æ¯”è¾ƒç®€å•ï¼Œåªéœ€è¦å°†å­—ç¬¦ä¸²ä¼ é€’ç»™ <code class=\"language-text\">URLSearchParams</code> å¹¶åˆ›å»ºå®ä¾‹å°±å¯ä»¥äº†ï¼Œå®ä¾‹æœ¬èº«è‡ªå¸¦äº† iteratorï¼Œä¹Ÿæä¾› <code class=\"language-text\">get</code>ï¼Œ<code class=\"language-text\">keys</code> ç­‰ API èƒ½å¾ˆæ–¹ä¾¿çš„è·å–éœ€è¦çš„æ•°æ®ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> searchParams <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URLSearchParams</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> param <span class=\"token keyword\">of</span> searchParams<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> param<span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œä¸è®ºå‚æ•°ä¼ å…¥çš„å­—ç¬¦ä¸²æ˜¯å¦ä»¥ <code class=\"language-text\">?</code> å­—ç¬¦å¼€å¤´ï¼Œ<code class=\"language-text\">URLSearchParams</code> éƒ½é»˜è®¤å¯ä»¥æ­£ç¡®å¤„ç†ï¼Œä¸éœ€è¦åƒ <code class=\"language-text\">qs</code> åŒ…ä¸€æ ·æ˜¾ç¤ºçš„æŒ‡æ˜ç»™å®šçš„å­—ç¬¦ä¸²æ˜¯å¦æœ‰ <code class=\"language-text\">?</code> å¼€å¤´ï¼ˆ<code class=\"language-text\">ignoreQueryPrefix</code>ï¼‰ã€‚</p>\n<p>è¦å®ç° <code class=\"language-text\">qs.stringify</code> çš„åŠŸèƒ½ä¹Ÿä¸éš¾ï¼Œ<code class=\"language-text\">URLSearchParams</code> çš„æ„é€ å™¨æ”¯æŒä¼ å…¥ä¸€ä¸ªæ•°ç»„æˆ–ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿæä¾›äº† <code class=\"language-text\">append</code> API å¯ä»¥å°† key value ä¸€ç»„ä¸€ç»„çš„åŠ å…¥åˆ°å¯¹è±¡ä¸­ï¼Œæœ€ååªè¦ä½¿ç”¨ <code class=\"language-text\">toString</code> æ‹¼æ¥å‡ºä¸€ä¸ªå®Œæ•´çš„å­—ç¬¦ä¸²å°±å¯ä»¥äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token comment\">// result in: `a=b`</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">URLSearchParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> a<span class=\"token punctuation\">:</span> <span class=\"token string\">'b'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// result in: `c=d&amp;e=f`</span>\n<span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">URLSearchParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'c'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'d'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'e'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'f'</span><span class=\"token punctuation\">]</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ³¨æ„ï¼Œ<code class=\"language-text\">toString</code> æ–¹æ³•å¾—åˆ°çš„å­—ç¬¦ä¸²ï¼Œæœ€å¼€å¤´å¹¶æ²¡æœ‰å¸¦ä¸Š <code class=\"language-text\">?</code> å­—ç¬¦ï¼Œå¦‚æœæœ‰éœ€è¦çš„è¯ï¼Œå¯ä»¥è‡ªè¡ŒåŠ ä¸Šã€‚</p>\n<p>ç»¼ä¸Šï¼Œä¸‹é¢çš„ç­‰å¼æ˜¯æˆç«‹çš„ï¼ˆå‡å®š <code class=\"language-text\">location.search</code> ä¸æ˜¯ä¸€ä¸ªç©ºå­—ç¬¦ä¸²ï¼‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">location<span class=\"token punctuation\">.</span>search <span class=\"token operator\">===</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">?</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">URLSearchParams</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span></code></pre></div>\n<p>å½“ç„¶ï¼Œ<code class=\"language-text\">URLSearchParams</code> åœ¨æŸäº›åœºæ™¯ä¸‹è¿˜æ˜¯ä¸èƒ½æ›¿æ¢ <code class=\"language-text\">qs</code> ä¹‹ç±»çš„åº“ï¼Œæ¯”å¦‚ï¼š</p>\n<ol>\n<li>é¡¹ç›®éœ€è¦æ”¯æŒè€æµè§ˆå™¨ï¼Œå¦‚ IE æ—¶ã€‚<code class=\"language-text\">URLSearchParams</code> çš„æµè§ˆå™¨æ”¯æŒæƒ…å†µè§ï¼š<a href=\"https://caniuse.com/#search=URLSearchParams\">CanIUse</a>ï¼Œæ€»ä½“æ¥è¯´ï¼Œç°ä»£çš„æµè§ˆå™¨éƒ½å·²ç»æ”¯æŒäº†ï¼Œä½†æ˜¯ IE å®Œå…¨æ²¡æœ‰ã€‚</li>\n<li>éœ€è¦ä½¿ç”¨ä¸€äº›æ¯”è¾ƒå†·é—¨çš„è§£æåŠŸèƒ½æ—¶ï¼Œå¦‚ <code class=\"language-text\">qs</code> æä¾›äº†å¾ˆå¤šå¤æ‚çš„è§£ææ–¹æ¡ˆï¼ˆè¯¦æƒ…è§<a href=\"https://www.npmjs.com/package/qs\">æ–‡æ¡£</a>ï¼‰</li>\n</ol>\n<p>ä½†æ€»ä½“æ¥è¯´ï¼Œç»å¤§éƒ¨åˆ†çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œ<code class=\"language-text\">URLSearchParams</code> éƒ½å¯ä»¥è½»æ¾åº”å¯¹ï¼Œä¸éœ€è¦é¢å¤–çš„åº“è¿›è¡Œå¿—æ„¿äº†ã€‚</p>\n<p>æ›´å¤šå…³äº <code class=\"language-text\">URLSearchParams</code> çš„ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/URLSearchParams\">MDN</a>ï¼Œ<a href=\"https://developers.google.com/web/updates/2016/01/urlsearchparams?hl=en\">Easy URL Manipulation with URLSearchParams</a> æˆ– <a href=\"https://url.spec.whatwg.org/#urlsearchparams\">WHATWG Spec</a>ã€‚</p>","frontmatter":{"date":"2019-09-05","title":"URLSearchParams","category":"JavaScript"}}},{"node":{"id":"3caff78d-44ef-5789-bfc1-5ef5c4332649","html":"<p>JavaScript å†…å»ºçš„ <code class=\"language-text\">String.prototype.replace</code> å‡½æ•°ï¼Œå¦‚æœä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæ›¿æ¢è¡Œä¸ºåªä¼šå‘ç”Ÿä¸€æ¬¡ã€‚å¦‚æœéœ€è¦å°†ä¸€ä¸ªå­—ç¬¦ä¸²å†…æ‰€æœ‰æŸå­å­—ç¬¦ä¸²éƒ½æ›¿æ¢æ‰ï¼Œå¾€å¾€éœ€è¦ä¸€äº›é¢å¤–çš„æ“ä½œã€‚ä»¥ä¸‹æä¾›ä¸€äº›å¯è¡Œçš„æ–¹æ¡ˆï¼š</p>\n<ol>\n<li>ä½¿ç”¨å¾ªç¯è¿›è¡Œå¤šæ¬¡æ›¿æ¢</li>\n</ol>\n<p>æœ€ç›´è§‚çš„æƒ³æ³•ï¼Œå°±æ˜¯æ›¿æ¢å®Œæˆåé€šè¿‡ <code class=\"language-text\">indexOf</code> ç­‰æ–¹æ¡ˆæŸ¥æ‰¾å­—ç¬¦ä¸²ï¼Œå¦‚æœè¿˜æœ‰å°±ç»§ç»­æ›¿æ¢ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">input<span class=\"token punctuation\">,</span> <span class=\"token keyword\">from</span><span class=\"token punctuation\">,</span> to</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> input <span class=\"token operator\">=</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">,</span> <span class=\"token keyword\">from</span><span class=\"token punctuation\">,</span> to<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> input<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å½“ç„¶ï¼Œè¿™å¹¶ä¸æ˜¯ä¸€ä¸ªä¼˜é›…çš„è§£å†³æ–¹æ¡ˆã€‚</p>\n<ol start=\"2\">\n<li>ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼</li>\n</ol>\n<p><code class=\"language-text\">String.prototype.replace</code> æ”¯æŒç¬¬ä¸€ä¸ªå‚æ•°ä¼ é€’æ­£åˆ™è¡¨è¾¾å¼ã€‚æœ‰äº†æ­£åˆ™è¡¨è¾¾å¼ï¼Œåªè¦è®¾ç½®ä¸Š <code class=\"language-text\">g</code> æ ‡ç­¾ï¼Œå°±å¯ä»¥å…¨å±€åŒ¹é…å¹¶æ›¿æ¢æ‰€æœ‰çš„æƒ…å†µäº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">input<span class=\"token punctuation\">,</span> <span class=\"token keyword\">from</span><span class=\"token punctuation\">,</span> to</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">RegExp</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'g'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> to<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™ä¸ªæ–¹æ¡ˆçš„åŠ£åŠ¿åœ¨äºï¼Œå¦‚æœéœ€è¦æ›¿æ¢çš„å†…å®¹ä¸­å«æœ‰æŸäº›æ­£åˆ™è¡¨è¾¾å¼ç‰¹æœ‰çš„åŒ¹é…ç¬¦å·ï¼Œå¯èƒ½ä¼šå¯¼è‡´éé¢„æœŸçš„ç»“æœã€‚ä¸¾ä¸ªä¾‹å­æ¥è¯´ï¼Œå¦‚æœå¸Œæœ›æŠŠ <code class=\"language-text\">.+</code> è¿™ä¸ªå­—ç¬¦ä¸²æ›¿æ¢æˆ <code class=\"language-text\">+.</code> è¿™æ ·ï¼Œä¸Šé¢çš„å‡½æ•°å¹¶ä¸èƒ½è¾¾åˆ°é¢„æœŸçš„æ•ˆæœï¼Œå› ä¸º <code class=\"language-text\">.+</code> åœ¨æ­£åˆ™è¡¨è¾¾å¼ä¸­å¯ä»¥åŒ¹é…ä»»æ„çš„å­—ç¬¦ã€‚<code class=\"language-text\">replace(&#39;hello.+world&#39;, &#39;.+&#39;, &#39;+.&#39;)</code> çš„æ‰§è¡Œç»“æœæ˜¯ <code class=\"language-text\">+.</code>ã€‚</p>\n<ol start=\"3\">\n<li>ä½¿ç”¨ <code class=\"language-text\">split</code> &#x26; <code class=\"language-text\">join</code></li>\n</ol>\n<p>è¿™æ˜¯ä¸€ä¸ªæ¯”è¾ƒå–å·§çš„æ–¹æ¡ˆï¼Œå…ˆç”¨ <code class=\"language-text\">split</code> å‡½æ•°å°†å­—ç¬¦ä¸²è¿›è¡Œæ‹†åˆ†ï¼Œç„¶åå†ç”¨ <code class=\"language-text\">join</code> å°†æ‹†åˆ†åçš„ç»“æœé‡æ–°æ‹¼æ¥èµ·æ¥ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">input<span class=\"token punctuation\">,</span> <span class=\"token keyword\">from</span><span class=\"token punctuation\">,</span> to</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> input<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">from</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span>to<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™ä¸ªæ–¹æ¡ˆä»£ç æ¯”è¾ƒç®€æ´ï¼Œä¹Ÿä¸ä¼šæœ‰æ­£åˆ™è¡¨è¾¾å¼ä¸­æåˆ°çš„é—®é¢˜ã€‚è™½ç„¶è®¡ç®—ä¼šäº§ç”Ÿä¸­é—´å˜é‡ï¼ˆæ•°ç»„ï¼‰ï¼Œä½†åªè¦ä¸æ˜¯é¢‘ç¹æˆ–åœ¨å¤§è§„æ¨¡æ•°æ®ä¸Šä½¿ç”¨ï¼Œæ•ˆç‡çš„å½±å“å¯ä»¥å¿½ç•¥ä¸è®¡ã€‚</p>","frontmatter":{"date":"2019-08-14","title":"Replace All Substring","category":"JavaScript"}}},{"node":{"id":"82f9644e-2191-5f1f-9758-880c26b73c6d","html":"<p>åœ¨ä½¿ç”¨ stylelint çš„æ—¶å€™ï¼Œå‘ç°äº†ä¸€ä¸ªæœ‰è¶£çš„é—®é¢˜ï¼šå¦‚æœç›´æ¥ä½¿ç”¨ stylelint çš„ <code class=\"language-text\">bin</code> æ–‡ä»¶å¯¹æ‰¹é‡ LESS æ–‡ä»¶è¿›è¡Œæ£€æŸ¥ï¼Œç¨‹åºå¯ä»¥å¦‚é¢„æœŸçš„è¿è¡Œï¼›ä½†æ˜¯å¦‚æœæŠŠåŒæ ·çš„å‘½ä»¤å†™åˆ° <code class=\"language-text\">package.json</code> ä¸­ï¼Œä»¥ npm script çš„æ–¹å¼è¿›è¡Œè¿è¡Œï¼Œæœ€ç»ˆè¢«æ£€æŸ¥çš„æ–‡ä»¶å°±å°‘äº†å¾ˆå¤šï¼Œå®é™…åªæœ‰ä¸€ä¸ªæ–‡ä»¶å‚ä¸äº†æ£€æŸ¥ã€‚</p>\n<p>å…·ä½“æ¥è¯´ï¼Œ<code class=\"language-text\">./node_modules/.bin/stylelint src/**/*.less</code> è¿™ä¸ªå‘½ä»¤å¯ä»¥æ£€æŸ¥æ‰€æœ‰çš„ LESS æ–‡ä»¶ï¼Œä½†æ˜¯æŠŠ <code class=\"language-text\">stylelint src/**/*.less</code> å†™åˆ° <code class=\"language-text\">package.josn</code> ä¸­ä¹‹åï¼Œå†è¿è¡Œå´åªæ£€æŸ¥äº†ä¸€ä¸ªæ–‡ä»¶ã€‚</p>\n<p>é€šè¿‡æ£€æŸ¥ stylelint çš„<a href=\"https://github.com/stylelint/stylelint/blob/master/docs/user-guide/cli.md\">æ–‡æ¡£</a>ï¼Œå‘ç°å®˜æ–¹åœ¨å†™å‘½ä»¤çš„æ—¶å€™ï¼Œå†™æ³•å’Œä¸Šè¿°ç•¥æœ‰ä¸åŒï¼Œä¸ºï¼š<code class=\"language-text\">stylelint &quot;src/**/*.less&quot;</code>ã€‚</p>\n<p>ç»è¿‡æ’æŸ¥é—®é¢˜ï¼Œå‘ç°æ ¹æºåœ¨äºï¼š<code class=\"language-text\">npm</code> ä½¿ç”¨äº† <code class=\"language-text\">sh</code> æ¥æ‰§è¡Œä»£ç ï¼Œè€Œ <code class=\"language-text\">sh</code> å’Œ <code class=\"language-text\">zsh</code> åœ¨è§£æ Glob çš„æ—¶å€™ï¼Œè¡Œä¸ºæ˜¯ä¸åŒçš„ã€‚</p>\n<p><code class=\"language-text\">npm</code>ï¼ŒåŒ…æ‹¬å…¶ä»– Linux è¿›ç¨‹ï¼Œåœ¨ä½¿ç”¨ shell çš„æ—¶å€™ï¼Œé»˜è®¤ä½¿ç”¨çš„éƒ½æ˜¯ <code class=\"language-text\">sh</code>ï¼Œé™¤éæœ‰å…¶ä»–æ˜ç¡®çš„æŒ‡å®šã€‚è¿™æ„å‘³ç€ï¼Œå³ä½¿å½“å‰æ­£åœ¨ä½¿ç”¨çš„ shell æ˜¯ <code class=\"language-text\">zsh</code>ï¼Œåœ¨è¿è¡Œ <code class=\"language-text\">npm</code> å‘½ä»¤çš„æ—¶å€™ï¼Œè¿˜æ˜¯é»˜è®¤ä½¿ç”¨äº† <code class=\"language-text\">sh</code> å¯¹è„šæœ¬è¿›è¡Œæ‰§è¡Œã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ<code class=\"language-text\">./node_modules/.bin/stylelint src/**/*.less</code> è¿™ä¸ªå‘½ä»¤æ‰§è¡Œï¼Œä½¿ç”¨çš„æ˜¯å½“å‰æ‰“å¼€çš„ shell ç¨‹åºï¼ˆæ¯”å¦‚ <code class=\"language-text\">zsh</code>ï¼‰ï¼›è€Œå½“è¿™ä¸ªå‘½ä»¤å†™åˆ° <code class=\"language-text\">package.json</code> ä¸­ï¼Œå¹¶ä»¥ npm script çš„æ–¹å¼è¿›è¡Œè¿è¡Œçš„æ—¶å€™ï¼Œæ‰§è¡Œ shell çš„å°±æ˜¯ <code class=\"language-text\">sh</code> äº†ã€‚</p>\n<p>ä½¿ç”¨ä¸åŒçš„ shell ç¨‹åºï¼Œéš¾å…å°±ä¼šåœ¨è¡Œä¸ºä¸Šé€ æˆä¸ä¸€è‡´ã€‚è¿™é‡Œçš„ Glob è§£æå°±æ˜¯ä¸€ä¸ªä¾‹å­ã€‚åœ¨ <code class=\"language-text\">zsh</code> é‡Œé¢å¯ä»¥ç®€å•çš„åšä¸€ä¸ªå®éªŒã€‚æ‰§è¡Œå¦‚ä¸‹çš„å‘½ä»¤ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">ls</span> src/**/*.less</code></pre></div>\n<p>å¯ä»¥çœ‹åˆ°ï¼Œ<code class=\"language-text\">zsh</code> ç»™å‡ºäº†å½“å‰ <code class=\"language-text\">src</code> ç›®å½•ä¸‹æ‰€æœ‰çš„ LESS æ–‡ä»¶ï¼Œ ä¸ç®¡è¿™ä¸ªæ–‡ä»¶æ˜¯åœ¨å¤šæ·±çš„å­ç›®å½•ä¸‹ï¼›è€Œå¦‚æœå…ˆåœ¨ <code class=\"language-text\">zsh</code> ä¸­æ‰§è¡Œ <code class=\"language-text\">sh</code> æˆ– <code class=\"language-text\">bash</code> è¿›å…¥åˆ° <code class=\"language-text\">sh</code> æˆ– <code class=\"language-text\">bash</code> çš„å·¥ä½œç¯å¢ƒä¸­ï¼Œå†æ‰§è¡ŒåŒæ ·çš„å‘½ä»¤ï¼Œå¯ä»¥çœ‹åˆ°è¾“å‡ºçš„ç»“æœå¯èƒ½å°±æ˜¯ä¸åŒçš„ã€‚å®é™…ä¸Šï¼Œå¯¹äº <code class=\"language-text\">sh</code> æ¥è¯´ï¼Œå®ƒæœ¬èº«å¹¶ä¸è¯†åˆ« <code class=\"language-text\">**</code> è¿™ä¸ªè¯­æ³•ï¼Œè¿™ä¸ªè¡¨ç¤ºåœ¨ <code class=\"language-text\">sh</code> ä¸­ä¼šè¢«ç®€å•çš„è¯†åˆ«ä¸º <code class=\"language-text\">*</code>ï¼Œ<code class=\"language-text\">src/**/*.less</code> åœ¨ <code class=\"language-text\">sh</code> ä¸­ç­‰ä»·äº <code class=\"language-text\">src/*/*.less</code>ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨ <code class=\"language-text\">sh</code> çš„ç¯å¢ƒä¸­ï¼Œä¸Šè¿°å‘½ä»¤åªä¼šå¯»æ‰¾æ‰€æœ‰åœ¨ <code class=\"language-text\">src</code> ç›®å½•ä¸‹ä¸€çº§å­ç›®å½•ä¸­çš„ LESS æ–‡ä»¶ï¼Œä¸€æ—¦å±‚çº§å¤§äºä¸€å±‚ï¼Œå°±ä¸ä¼šè¢«æ‰¾åˆ°äº†ã€‚</p>\n<p>è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåŒæ ·çš„å‘½ä»¤ï¼Œç›´æ¥æ‰§è¡Œå’Œåœ¨ npm ä¸­æ‰§è¡Œä¼šæœ‰å·®å¼‚çš„åŸå› ã€‚</p>\n<p>æœ€åï¼ŒåŠ ä¸ŠåŒå¼•å· <code class=\"language-text\">stylelint &quot;src/**/*.less&quot;</code> å°±å¯ä»¥è§£å†³è¿™ä¸€é—®é¢˜çš„åŸå› åœ¨äºï¼šä¸€æ—¦åŠ ä¸Šäº†åŒå¼•å·ï¼Œè¿™ä¸€ä¸ª Glob å°±ä¸ä¼šè¢« shell ç›´æ¥è§£æï¼Œè€Œæ˜¯ä¼šä»¥å­—ç¬¦ä¸²çš„å½¢å¼ç›´æ¥ä¼ é€’ç»™ stylelintã€‚ï¼ˆå…·ä½“æ¥è¯´ï¼Œå¦‚æœä¸åŠ åŒå¼•å·ï¼Œshell ä¼šå…ˆå°† Glob è§£ææˆä¸€ç»„å…·ä½“çš„æ–‡ä»¶ï¼Œstylelint å®é™…æ‹¿åˆ°çš„ <code class=\"language-text\">process.env.argv</code> å¾ˆå¯èƒ½ä¼šæ˜¯ä¸€ä¸ªå¾ˆé•¿çš„å­—ç¬¦ä¸²æ•°ç»„ï¼Œæ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå…·ä½“çš„æ–‡ä»¶ï¼›è€Œå¦‚æœåŠ ä¸Šäº†åŒå¼•å·ï¼Œstylelint æ‹¿åˆ°çš„åªæœ‰ä¸€ä¸ª Glob è¡¨è¾¾å¼å­—ç¬¦ä¸²ã€‚ï¼‰æœ‰äº†è¿™ä¸ª Glob çš„å­—ç¬¦ä¸²ï¼Œstylelint å†…éƒ¨å°±å¯ä»¥ä½¿ç”¨ç›¸åº”çš„ package æ¥è¿›è¡Œè§£æï¼Œä»è€Œå¾—åˆ°ä¸€ä¸²å…·ä½“çš„æ–‡ä»¶åˆ—è¡¨ã€‚å› ä¸ºä½¿ç”¨äº† stylelint å†…éƒ¨è‡ªå¸¦çš„ Glob è§£æï¼Œå°±å¯ä»¥ä¿è¯åœ¨ä¸åŒçš„ shell ç¯å¢ƒä¸­éƒ½å¾—åˆ°ä¸€è‡´çš„ç»“æœäº†ã€‚</p>\n<p><a href=\"https://stackoverflow.com/questions/32017169/npm-glob-pattern-not-matching-subdirectories\">å‚è€ƒ</a></p>","frontmatter":{"date":"2019-08-13","title":"Glob in NPM","category":"JavaScript"}}},{"node":{"id":"31721418-7e10-5793-aaa4-841cd465e306","html":"<p>JavaScript ä¸­å¯ä»¥å¾ˆæ–¹ä¾¿åœ¨å­—ç¬¦ä¸²å’Œæ•°å­—ä¹‹é—´è¿›è¡Œè½¬æ¢ï¼Œæ¯”å¦‚ï¼š<code class=\"language-text\">+&#39;123&#39;</code> => <code class=\"language-text\">123</code>ï¼Œ<code class=\"language-text\">(123).toString()</code> => <code class=\"language-text\">&#39;123&#39;</code>ã€‚</p>\n<p>ç„¶è€Œï¼Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼ŒJavaScript ä¸­çš„æ•°å­—å¹¶ä¸æ˜¯æ•´æ•°ï¼Œè€Œæ˜¯æµ®ç‚¹æ•°ã€‚æ›´ç¡®åˆ‡çš„è¯´ï¼Œæ•°å­—ä½¿ç”¨çš„æ˜¯ 64 bit åŒç²¾åº¦æµ®ç‚¹æ•°æ¥è¡¨ç¤ºçš„ã€‚è¿™æ„å‘³ç€ï¼Œå¦‚æœæœåŠ¡å™¨å­˜å‚¨çš„æ•°å­—æ˜¯ä¸€ä¸ª Int64ï¼Œé‚£ä¹ˆåœ¨ç»™åˆ°å‰ç«¯çš„æ—¶å€™ï¼Œå¾ˆæœ‰å¯èƒ½ä¼šå‡ºç°è½¬åŒ–ä¸Šçš„é—®é¢˜ã€‚å¯¹äºåŒç²¾åº¦æµ®ç‚¹æ•°æ¥è¯´ï¼Œèƒ½å¤Ÿè¡¨ç¤ºçš„æœ€å¤§çš„æ•°æ˜¯ <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mn>2</mn><mn>53</mn></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{53}-1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œè¶…è¿‡çš„éƒ¨åˆ†å°±ä¼šè¢«æˆªæ–­ï¼Œæ— æ³•ç²¾ç¡®è¡¨ç¤ºã€‚</p>\n<p>æ¯”å¦‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span><span class=\"token string\">'9223372036854775808'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span>\n<span class=\"token comment\">// output: 9223372036854776000</span></code></pre></div>\n<p>JavaScript æä¾›äº† <code class=\"language-text\">Number.isSafeInteger</code> è¿™ä¸ª API æ¥åˆ¤æ–­ä¸€ä¸ªæ•°å­—æ˜¯å¦æ˜¯åœ¨å¯è¡¨ç¤ºçš„å®‰å…¨èŒƒå›´å†…ã€‚æ¯”å¦‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isSafeInteger</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: false</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isSafeInteger</span><span class=\"token punctuation\">(</span><span class=\"token number\">9223372036854776000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: false</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Number<span class=\"token punctuation\">.</span><span class=\"token function\">isSafeInteger</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">53</span> <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: true</span></code></pre></div>\n<p>è¿™é‡Œï¼Œ<code class=\"language-text\">2 ** 53 - 1</code> å°±æ˜¯ JavaScript ä¸­å¯ä»¥è¡¨ç¤ºçš„æœ€å¤§æ•´æ•°ï¼Œ<code class=\"language-text\">Number.MAX_SAFE_INTEGER</code> è¿™ä¸ªå¸¸é‡ä¹Ÿç­‰äºè¿™ä¸ªå€¼ã€‚è¶…è¿‡è¿™ä¸ªæ•°å€¼çš„æ‰€æœ‰å€¼éƒ½ä¼šè¢«è®¤ä¸ºæ˜¯ä¸å®‰å…¨çš„ï¼Œå“ªæ€•è¯¥å€¼å®é™…è¡¨ç¤ºçš„ç»“æœâ€œå‡‘å·§â€æ˜¯æ­£ç¡®çš„ã€‚ä¸Šä¾‹ä¸­ï¼Œ<code class=\"language-text\">9223372036854776000</code> è¿™ä¸ªæ•°å­—çš„è¡¨ç¤ºç»“æœâ€œåˆšå¥½â€å°±æ˜¯ <code class=\"language-text\">9223372036854776000</code> æœ¬èº«ï¼Œä½†æ˜¯å› ä¸ºè¿™ä¸ªæ•°å·²ç»è¶…è¿‡äº† <span class=\"katex\"><span class=\"katex-mathml\"><math><semantics><mrow><msup><mn>2</mn><mn>53</mn></msup><mo>âˆ’</mo><mn>1</mn></mrow><annotation encoding=\"application/x-tex\">2^{53} - 1</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.897438em;vertical-align:-0.08333em;\"></span><span class=\"mord\"><span class=\"mord\">2</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8141079999999999em;\"><span style=\"top:-3.063em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\"><span class=\"mord mtight\">5</span><span class=\"mord mtight\">3</span></span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span><span class=\"mbin\">âˆ’</span><span class=\"mspace\" style=\"margin-right:0.2222222222222222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.64444em;vertical-align:0em;\"></span><span class=\"mord\">1</span></span></span></span>ï¼Œæ‰€ä»¥ä¾ç„¶è¢«åˆ¤å®šä¸ºæ˜¯ä¸å®‰å…¨çš„ã€‚</p>\n<p>è™½ç„¶ JavaScript æœ¬èº«çš„æ•°å­—ä¸æ”¯æŒå¤§æ•°ï¼Œä½†æ˜¯ Chrome å·²ç»é›†æˆäº† <code class=\"language-text\">BigInt</code> æ•°æ®ç±»å‹ï¼Œå®ƒå¯ä»¥è¢«ç”¨äºè¡¨ç¤ºä»»æ„å¤§çš„æ•´å½¢æ•°å­—ï¼Œå¯ä»¥ç”¨äºè¿™æ ·çš„ä½¿ç”¨åœºæ™¯ã€‚ï¼ˆæ³¨ï¼š<code class=\"language-text\">BigInt</code> æœ¬èº«è¿˜åœ¨ staging 3ï¼Œå¹¶ä¸æ˜¯æ ‡å‡†çš„ä¸€éƒ¨åˆ†ï¼‰</p>\n<p>ç®€å•çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> num <span class=\"token operator\">=</span> <span class=\"token function\">BigInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span> <span class=\"token operator\">**</span> <span class=\"token number\">63</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// or:</span>\n<span class=\"token comment\">// const num = BigInt('9223372036854776000');</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: 9223372036854775808n</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: bigint</span></code></pre></div>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code class=\"language-text\">BigInt</code> ä¸å¯ä»¥ä½¿ç”¨ <code class=\"language-text\">new</code> è¿ç®—ç¬¦ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚ç›´æ¥åƒå‡½æ•°ä¸€æ ·ä¼ é€’å‚æ•°è°ƒç”¨å°±å¯ä»¥äº†ã€‚</p>\n<p><code class=\"language-text\">BigInt</code> ä¹Ÿæ˜¯æ”¯æŒæ•°å­—è¿ç®—çš„ï¼Œè¿ç®—çš„ç»“æœä¾ç„¶æ˜¯ <code class=\"language-text\">BigInt</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">1n</span> <span class=\"token operator\">+</span> <span class=\"token number\">2n</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => 3n</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">3n</span> <span class=\"token operator\">-</span> <span class=\"token number\">1n</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => 2n</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">2n</span> <span class=\"token operator\">*</span> <span class=\"token number\">3n</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => 6n</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token number\">5n</span> <span class=\"token operator\">/</span> <span class=\"token number\">2n</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => 2n</span></code></pre></div>\n<p>ç‰¹åˆ«éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå› ä¸ºæ˜¯æ•´å‹æ•°å­—ä¹‹é—´çš„è½¬æ¢ï¼Œæ‰€ä»¥åœ¨åšé™¤æ³•çš„æ—¶å€™ï¼Œä¸ä¼šå‡ºç°å°æ•°ã€‚åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œ<code class=\"language-text\">5n</code> å’Œ <code class=\"language-text\">2n</code> çš„é™¤æ³•ï¼Œç»“æœæ˜¯ <code class=\"language-text\">2n</code> è€Œä¸æ˜¯ <code class=\"language-text\">2.5</code>ï¼Œè¿™ä¸€ä¸ªè¡Œä¸ºå’Œ C ä¸­ä¸¤ä¸ª Integer ä¹‹é—´é™¤æ³•çš„è¡Œä¸ºæ˜¯ä¸€è‡´çš„ã€‚</p>\n<p>å¦å¤–ï¼Œ<code class=\"language-text\">BigInt</code> ä¸æ”¯æŒå’Œå…¶ä»–çš„æ•°æ®ç±»å‹è¿›è¡Œæ··åˆè®¡ç®—ã€‚æ¯”å¦‚ï¼š<code class=\"language-text\">1n + 2</code> è¿™æ ·çš„è®¡ç®—æ˜¯ä¼šæŠ¥é”™çš„ï¼Œéœ€è¦æ˜¾å¼çš„è¿›è¡Œç±»å‹è½¬æ¢åï¼Œæ‰å¯ä»¥è¿›è¡Œè¿ç®—ã€‚è¿™ä¸€ç‚¹ï¼Œå’Œ JavaScript ä¸­å…¶ä»–æ•°æ®ç±»å‹ä¹‹é—´éšæ„æ··ä¹±çš„è¿ç®—è¡Œä¸ºæ˜¯ä¸åŒçš„ï¼ˆæ¯”å¦‚ï¼Œ<code class=\"language-text\">1 + &#39;2&#39;</code> è¿™æ ·çš„è®¡ç®— JavaScript å°±ä¸ä¼šæŠ¥é”™ï¼Œè¿˜ä¼šå¾—åˆ° <code class=\"language-text\">&#39;12&#39;</code> è¿™æ ·æ€ªå¼‚çš„ç»“æœï¼‰ã€‚</p>\n<p>è™½ç„¶ <code class=\"language-text\">BigInt</code> ä¸å…è®¸å’Œä¸€èˆ¬çš„ <code class=\"language-text\">Number</code> è¿›è¡Œæ··åˆè®¡ç®—ï¼Œä½†æ˜¯æ¯”è¾ƒè¿ç®—ç¬¦æ˜¯å¯ä»¥åœ¨ä¸¤è€…ä¹‹é—´è¿›è¡Œæ¯”è¾ƒçš„ã€‚æ¯”å¦‚ï¼š<code class=\"language-text\">1n &lt; 2</code> æˆ– <code class=\"language-text\">2n &gt; 1</code> è¿™äº›éƒ½æ˜¯æˆç«‹çš„ã€‚<code class=\"language-text\">BigInt</code> å’Œ <code class=\"language-text\">Number</code> ä¹‹é—´æ— æ³•å–å¾— <code class=\"language-text\">===</code> çš„ä¸¥æ ¼ç­‰ä»·å…³ç³»ï¼Œä½†æ˜¯ <code class=\"language-text\">==</code> çš„æ¯”è¾ƒæ˜¯å¯èƒ½æˆç«‹çš„ã€‚æ¢å¥è¯è¯´ï¼š<code class=\"language-text\">1n == 1</code> æ˜¯æˆç«‹çš„ï¼Œä½†æ˜¯ <code class=\"language-text\">1n === 1</code> æ˜¯ä¸æˆç«‹çš„ã€‚</p>\n<p>æ›´å¤šå…³äº <code class=\"language-text\">BigInt</code> çš„è¡Œä¸ºï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/BigInt\">MDN</a>ã€‚</p>","frontmatter":{"date":"2019-08-08","title":"Big Number in JavaScript","category":"JavaScript"}}},{"node":{"id":"68d67c21-2405-5153-9308-b645937f95e6","html":"<p>å½“ Ant Design å’Œ Jest ä¸€èµ·ä½¿ç”¨çš„æ—¶å€™ï¼Œåœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆå¼€å¯ coverage çš„æ—¶å€™ï¼‰ä¼šå¯¼è‡´å•å…ƒæµ‹è¯•è¿è¡Œå¤±è´¥ã€‚ä¸€ä¸ªå¯èƒ½é€ æˆé—®é¢˜çš„ Ant Design ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Input <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'antd'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> TextArea <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> Input<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Jest ä¼šæŠ¥é”™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">ReferenceError: Input is not defined\n\n  1 | import { Input } from &#39;ant-design&#39;;\n  2 |\n&gt; 3 | const { TextArea } = Input;</code></pre></div>\n<p>æŠ¥é”™çš„ç›´æ¥åŸå› ï¼Œæ˜¯ä½¿ç”¨äº† Ant Design æ¨èçš„ <code class=\"language-text\">babel-plugin-import</code> å’Œ Jest è®¡ç®— coverage ä½¿ç”¨çš„ <code class=\"language-text\">babel-plugin-istanbul</code> é€ æˆçš„ã€‚åœ¨<a href=\"https://github.com/ant-design/babel-plugin-import/issues/172\">è¿™é‡Œ</a>ã€<a href=\"https://github.com/ant-design/babel-plugin-import/issues/189#issuecomment-445139343\">è¿™é‡Œ</a>ç­‰ GitHub Issue ä¸­éƒ½æœ‰ç›¸åº”çš„è®¨è®ºã€‚</p>\n<p>è¦ä¿®å¤è¿™ä¸ªé—®é¢˜ï¼Œåªéœ€è¦åœ¨ Jest æˆ–è€…å•å…ƒæµ‹è¯•ç¯å¢ƒä¸­ï¼Œä¸ä½¿ç”¨ <code class=\"language-text\">babel-plugin-import</code> è¿™ä¸ªè½¬æ¢æ’ä»¶å°±å¯ä»¥äº†ã€‚å‚è€ƒä»£ç å¦‚ä¸‹ï¼Œåœ¨ <code class=\"language-text\">.babelrc</code> ä¸­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"env\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"development\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token punctuation\">[</span>\n          <span class=\"token string\">\"import\"</span><span class=\"token punctuation\">,</span>\n          <span class=\"token punctuation\">{</span>\n            <span class=\"token property\">\"libraryName\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"antd\"</span><span class=\"token punctuation\">,</span>\n            <span class=\"token property\">\"style\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n          <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span>\n      <span class=\"token punctuation\">]</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"production\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// same as above</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"plugins\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token comment\">// rest of plugins...</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å¦‚æ­¤ä¸€æ¥ï¼Œåªæœ‰åœ¨ <code class=\"language-text\">NODE_ENV</code> ä¸º <code class=\"language-text\">production</code> æˆ– <code class=\"language-text\">development</code> çš„æƒ…å†µä¸‹ï¼ŒBabel æ‰ä¼šå¯ç”¨ <code class=\"language-text\">babel-plugin-import</code> è¿™ä¸ªè½¬æ¢æ’ä»¶ã€‚å¯¹äº Jest æ¥è¯´ï¼Œå› ä¸ºé»˜è®¤è®¾ç½®äº†ç¯å¢ƒå˜é‡ <code class=\"language-text\">NODE_ENV</code> ä¸º <code class=\"language-text\">test</code>ï¼Œæ‰€ä»¥ Plugin ä¸ä¼šèµ·æ•ˆã€‚</p>\n<p>è¿™æ ·é€ æˆçš„é—®é¢˜æ˜¯ Jest çš„è¿è¡Œé€Ÿåº¦ä¼šæœ‰æ‰€é™ä½ã€‚</p>","frontmatter":{"date":"2019-07-29","title":"Jest with Ant Design","category":"JavaScript"}}},{"node":{"id":"13ce68d9-ae34-52fe-942d-558fe782b3ff","html":"<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒWebapck ä¼šç”¨ Chunk ID ä¸º <code class=\"language-text\">import()</code> äº§ç”Ÿçš„ç‹¬ç«‹æ–‡ä»¶å‘½åï¼Œæœ€ç»ˆçš„ç»“æœå°±æ˜¯ç±»ä¼¼äº <code class=\"language-text\">0.bundle.js</code> è¿™æ ·çš„æ–‡ä»¶ã€‚è¿™æ ·çš„æ–‡ä»¶å¹¶ä¸æ–¹ä¾¿ç†è§£å’Œç®¡ç†ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¼šä½¿ç”¨ <code class=\"language-text\">webpackChunkName</code> è¿™ä¸ªæ³¨é‡Šæ¥è®© Webapck ä½¿ç”¨æ›´åŠ æœ‰æ„ä¹‰çš„å‘½åã€‚ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span><span class=\"token punctuation\">(</span><span class=\"token comment\">/* webpackChunkName: \"module-name\" */</span> <span class=\"token string\">'path-to-bundle'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æœ€ç»ˆäº§ç”Ÿçš„æ–‡ä»¶ä¸º <code class=\"language-text\">module-name.bundle.js</code>ï¼ˆè¿™é‡Œå‡è®¾åœ¨ Webpack ä¸­é…ç½®äº† <code class=\"language-text\">output.filename</code> ä¸º <code class=\"language-text\">[name].bundle.js</code>ï¼‰ã€‚</p>\n<p>ç„¶è€Œï¼Œæ¯æ¬¡è¦æ‰‹å†™è¿™æ ·çš„æ³¨é‡Šæœ‰äº›éº»çƒ¦ã€‚å¦‚æœåŠ¨æ€åŠ è½½çš„æ¨¡å—æœ¬èº«å­˜æ”¾ä½ç½®æœ‰è§„å¾‹å¯å¾ªï¼ˆæ¯”å¦‚æ˜¯åœ¨ pages ç›®å½•ä¸‹ï¼Œæ¯ä¸ªç›®å½•æœ‰ä¸€ä¸ªå…¥å£æ–‡ä»¶ï¼‰ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥è€ƒè™‘ä½¿ç”¨ Babel æ’ä»¶çš„æ–¹å¼ï¼Œè‡ªåŠ¨ä¸ºæ¯ä¸ª <code class=\"language-text\">import()</code> å¢åŠ åˆé€‚çš„ bundle nameã€‚</p>\n<p>å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">addComments</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">arg<span class=\"token punctuation\">,</span> name</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// only add leading comment when not found</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>arg<span class=\"token punctuation\">.</span>leadingComments<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n  arg<span class=\"token punctuation\">.</span>leadingComments <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span>\n    type<span class=\"token punctuation\">:</span> <span class=\"token string\">'CommentBlock'</span><span class=\"token punctuation\">,</span>\n    value<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> webpackChunkName: '</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">' </span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getChunkNameFromImportPath</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">importPath</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// find a way to transform from import path to chunk name</span>\n  <span class=\"token comment\">// example: from 'path/to/file' to 'path.to.file' as chunk name</span>\n  <span class=\"token keyword\">return</span> importPath<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/\\//g</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">babel</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> types<span class=\"token punctuation\">:</span> t <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> babel<span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    name<span class=\"token punctuation\">:</span> <span class=\"token string\">'add-bundle-name'</span><span class=\"token punctuation\">,</span>\n    visitor<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function-variable function\">CallExpression</span><span class=\"token punctuation\">:</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> node <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> path<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>t<span class=\"token punctuation\">.</span><span class=\"token function\">isImport</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>callee<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>firstArg<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>arguments<span class=\"token punctuation\">;</span>\n        <span class=\"token keyword\">const</span> importPath <span class=\"token operator\">=</span> firstArg<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n        <span class=\"token function\">addComments</span><span class=\"token punctuation\">(</span>firstArg<span class=\"token punctuation\">,</span> <span class=\"token function\">getChunkNameFromImportPath</span><span class=\"token punctuation\">(</span>importPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"date":"2019-07-26","title":"Import Chunkname with Babel Plugin","category":"JavaScript"}}},{"node":{"id":"ef748804-1095-5434-84f6-d397a65f89c8","html":"<p><code class=\"language-text\">navigator.platform</code> å¯ä»¥è·å–åˆ°å½“å‰æµè§ˆå™¨æ‰€åœ¨çš„æ“ä½œç³»ç»Ÿä¿¡æ¯ã€‚ä¸€èˆ¬æ¥è¯´ä¼šå¾—åˆ°ä¸€ä¸ªå­—ç¬¦ä¸²ç”¨ä»¥è¡¨ç¤ºæ“ä½œç³»ç»Ÿï¼Œä½†æŸäº›æƒ…å†µä¸‹ä¹Ÿå¯èƒ½ä¼šæ‹¿åˆ°ç©ºå­—ç¬¦ä¸²ï¼ˆæµè§ˆå™¨æ‹’ç»æˆ–ä¸èƒ½ç»™å‡ºæ“ä½œç³»ç»Ÿä¿¡æ¯ï¼‰ã€‚</p>\n<p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œå³ä½¿æ˜¯ 64 ä½çš„ Windows æ“ä½œç³»ç»Ÿï¼Œå¾—åˆ°çš„ç»“æœå¾ˆå¯èƒ½æ˜¯ <code class=\"language-text\">Win32</code> è€Œä¸æ˜¯ <code class=\"language-text\">Win64</code>ã€‚æ ¹æ® <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/NavigatorID/platform\">MDN</a> çš„æ•°æ®ï¼ŒInternet Explorer å’Œ v63 å‰çš„ Firefox ä¼šä½¿ç”¨ <code class=\"language-text\">Win64</code>ï¼Œå…¶ä»–çš„ä¸€èˆ¬è¿”å› <code class=\"language-text\">Win32</code>ã€‚</p>\n<p>ç»¼ä¸Šï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•æ£€æµ‹å½“å‰æ˜¯å¦æ˜¯ Windows ç³»ç»Ÿï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> isWindows <span class=\"token operator\">=</span> navigator<span class=\"token punctuation\">.</span>platform<span class=\"token punctuation\">.</span><span class=\"token function\">indexOf</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Win'</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">navigator.platform</code> åŸºæœ¬æ²¡æœ‰æµè§ˆå™¨å…¼å®¹æ€§é—®é¢˜ï¼Œå¯ä»¥æ”¾å¿ƒä½¿ç”¨ã€‚</p>","frontmatter":{"date":"2019-07-18","title":"navigator.platform","category":"JavaScript"}}},{"node":{"id":"511c0dca-7c47-5ea0-824c-cc3b1825762f","html":"<p>console ä¸­å¯ä»¥é€šè¿‡ <code class=\"language-text\">console.count</code> æ¥è¿›è¡Œè®°æ•°ã€‚</p>\n<p>ç®€å•çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">callMe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">count</span><span class=\"token punctuation\">(</span><span class=\"token string\">'callMe func'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">countReset</span><span class=\"token punctuation\">(</span><span class=\"token string\">'callMe func'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">callMe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// output => callMe func: 1</span>\n<span class=\"token function\">callMe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// output => callMe func: 2</span>\n<span class=\"token function\">callMe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// output => callMe func: 3</span></code></pre></div>\n<p>å‡ ç‚¹è¯´æ˜ï¼š</p>\n<ul>\n<li><code class=\"language-text\">console.countReset</code> å‡½æ•°å¯ä»¥ç”¨äºæ¸…ç©ºè®°æ•°</li>\n<li>ä¼ é€’çš„å‚æ•°å¯ä»¥ç”¨äºæ ‡è®° <code class=\"language-text\">count</code> çš„ç±»åˆ«ï¼Œå¦‚æœä¸ä¼ å°±æ˜¯é»˜è®¤çš„ default</li>\n<li>ä¸åŒç±»åˆ«ä¹‹é—´çš„ <code class=\"language-text\">count</code> ä¸ä¼šå…±äº«æ•°æ®</li>\n</ul>","frontmatter":{"date":"2019-07-17","title":"console.count","category":"JavaScript"}}},{"node":{"id":"c7a15ba7-a5dc-5bc3-bcf8-b0e56e30a319","html":"<p>åœ¨ Windows ä¸Šï¼Œå¾ˆå¤šæ–‡æœ¬æ–‡ä»¶å¹¶ä¸æ˜¯ä»¥ UTF-8 çš„æ ¼å¼è¿›è¡Œå­˜å‚¨çš„ã€‚æ¯”å¦‚ï¼Œä¸­æ–‡å¯èƒ½çš„å­˜å‚¨æ ¼å¼æ˜¯ GB2312 æˆ–æ˜¯ BIG5ã€‚è¿™å¯¼è‡´ï¼Œåœ¨å…¶ä»–ç³»ç»Ÿä¸­ï¼Œå¦‚æœç›´æ¥ä»¥ UTF-8 çš„æ ¼å¼æ‰“å¼€å¯¹åº”çš„æ–‡æœ¬æ–‡ä»¶ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸²ä¹±ç ã€‚</p>\n<p>å¦‚æœä¸çŸ¥é“ä¹‹å‰æ˜¯ä»¥ä»€ä¹ˆæ ¼å¼å­˜å‚¨çš„æ–‡ä»¶ï¼Œè¿™æ—¶å°±ä¼šæœ‰ç‚¹æŸæ‰‹æ— ç­–äº†ã€‚</p>\n<p>ä¸€ä¸ªå¯è¡Œçš„ç®€å•æ–¹æ³•æ˜¯ç”¨ VSCode çš„â€œçŒœæµ‹â€åŠŸèƒ½ã€‚åœ¨ VSCode ä¸­ï¼Œå¦‚æœé€‰æ‹© <code class=\"language-text\">Reopen with Encoding</code>ï¼Œä¼šå¾—åˆ° VSCode çŒœæµ‹çš„å½“å‰æ–‡æœ¬ç¼–ç æ ¼å¼ã€‚å¦‚æœä½¿ç”¨æ–°çš„ç¼–ç é‡æ–°æ‰“å¼€æ–‡æœ¬ï¼Œçœ‹åˆ°çš„ä¸å†æ˜¯ä¹±ç ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½ VSCode å°±çŒœæµ‹æ­£ç¡®äº†ã€‚ä¸€èˆ¬å»ºè®®å†ä»¥ UTF-8 çš„æ ¼å¼ä¿å­˜ä¸€ä¸‹ï¼Œä»¥åå†æ¬¡æ‰“å¼€å°±ä¸ä¼šæœ‰ä¹±ç çš„å›°æ‰°äº†ã€‚</p>\n<p>ç„¶è€Œï¼Œè¿™ä¸ªæ–¹æ³•ä¸é€‚åº”å¤§è§„æ¨¡æ‰¹é‡ä¿®æ”¹çš„éœ€æ±‚ã€‚æ—¢ç„¶å¦‚æ­¤ï¼Œä¸å¦‚ç›´æ¥ä» VSCode çš„æºç å…¥æ‰‹ï¼Œçœ‹çœ‹è¿™ä¸ªæ–‡æœ¬ç¼–ç æ£€æµ‹çš„åŠŸèƒ½æ˜¯å¦‚ä½•å®ç°çš„ã€‚</p>\n<p>VSCode ç›¸å…³çš„ä»£ç ï¼Œå¯ä»¥åœ¨ <code class=\"language-text\">src/vs/base/node/encoding.ts</code> ä¸­æ‰¾åˆ°ï¼ŒGitHub çš„ä»£ç åœ¨<a href=\"https://github.com/microsoft/vscode/blob/HEAD/src/vs/base/node/encoding.ts\">è¿™é‡Œ</a>ã€‚</p>\n<p>ç²¾ç®€åçš„ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> jschardet <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'jschardet'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> iconv <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'iconv-lite'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token constant\">JSCHARDET_TO_ICONV_ENCODINGS</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">'ibm866'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'cp866'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token string\">'big5'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'cp950'</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> fromPath <span class=\"token operator\">=</span> <span class=\"token string\">'/path/to/read/file'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> toPath <span class=\"token operator\">=</span> <span class=\"token string\">'/path/to/save/file'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> buffer <span class=\"token operator\">=</span> fs<span class=\"token punctuation\">.</span><span class=\"token function\">readFileSync</span><span class=\"token punctuation\">(</span>fromPath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> encoding <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> jschardet<span class=\"token punctuation\">.</span><span class=\"token function\">detect</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> iconvEncoding <span class=\"token operator\">=</span> <span class=\"token constant\">JSCHARDET_TO_ICONV_ENCODINGS</span><span class=\"token punctuation\">[</span>encoding<span class=\"token punctuation\">]</span> <span class=\"token operator\">||</span> encoding<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> iconv<span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>buffer<span class=\"token punctuation\">,</span> iconvEncoding<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span>filename<span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œä¸»è¦ç”¨åˆ°äº†ä¸¤ä¸ªåº“ï¼Œ<code class=\"language-text\">jschardet</code> å’Œ <code class=\"language-text\">iconv-lite</code>ã€‚</p>\n<p><a href=\"https://github.com/aadsm/jschardet\">jschardet</a> æ˜¯ Python <a href=\"https://github.com/chardet/chardet\">chardet</a> çš„ä¸€ä¸ª JavaScript ç§»æ¤ç‰ˆæœ¬ï¼Œç”¨äºæ£€æµ‹å½“å‰çš„äºŒè¿›åˆ¶æµï¼ˆBufferï¼‰æ˜¯ä»€ä¹ˆç±»å‹çš„ç¼–ç ã€‚æ£€æµ‹çš„å¤§è‡´åŸç†ï¼Œå¯ä»¥åœ¨ chardet çš„ç½‘ç«™ä¸Šæ‰¾åˆ°ï¼ˆ<a href=\"https://chardet.readthedocs.io/en/latest/how-it-works.html\">è¿™é‡Œ</a>ï¼‰ã€‚</p>\n<p><a href=\"https://github.com/ashtuchkin/iconv-lite\">iconv-lite</a> ç”¨äºå°†äºŒè¿›åˆ¶æµè½¬åŒ–æˆæŒ‡å®šç¼–ç æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œæ˜¯ä¸€ä¸ªçº¯ JavaScript çš„ <code class=\"language-text\">iconv</code> åº“ã€‚è¿™é‡Œ <code class=\"language-text\">iconv</code> çš„å…¨ç§°æ˜¯ internationalization conversionï¼Œåœ¨ç±» Unix ç³»ç»Ÿä¸­ï¼Œè¿™æ˜¯ä¸€ä¸ªç”¨äºè½¬æ¢ä¸åŒç¼–ç å­—ç¬¦ä¸²çš„å‘½ä»¤è¡Œå·¥å…·ã€‚</p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œ<code class=\"language-text\">iconv-lite</code> å¹¶ä¸é€šè¿‡ç¼–ç æ¥åŒºåˆ† UTF-8 å’Œ UTF-8 with BOMï¼Œè€Œæ˜¯é€šè¿‡ç¬¬äºŒä¸ªå‚æ•° <code class=\"language-text\">{ addBOM }</code> æ¥å®Œæˆçš„ã€‚å› æ­¤ï¼Œè½¬åŒ– UTF-8 with BOM çš„æ—¶å€™ï¼Œéœ€è¦ç¨å¾®æ‰‹åŠ¨å¤„ç†ä¸€ä¸‹ã€‚ï¼ˆå¤„ç†çš„æ–¹æ³•å¯ä»¥å‚è€ƒ VSCode ä¸­çš„ç›¸å…³å‡½æ•°ï¼Œæ¯”å¦‚ <code class=\"language-text\">encode</code>ï¼‰</p>\n<p>å¦å¤–ï¼Œ<code class=\"language-text\">jschardet</code> å’Œ <code class=\"language-text\">iconv-lite</code> å¯¹ç¼–ç çš„å‘½åæœ‰äº›ä¸åŒï¼Œä½¿ç”¨å‰éœ€è¦è½¬åŒ–ã€‚ä¸Šé¢ç¤ºä¾‹ä»£ç ä¸­çš„ <code class=\"language-text\">JSCHARDET_TO_ICONV_ENCODINGS</code> å°±æ˜¯åšçš„è¿™ä¸ªäº‹æƒ…ã€‚</p>","frontmatter":{"date":"2019-07-16","title":"Detect True Encoding of File and Convert","category":"JavaScript"}}},{"node":{"id":"e6335664-44bc-5877-bfde-94b17431ddb4","html":"<p>åœ¨ React å¼€å‘è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨ Facebook æä¾›çš„å®˜æ–¹ Chrome DevTool Extension å¯ä»¥å¾ˆæ–¹ä¾¿çš„æŸ¥çœ‹ï¼Œä¿®æ”¹é¡µé¢ä¸Šçš„ React ç»„ä»¶ã€‚ç„¶è€Œï¼Œæœ‰æ—¶å€™ä¹Ÿéœ€è¦åœ¨æ²¡æœ‰ DevTool çš„æƒ…å†µä¸‹ï¼Œå¯¹ React ç»„ä»¶è¿›è¡Œ Debugã€‚æ¯”å¦‚ï¼šåœ¨æµ‹è¯•ç”µè„‘ä¸ŠæŸ¥çœ‹ä¸€ä¸ªå³æ—¶å‡ºç°çš„é—®é¢˜ï¼Œæˆ–æ˜¯åœ¨ Internet Explorer / Safari ä¸Šè°ƒè¯•ä¸€ä¸ªå‡ºç°çš„é—®é¢˜ç­‰ã€‚</p>\n<p>ä»¥ä¸‹ä»‹ç»å¦‚ä½•åœ¨ä¸å€ŸåŠ© Chrome DevTool Extension çš„æƒ…å†µä¸‹ï¼Œå®Œæˆå¯¹å½“å‰ React ç»„ä»¶çš„æ£€æŸ¥ã€‚</p>\n<p>é¦–å…ˆï¼Œéœ€è¦è·å–åˆ°æŸä¸ªéœ€è¦æŸ¥çœ‹çš„ DOM å…ƒç´ ã€‚å¯ä»¥ç”¨ <code class=\"language-text\">querySelector</code> æˆ–æ˜¯åœ¨ Chrome DevTool ä¸­é€‰ä¸­æŸä¸ªå…ƒç´ ï¼Œç„¶ååœ¨ Console ä¸­ä½¿ç”¨ <code class=\"language-text\">$0</code> è·å¾—è¯¥å…ƒç´ ã€‚</p>\n<p>React ä¼šåœ¨å…ƒç´ ä¸Šæ·»åŠ é¢å¤–çš„å±æ€§ï¼Œç”¨äºè®°å½•å½“å‰è¿™ä¸ª React èŠ‚ç‚¹çš„ç›¸å…³æ•°æ®ã€‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç æ¥è·å–è¿™ä¸ªå±æ€§æ•°æ®ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getInstance</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> key <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>element<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span> <span class=\"token operator\">=></span> key<span class=\"token punctuation\">.</span><span class=\"token function\">startsWith</span><span class=\"token punctuation\">(</span><span class=\"token string\">'__reactInternalInstance$'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>key<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> element<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>React åœ¨æ·»åŠ å±æ€§çš„æ—¶å€™ï¼Œå±æ€§åç§°ä¼šå¢åŠ ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²ä½œä¸ºåç¼€ï¼ˆå„ä¸ª React Node ä½¿ç”¨çš„éšæœºå­—ç¬¦ä¸²æ˜¯ä¸€è‡´çš„ï¼‰ã€‚æ‰€ä»¥éœ€è¦é€šè¿‡æ£€æŸ¥ <code class=\"language-text\">startsWith</code> æ¥åˆ¤æ–­å½“å‰å±æ€§æ˜¯å¦æ˜¯ React ä½¿ç”¨çš„å±æ€§ã€‚</p>\n<p>æ‹¿åˆ°çš„è¿™ä¸ªå¯¹è±¡ï¼Œæœ‰ä¸€äº›æœ‰ç”¨çš„æ•°æ®ï¼ŒåŒ…æ‹¬ï¼š</p>\n<ul>\n<li>child - å½“å‰å…ƒç´ å­å…ƒç´ çš„å¤´ä¸ªå…ƒç´ </li>\n<li>elementType/type - è¯¥ React èŠ‚ç‚¹å¯¹åº”çš„ç±»å‹ã€‚å¦‚æœæ˜¯ HTML Elementï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯”å¦‚ <code class=\"language-text\">&quot;div&quot;</code>ï¼›å¦‚æœæ˜¯ä¸€ä¸ªè‡ªå®šä¹‰çš„ React å…ƒç´ ï¼Œåˆ™æ˜¯ä¸€ä¸ªå‡½æ•°ï¼ˆclass æˆ– functionï¼‰ã€‚ä¹Ÿå°±æ˜¯ <code class=\"language-text\">React.createElement</code> å‡½æ•°çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</li>\n<li>memoizedProps - å½“å‰å…ƒç´ ä½¿ç”¨çš„ propsã€‚å¯¹äºä»»ä½•ä¸€ä¸ª React ç”Ÿæˆçš„ HTML å…ƒç´ ï¼Œå¯¹ä¼šæœ‰å¯¹åº”çš„ Propsã€‚ï¼ˆå†™ JSX çš„æ—¶å€™ï¼Œæ¯ä¸€ä¸ªå±æ€§ï¼ŒåŒ…æ‹¬ childrenï¼Œéƒ½æ˜¯ä¸€ä¸ª Props çš„å±æ€§å€¼ï¼‰</li>\n<li>memoizedState - å½“å‰å…ƒç´ ä½¿ç”¨çš„ state</li>\n<li>return - å½“å‰å…ƒç´ æ‰€åœ¨åŒå‘é“¾è¡¨çš„ä¸Šä¸€ä¸ªå…ƒç´ </li>\n<li>sibling - å½“å‰å…ƒç´ ä¸‹ä¸€ä¸ªå…„å¼Ÿå…ƒç´ </li>\n<li>stateNode - å½“å‰å…ƒç´ åœ¨ç»„ä»¶å†…å¯ä»¥ç”¨çš„ <code class=\"language-text\">this</code>ï¼ŒåŒ…å«äº† <code class=\"language-text\">props</code>ï¼Œ<code class=\"language-text\">refs</code>ï¼Œ<code class=\"language-text\">state</code>ï¼Œ<code class=\"language-text\">context</code> ä»¥åŠå…¶ä»– React Component çš„æ–¹æ³•ã€‚åœ¨è¿™ä¸ªå¯¹è±¡çš„åŸå‹é“¾ä¸Šï¼Œè¿˜æœ‰ React Component ç»„ä»¶çš„å„ä¸ªæ–¹æ³•ï¼ˆæ¯”å¦‚ç”Ÿå‘½å‘¨æœŸå‡½æ•°å¦‚ <code class=\"language-text\">componentDidMount</code>ï¼‰ä»¥åŠ <code class=\"language-text\">setState</code> ç­‰å¯ç”¨æ–¹æ³•ã€‚æ¢å¥è¯è¯´ï¼Œè¿™é‡Œçš„å¯¹è±¡å°±æ˜¯ä¸€ä¸ª React Component Class ç”Ÿæˆçš„å®ä¾‹ã€‚å¦‚æœç»„ä»¶æ˜¯ä¸€ä¸ª Functional Componentï¼Œé‚£ä¹ˆè¿™é‡Œå°±æ˜¯ <code class=\"language-text\">null</code> äº†ã€‚</li>\n</ul>\n<p>æ ¹æ® React 16 ä¸­ Fiber çš„è®¾è®¡ï¼Œå…ƒç´ ä¹‹é—´æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨çš„å…³ç³»ï¼Œæ¯ä¸€ä¸ªèŠ‚ç‚¹ä¼šè¿ç»“å…¶ä¸Šä¸€ä¸ªå…ƒç´ ï¼ˆ<code class=\"language-text\">return</code>ï¼‰ï¼Œå­å…ƒç´ çš„é¦–ä¸ªå…ƒç´ ï¼ˆ<code class=\"language-text\">child</code>ï¼‰ï¼Œä¸‹ä¸€ä¸ªå…„å¼Ÿå…ƒç´ ï¼ˆ<code class=\"language-text\">sibling</code>ï¼‰ï¼Œå› è€Œä»ä»»æ„ä¸€ä¸ªä¸­é—´çš„ HTML å…ƒç´ å¼€å§‹ï¼Œéƒ½å¯ä»¥éå†æ•´ä¸ª React æ ‘ã€‚</p>\n<p>æ³¨ï¼šä»ä¸€ä¸ªå…ƒç´  A çš„ <code class=\"language-text\">sibling</code> æŠµè¾¾ä¸‹ä¸€ä¸ªå…ƒç´  B åï¼Œè¯¥å…ƒç´  B çš„ <code class=\"language-text\">return</code> æ˜¯ä»–çš„ä¸Šä¸€ä¸ªå…„å¼Ÿå…ƒç´ ï¼Œä¹Ÿå°±æ˜¯ Aï¼Œè€Œä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Š React / HTML æ ‘çš„çˆ¶å…ƒç´ ã€‚åªæœ‰å½“ B æ˜¯ A çš„ç¬¬ä¸€ä¸ªå­å…ƒç´ çš„æ—¶å€™ï¼ŒB çš„ <code class=\"language-text\">return</code> æ‰æ˜¯å®ƒåœ¨æ ‘ä¸Šçš„çˆ¶å…ƒç´ ã€‚</p>","frontmatter":{"date":"2019-07-11","title":"Inspect React Node without DevTool","category":"JavaScript"}}},{"node":{"id":"710a2f50-fe24-55cc-adc9-74201e495161","html":"<p>åœ¨ React 16 ä¸­ï¼ˆåŒ…æ‹¬ React 15.6 åŠä¹‹åçš„ç‰ˆæœ¬ï¼‰ï¼Œå¦‚æœæƒ³è¦ç”¨ JavaScript åœ¨å¤–éƒ¨è§¦å‘ä¸€ä¸ª <code class=\"language-text\">input</code> ç»„ä»¶çš„ <code class=\"language-text\">onChange</code> äº‹ä»¶ï¼Œéœ€è¦åšå¦‚ä¸‹çš„å‡ ä¸ªäº‹æƒ…ï¼š</p>\n<ol>\n<li>é¦–å…ˆï¼Œè®© React è®°å½•ä¸‹æ–°çš„ <code class=\"language-text\">value</code> å€¼ã€‚React é€šè¿‡ <code class=\"language-text\">defineProperty</code> å°è£…äº† <code class=\"language-text\">value</code> çš„ <code class=\"language-text\">set</code> æ–¹æ³•ï¼Œå› è€Œç›´æ¥è°ƒç”¨ <code class=\"language-text\">input.value = xxx</code> å¹¶ä¸èƒ½è¾¾åˆ°é¢„æœŸçš„æ•ˆæœï¼ˆå®é™…è§¦å‘çš„æ˜¯ React å°è£…çš„ setterï¼Œè€Œä¸æ˜¯å®é™… DOM çš„ setterï¼‰ã€‚ä¸ºæ­¤ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„æ–¹æ³•ç»•è¿‡å»ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> input <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.xxx'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> originalSetter <span class=\"token operator\">=</span>\n  Object<span class=\"token punctuation\">.</span><span class=\"token function\">getOwnPropertyDescriptor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HTMLInputElement</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">,</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set<span class=\"token punctuation\">;</span>\n<span class=\"token function\">originalSetter</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">,</span> <span class=\"token string\">'your value here'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<ol start=\"2\">\n<li>å…¶æ¬¡ï¼Œéœ€è¦è§¦å‘ä¸€æ¬¡ <code class=\"language-text\">onChange</code> çš„äº‹ä»¶ï¼Œå¥½è®© React çš„ç»„ä»¶å¯ä»¥åœ¨åŸæ¥æ—¢å®šçš„å›è°ƒå‡½æ•°ä¸­å¤„ç†æ–°çš„æ•°æ®ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> event <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Event</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> bubbles<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\ninput<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªå®Œæ•´å¯ç”¨çš„æ–¹æ³•ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">change</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">input<span class=\"token punctuation\">,</span> value</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> setter <span class=\"token operator\">=</span>\n    Object<span class=\"token punctuation\">.</span><span class=\"token function\">getOwnPropertyDescriptor</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">HTMLInputElement</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">,</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set<span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setter</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>input<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> event <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Event</span><span class=\"token punctuation\">(</span><span class=\"token string\">'input'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> bubbles<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  input<span class=\"token punctuation\">.</span><span class=\"token function\">dispatchEvent</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>","frontmatter":{"date":"2019-07-10","title":"Trigger onChange for React Input","category":"JavaScript"}}},{"node":{"id":"54c72338-b338-500b-97dd-37fe6ae8236a","html":"<p><a href=\"http://www.ecma-international.org/ecma-262/9.0/#sec-object-initializer\">ES2018</a> å¢åŠ äº† Object Spread æ“ä½œç¬¦çš„å®˜æ–¹æ”¯æŒã€‚Object Spread æ“ä½œç¬¦å’Œ <code class=\"language-text\">Object.assign</code> çš„ä¸€äº›åŒºåˆ«ï¼Œå¯ä»¥å‚è€ƒ<a href=\"https://2ality.com/2016/10/rest-spread-properties.html#spread-defines-properties-objectassign-sets-them\">è¿™ç¯‡æ–‡ç« </a>ã€‚</p>\n<p>åœ¨ JavaScript æ‰§è¡Œ Object Spread æ“ä½œç¬¦çš„æ—¶å€™ï¼Œéœ€è¦è¿›è¡Œå¦‚ä¸‹çš„å‡ æ­¥æ“ä½œï¼š</p>\n<ol>\n<li>ç¡®å®šå¯¹è±¡æœ‰å“ªäº›è‡ªå·±çš„å±æ€§ã€‚åŸå‹é“¾ä¸Šçš„éƒ¨åˆ†æ˜¯ä¸ä¼šè¢« Object Spread æ“ä½œç¬¦æ¥æ”¶çš„ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span> parent<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    current<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      enumerable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>obj <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output => { current: 2 }</span></code></pre></div>\n<ol start=\"2\">\n<li>ç¡®å®šç¬¬ä¸€æ­¥æ‹¿åˆ°çš„å±æ€§ä¸­ï¼Œæœ‰é‚£äº›æ˜¯å¯æšä¸¾çš„ï¼ˆenumerableï¼‰ã€‚ä¸å¯æšä¸¾çš„éƒ¨åˆ†ï¼Œä¸ä¼šè¢«æ¥æ”¶ï¼Œä¸¾ä¸ªä¾‹å­ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span>\n  <span class=\"token punctuation\">{</span> parent<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    current<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      enumerable<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      value<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>obj <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output => { }</span></code></pre></div>\n<ol start=\"3\">\n<li>åˆ†åˆ«è·å–åˆ°è¿™äº›å±æ€§çš„å€¼</li>\n</ol>\n<p>æ ¹æ®ä»¥ä¸Šçš„è§„åˆ™ï¼Œç°åœ¨å¯ä»¥è€ƒè™‘è¿™æ ·ä¸€ä¸ªåœºæ™¯ï¼šå‡è®¾éœ€è¦ä¸€ä¸ª Proxy æ¥ä¿®æ”¹è®¿é—®å¯¹è±¡å±æ€§çš„è¡Œä¸ºï¼Œæ¯”å¦‚å¯¹å¯¹è±¡ä»»æ„å±æ€§çš„å–å€¼ï¼Œéƒ½ä»å®ƒçš„æŸä¸€ä¸ªå­å±æ€§ä¸­å»æ‹¿ã€‚ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> <span class=\"token string\">'inner-value'</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> handler <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">/* todo */</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> proxy <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>proxy<span class=\"token punctuation\">.</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => output: inner-value</span></code></pre></div>\n<p>è¿™é‡Œçš„ handler å¹¶ä¸éš¾å†™ï¼Œåªéœ€è¦ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> handler <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> target<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// or:</span>\n    <span class=\"token comment\">// return Reflect.get(target.child, key);</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç°åœ¨ï¼Œå¦‚æœéœ€è¦ Proxy ä¹ŸåŒæ ·å¯ä»¥æ”¯æŒ Object Spread çš„åŠŸèƒ½ï¼Œé‚£ä¹ˆå°±éœ€è¦å¯¹ <code class=\"language-text\">handler</code> åšæ›´å¤šçš„å¤„ç†ã€‚ä»ä¸Šé¢çš„åˆ†ææ¥çœ‹ï¼Œç¬¬ä¸€æ­¥è·å–è‡ªæœ‰å±æ€§ï¼Œéœ€è¦ç”¨åˆ° <code class=\"language-text\">ownKeys</code>ï¼›ç¬¬äºŒæ­¥è·å–å¯æšä¸¾å±æ€§ï¼Œéœ€è¦ç”¨åˆ° <code class=\"language-text\">getOwnPropertyDescriptor</code>ï¼›æœ€åä¸€æ­¥è·å¾—å±æ€§å€¼ï¼Œä¾ç„¶éœ€è¦ <code class=\"language-text\">get</code>ã€‚</p>\n<p>ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span><span class=\"token punctuation\">,</span> child<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> key<span class=\"token punctuation\">:</span> <span class=\"token string\">'inner-value'</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> handler <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> Reflect<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">ownKeys</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">target</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> Reflect<span class=\"token punctuation\">.</span><span class=\"token function\">ownKeys</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">getOwnPropertyDescriptor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">target<span class=\"token punctuation\">,</span> key</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> Reflect<span class=\"token punctuation\">.</span><span class=\"token function\">getOwnPropertyDescriptor</span><span class=\"token punctuation\">(</span>target<span class=\"token punctuation\">.</span>child<span class=\"token punctuation\">,</span> key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> proxy <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Proxy</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">,</span> handler<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token operator\">...</span>proxy <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => output: { key: 'inner-value' }</span></code></pre></div>","frontmatter":{"date":"2019-07-09","title":"Object Spread and Proxy","category":"JavaScript"}}},{"node":{"id":"90b20290-7586-5b78-8fd4-bf9224aa51d0","html":"<p><code class=\"language-text\">Array.from</code> æ˜¯ JavaScript ä¸­ä¸€ä¸ªè¾ƒæ–°çš„ APIï¼Œå¯ä»¥å°†ä¸€ä¸ªç±»æ•°ç»„æˆ–å¯è¿­ä»£å¯¹è±¡è½¬åŒ–æˆä¸€ä¸ªçœŸæ­£çš„æ•°ç»„ã€‚</p>\n<p>ç±»æ•°ç»„ï¼ˆarray-likeï¼‰å¸¸è§äº DOM API ä¸­å–åˆ°çš„æ•°æ®ï¼Œæ¯”å¦‚ <code class=\"language-text\">.querySelectorAll</code>ã€‚å¾—åˆ°çš„ç»“æœæœ‰ <code class=\"language-text\">.length</code> å±æ€§ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡è·å–åˆ°æ•°æ®ï¼Œä½†æ˜¯æœ¬èº«å´ä¸æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ²¡æœ‰ <code class=\"language-text\">Array.prototype</code> ä¸Šçš„ API å¯ä»¥ç›´æ¥ç”¨ã€‚</p>\n<p>å¯è¿­ä»£å¯¹è±¡åˆ™æ˜¯æŒ‡é‚£äº›å®šä¹‰äº† <code class=\"language-text\">Symbol.iterator</code> å±æ€§çš„å¯¹è±¡ã€‚</p>\n<p><code class=\"language-text\">Array.from</code> å¯ä»¥å°†ä¸Šè¿°çš„ä¸¤ç§å¯¹è±¡ç›´æ¥è½¬åŒ–æˆä¸€ä¸ªæ ‡å‡†çš„æ•°ç»„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> iterable <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token operator\">*</span><span class=\"token punctuation\">[</span>Symbol<span class=\"token punctuation\">.</span>iterator<span class=\"token punctuation\">]</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">yield</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">yield</span> <span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>iterable<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => [1, 2];</span>\n\n<span class=\"token keyword\">const</span> arrayLike <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'span'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>arrayLike<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => [span, span, ...]</span></code></pre></div>\n<p>é™¤äº†ä¸Šè¿°å¸¸è§çš„åº”ç”¨ä¹‹å¤–ï¼Œ<code class=\"language-text\">Array.from</code> è¿˜æœ‰ä¸€äº›ç‰¹æ®Šçš„åº”ç”¨ã€‚</p>\n<p>é¦–å…ˆï¼Œåªè¦æŒ‡å®šäº† <code class=\"language-text\">length</code> å±æ€§ï¼Œ<code class=\"language-text\">Array.from</code> å°±å¯ä»¥åˆ›å»ºä¸€ä¸ªæ•°ç»„ã€‚è¿™ä¸€è¡Œä¸ºå¯ä»¥ç”¨æ¥åˆ›å»ºä¸€ä¸ªæŒ‡å®šé•¿åº¦çš„æ•°ç»„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> length<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// => [0, 1, 2, 3, 4]</span></code></pre></div>\n<p>å…¶æ¬¡ï¼Œ<code class=\"language-text\">Array.from</code> å‡½æ•°å…¶å®æ¥å—ä¸æ­¢ä¸€ä¸ªå‚æ•°ã€‚ç¬¬äºŒä¸ªå‚æ•°æ˜¯ä¸€ä¸ª map å‡½æ•°ï¼Œç¬¬ä¸‰ä¸ªå‚æ•°æ˜¯ <code class=\"language-text\">thisArg</code>ï¼Œç”¨äºæŒ‡å®š map å‡½æ•°çš„ <code class=\"language-text\">this</code> å¯¹è±¡ã€‚æœ‰äº†è¿™ä¸ª map å‡½æ•°çš„æ”¯æŒï¼Œä¸Šé¢è¿™ä¸ªä¾‹å­å°±å¯ä»¥è¿›ä¸€æ­¥æ”¹å†™æˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> length<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> i<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åœ¨è½¬åŒ– DOM ç±»æ•°ç»„çš„æ—¶å€™ï¼Œç›´æ¥é€šè¿‡æŒ‡å®š map å‡½æ•°è¿›è¡Œè¿›ä¸€æ­¥çš„è½¬åŒ–ï¼Œæ˜¯æ¯”è¾ƒæ–¹ä¾¿çš„ã€‚å¯ä»¥çœç•¥ä¸€ä¸ª <code class=\"language-text\">.map</code> å‡½æ•°çš„åµŒå¥—ï¼Œä¹ŸèŠ‚çœä¸€ä¸ªä¸­é—´æ•°ç»„å¯¹è±¡çš„åˆ›å»ºã€‚</p>\n<p><code class=\"language-text\">Array.prototype.map</code> å‡½æ•°å¯ä»¥æŒ‡å®š <code class=\"language-text\">thisArg</code>ï¼Œåœ¨ <code class=\"language-text\">Array.from</code> ä¸­ä¹Ÿå¯ä»¥é€šè¿‡ç¬¬ä¸‰ä¸ªå‚æ•°æŒ‡å®š <code class=\"language-text\">thisArg</code>ã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> mapper <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  shift<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token function\">run</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">_<span class=\"token punctuation\">,</span> i</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>shift <span class=\"token operator\">+</span> i<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nArray<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> length<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> mapper<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">,</span> mapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// => [1, 2, 3, 4, 5];</span></code></pre></div>\n<p>ä¸Šè¿°å†™æ³•ç­‰ä»·äºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> length<span class=\"token punctuation\">:</span> <span class=\"token number\">5</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>mapper<span class=\"token punctuation\">.</span>run<span class=\"token punctuation\">,</span> mapper<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"date":"2019-07-02","title":"Array.from","category":"JavaScript"}}},{"node":{"id":"61e28cdf-6987-5e08-8122-603691c0fdae","html":"<p>å‰ç«¯çš„å¼€å‘å·¥ç¨‹ï¼Œç»å¸¸éœ€è¦å¼€å¯ä¸€äº›è°ƒè¯•ç”¨çš„æœåŠ¡å™¨ï¼Œä¸€æ—¦è°ƒè¯•çš„æœåŠ¡å™¨å¤šäº†ï¼Œéš¾å…ä¼šå‡ºç°ç½‘ç»œç«¯å£å·çš„å†²çªï¼›ç±»ä¼¼çš„ï¼Œå¦‚æœåœ¨ä¸€å°å¼€å‘æœºä¸Šæœ‰å¤šä¸ªäººåŒæ—¶å¼€å‘ï¼Œå¼€å‘è„šæœ¬ä¹Ÿå°±ä¸èƒ½å†™æ­»ä¸€ä¸ªå›ºå®šçš„ç«¯å£å·äº†ã€‚åœ¨è¿™ç±»æƒ…å†µä¸‹ï¼Œå¦‚æœè¦æ‰‹åŠ¨è§£å†³è¿™äº›å†²çªï¼ˆä¿®æ”¹ç«¯å£å·æˆ–è€…æ‰‹å†™ç«¯å£å·çš„åˆ†é…è§„åˆ™ï¼‰ï¼Œä¸å…æœ‰äº›éº»çƒ¦ã€‚</p>\n<p>äº‹å®ä¸Šï¼Œåˆ›å»ºæœåŠ¡çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½® <code class=\"language-text\">0</code> ä½œä¸ºç«¯å£å·ã€‚è¿™æ ·çš„è¯ï¼Œç³»ç»Ÿå°±ä¼šæŒ‡å®šä¸€ä¸ªå½“å‰ç©ºé—²å¯ç”¨çš„ç«¯å£å·ï¼Œä»¥ä¿è¯ä¸å‘ç”Ÿç«¯å£å·å†²çªçš„æƒ…å†µã€‚</p>\n<p>ä¸‹é¢æ˜¯ä¸€æ®µ Node.js çš„ç¤ºæ„ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> http <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> server  <span class=\"token operator\">=</span> http<span class=\"token punctuation\">.</span><span class=\"token function\">createServer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request<span class=\"token punctuation\">,</span> response</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  response<span class=\"token punctuation\">.</span><span class=\"token function\">writeHead</span><span class=\"token punctuation\">(</span><span class=\"token number\">200</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token string\">'Content-Type'</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'text/html'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  response<span class=\"token punctuation\">.</span><span class=\"token function\">write</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'&lt;html>'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'&lt;head>&lt;title>Node.js Server&lt;/title>&lt;/head>'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'&lt;body>&lt;h1>Hello World&lt;/h1>&lt;/body>'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'&lt;/html>'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">''</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  response<span class=\"token punctuation\">.</span><span class=\"token function\">end</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ask for an available port</span>\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nserver<span class=\"token punctuation\">.</span><span class=\"token function\">on</span><span class=\"token punctuation\">(</span><span class=\"token string\">'listening'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ask for actually used port</span>\n  <span class=\"token keyword\">var</span> port <span class=\"token operator\">=</span> server<span class=\"token punctuation\">.</span><span class=\"token function\">address</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>port<span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">server is listening: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>port<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">server.address().port</code> å¯ä»¥æ‹¿åˆ°å½“å‰ç³»ç»Ÿå…·ä½“åˆ†é…çš„ç«¯å£å·ã€‚æœ‰äº†è¿™ä¸ªç«¯å£å·ï¼Œå°±å¯ä»¥è‡ªåŠ¨/æ‰‹åŠ¨çš„æ‰“å¼€å¯¹åº”çš„ URL åœ°å€ä»¥è®¿é—®æ–°ç”Ÿæˆçš„æœåŠ¡äº†ã€‚</p>","frontmatter":{"date":"2019-06-24","title":"Get Available Port Number","category":"JavaScript"}}},{"node":{"id":"d3d9b9ee-bfd5-59a0-8ae2-2338b51424cc","html":"<p>ä¸‹é¢å±•ç¤ºçš„è¿™æ®µ CSS è®¾ç½®éå¸¸å¸¸è§ï¼Œå¯ä»¥è®©æ–‡å­—è¶…è¿‡å®½åº¦çš„æ—¶å€™ï¼Œæ˜¾ç¤º <code class=\"language-text\">...</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">.ellipsis</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">white-space</span><span class=\"token punctuation\">:</span> nowrap<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">overflow</span><span class=\"token punctuation\">:</span> hidden<span class=\"token punctuation\">;</span>\n  <span class=\"token property\">text-overflow</span><span class=\"token punctuation\">:</span> ellipsis<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>åœ¨å®é™…ä¸šåŠ¡ä¸­ï¼Œç»å¸¸ä¼šç¢°åˆ°è¿™æ ·çš„éœ€æ±‚ï¼šåªæœ‰å½“æ˜¾ç¤ºå‡º <code class=\"language-text\">...</code> çš„æ—¶å€™ï¼Œæ‰åšæŸäº›äº‹æƒ…ï¼ˆæ¯”å¦‚ï¼Œæ‰åœ¨é¼ æ ‡æ‚¬åœçš„æ—¶å€™å±•ç¤º Tooltipï¼Œç”¨ä»¥æ˜¾ç¤ºå®Œæ•´çš„æ–‡å­—å†…å®¹ï¼‰ã€‚CSS æœ¬èº«å¹¶æ²¡æœ‰æä¾›è¶³å¤Ÿçš„æ¥å£ï¼Œè®©å¼€å‘è€…å¯ä»¥ç›´è§‚çš„äº†è§£åˆ°å½“å‰çš„æ–‡å­—å†…å®¹æ˜¯å¦å·²ç»è¶…å‡ºäº†å¯ä»¥æ˜¾ç¤ºçš„èŒƒå›´ã€‚å¦‚æœéœ€è¦åˆ¤æ–­å½“å‰å†…å®¹æ˜¯å¦è¶…å‡ºäº†å…ƒç´ çš„å®½åº¦ï¼ˆå› è€Œè®© CSS æ¸²æŸ“å‡º <code class=\"language-text\">...</code>ï¼‰ï¼Œå¯ä»¥ç”¨ä¸‹é¢çš„ JavaScript ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">isOverflow</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">element</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> element<span class=\"token punctuation\">.</span>scrollWidth <span class=\"token operator\">!==</span> element<span class=\"token punctuation\">.</span>clientWidth<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ ¹æ® <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollWidth\">MDN</a> çš„ä»‹ç»ï¼Œ<code class=\"language-text\">scrollWidth</code> æ˜¯ä¸€ä¸ªåˆ¶åº¦å…ƒç´ ï¼Œå…¶å€¼ç­‰äºè¯¥å…ƒç´ å®é™…çš„å®½åº¦ï¼ˆåŒ…å«äº†å…ƒç´ å› ä¸º <code class=\"language-text\">overflow</code> æ²¡æœ‰å±•ç¤ºå‡ºæ¥çš„éƒ¨åˆ†ï¼‰ï¼›è€Œäºæ­¤ç›¸å¯¹çš„ï¼Œ<code class=\"language-text\">clientWidth</code> æ˜¯å…ƒç´ å®é™…å±•ç¤ºçš„å®½åº¦ã€‚æ³¨ï¼Œå¯¹è¡Œå†…å…ƒç´ å’Œæ²¡æœ‰ CSS çš„å…ƒç´ æ¥è¯´ï¼Œ<code class=\"language-text\">clientWidth</code> æ˜¯ 0ï¼Œå…·ä½“è§ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Element/clientWidth\">MDN</a>ã€‚é’ˆå¯¹åˆ¤æ–­æ˜¯å¦å‡º <code class=\"language-text\">...</code> çš„æƒ…å†µï¼Œè¿™é‡Œä¸éœ€è¦è€ƒè™‘ <code class=\"language-text\">clientWidth</code> çš„ç‰¹æ®Šæƒ…å†µã€‚å› ä¸º <code class=\"language-text\">scrollWidth</code> å®é™…ç»™å‡ºçš„å€¼åŒ…å«äº†è¢«éšå»çš„éƒ¨åˆ†ï¼Œå› è€Œå½“ <code class=\"language-text\">scrollWidth</code> å’Œ <code class=\"language-text\">clientWidth</code> ä¸æƒ³ç­‰çš„æ—¶å€™ï¼Œå°±å¯ä»¥è®¤å®šå½“å‰æœ‰éƒ¨åˆ†å†…å®¹è¢«éšå»äº†ï¼Œå› è€Œ <code class=\"language-text\">...</code> ä¹Ÿå‡ºç°äº†ã€‚</p>","frontmatter":{"date":"2019-06-21","title":"Detect Overflow","category":"JavaScript"}}},{"node":{"id":"b52b4bc6-f364-5715-a454-319cdd7e61b0","html":"<p>ä½¿ç”¨ JavaScript åº“ <a href=\"https://www.npmjs.com/package/jszip\">jszip</a> å¯ä»¥å¯¹ä¼ å…¥çš„æœ¬åœ° zip åŒ…è¿›è¡Œè§£å‹ç¼©å¹¶è¯»å–å…¶ä¸­çš„æ–‡ä»¶ã€‚</p>\n<p>ä¸€æ®µå‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> filename <span class=\"token operator\">=</span> <span class=\"token string\">'example.txt'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">onDrop</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event<span class=\"token punctuation\">:</span> DragEvent<span class=\"token operator\">&lt;</span>HTMLDivElement<span class=\"token operator\">></span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> file<span class=\"token punctuation\">:</span> File <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>dataTransfer<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> zip <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> jszip<span class=\"token punctuation\">.</span><span class=\"token function\">loadAsync</span><span class=\"token punctuation\">(</span>file<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> zip<span class=\"token punctuation\">.</span>files<span class=\"token punctuation\">[</span>filename<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token keyword\">async</span><span class=\"token punctuation\">(</span><span class=\"token string\">'text'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token builtin\">console</span><span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'content of example.txt: '</span><span class=\"token punctuation\">,</span> content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™é‡Œï¼Œ<code class=\"language-text\">loadAsync</code> å‡½æ•°æ¥å—çš„å‚æ•°æ˜¯ä¸€ä¸ª <code class=\"language-text\">Blob</code>ï¼Œè€Œæ— è®ºæ˜¯ <code class=\"language-text\">input[type=file]</code> è¿˜æ˜¯é€šè¿‡ drag-n-drop å¾—åˆ°çš„æ–‡ä»¶ï¼ˆ<code class=\"language-text\">File</code>ï¼‰ï¼Œéƒ½æ˜¯ä¸€ç§ç‰¹æ®Šçš„ <code class=\"language-text\">Blob</code>ï¼Œå› è€Œå¯ä»¥ç›´æ¥ä¼ é€’ç»™ <code class=\"language-text\">loadAsync</code> ä½¿ç”¨ã€‚</p>\n<p><code class=\"language-text\">.async(&#39;text&#39;)</code> å¯ä»¥å°†ç»“æœå¼‚æ­¥è½¬åŒ–æˆå­—ç¬¦ä¸²ã€‚API ä¹Ÿæ”¯æŒå…¶ä»–çš„æ ¼å¼ç±»å‹ï¼Œæ¯”å¦‚ ArrayBuffer ç­‰ã€‚ï¼ˆ<a href=\"https://stuk.github.io/jszip/documentation/api_zipobject/async.html\">æ–‡æ¡£</a>ï¼‰</p>\n<p>é™¤äº†è¯»å–å†…å®¹ä¹‹å¤–ï¼Œjszip ä¹Ÿæ”¯æŒåˆ›å»ºä¿®æ”¹ zip åŒ…çš„å†…å®¹ã€‚å®Œæ•´çš„ API æ–‡æ¡£å¯ä»¥å‚è€ƒ<a href=\"https://stuk.github.io/jszip/documentation/api_jszip.html\">è¿™é‡Œ</a>ã€‚</p>","frontmatter":{"date":"2019-06-17","title":"Unzip using JavaScript","category":"JavaScript"}}},{"node":{"id":"79bee574-d4b0-57b1-b531-1ef59addb95d","html":"<p>react-router åº•å±‚ä½¿ç”¨äº† history åº“æ¥å¤„ç†è·¯ç”±ã€‚ä¸€èˆ¬æœ‰ä¸¤ç§é€‰æ‹©ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ <code class=\"language-text\">BrowserHistory</code>ï¼ˆèƒŒåçš„å®ç°ä¾èµ–äº† History APIï¼‰ï¼Œä¸€ç§æ˜¯ä½¿ç”¨ <code class=\"language-text\">HashHistory</code>ï¼ˆèƒŒåçš„å®ç°ä¸»è¦ä¾èµ– <code class=\"language-text\">window.location.hash</code>ï¼‰ã€‚</p>\n<p>å¦‚æœå°è¯•åœ¨ HashHistory ä¸Šè°ƒç”¨ <code class=\"language-text\">push</code> API å¹¶ä¼ é€’ state å‚æ•°ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> history <span class=\"token operator\">=</span> <span class=\"token function\">HashHistory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nhistory<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¼šåœ¨ console çœ‹åˆ°å¦‚ä¸‹çš„æŠ¥é”™ï¼Œå¹¶ä¸” state å¹¶æ²¡æœ‰ä¼ é€’æˆåŠŸï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">Hash history cannot push state; it is ignored</code></pre></div>\n<p>è¿™ä¸ªæ˜¯ history åº“çš„é»˜è®¤è¡Œä¸ºï¼Œå…·ä½“çš„ä»£ç å¯ä»¥å‚è€ƒ <code class=\"language-text\">modules/createHashHistory.js</code> ä¸­ <code class=\"language-text\">push</code> çš„ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">path<span class=\"token punctuation\">,</span> state</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">warning</span><span class=\"token punctuation\">(</span>\n    state <span class=\"token operator\">===</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Hash history cannot push state; it is ignored'</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">const</span> action <span class=\"token operator\">=</span> <span class=\"token string\">'PUSH'</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> location <span class=\"token operator\">=</span> <span class=\"token function\">createLocation</span><span class=\"token punctuation\">(</span>\n    path<span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span>\n    <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">,</span>\n    history<span class=\"token punctuation\">.</span>location\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span></code></pre></div>\n<p>ä¸Šé¢çš„ä»£ç å¯ä»¥çœ‹åˆ°ï¼Œå¦‚æœä¼ é€’äº†ç¬¬äºŒä¸ªå‚æ•° stateï¼Œé‚£ä¹ˆå°±ä¼šè¾“å‡ºæŠ¥é”™ã€‚åŒæ—¶ï¼Œåœ¨ createLocation å‡½æ•°è°ƒç”¨çš„æ—¶å€™ï¼Œç¬¬äºŒä¸ªå‚æ•°æœ¬æ¥åº”è¯¥æ˜¯ stateï¼Œè¿™é‡Œæ˜¾å¼åœ°å†™æˆäº† <code class=\"language-text\">undefined</code>ï¼Œæ˜ç¡®æ‹’ç»äº†ä¼ é€’ state çš„åšæ³•ã€‚</p>\n<p>ç„¶è€Œï¼Œè¿™å¹¶ä¸æ„å‘³ç€å°±å®Œå…¨ä¸èƒ½ä¼ é€’ <code class=\"language-text\">state</code> äº†ã€‚</p>\n<p>äº‹å®ä¸Šï¼Œ<code class=\"language-text\">push</code> å‡½æ•°æœ‰ä¸¤ç§ API å¯ä¾›é€‰æ‹©ï¼Œä¸€ç§æ˜¯ path æ˜¯å­—ç¬¦ä¸²ï¼Œç„¶å state ä½œä¸ºç¬¬äºŒä¸ªå‚æ•°ä¼ é€’ï¼›å¦ä¸€ç§åˆ™ç¬¬ä¸€ä¸ªå‚æ•°å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå…¶ä¸­ä¸€ä¸ªå±æ€§å°±æ˜¯ stateã€‚</p>\n<p>å¦‚æœä½¿ç”¨ä¸‹é¢çš„æ–¹æ³•è°ƒç”¨ï¼Œstate å°±å¯ä»¥åœ¨ react-router ä¸­è¢«ä¼ é€’äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">hashHistory<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> path<span class=\"token punctuation\">:</span> <span class=\"token string\">'path'</span><span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> state<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span> <span class=\"token punctuation\">}</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä½†æ˜¯ï¼Œéœ€è¦æŒ‡å‡ºçš„æ˜¯ã€‚è¿™ä¸ªåªæ˜¯ <code class=\"language-text\">state</code> è¢«<strong>ä¼ é€’</strong>äº†ï¼Œå¹¶ä¸ä»£è¡¨ <code class=\"language-text\">state</code> çœŸçš„è¢«å­˜å‚¨äº†ä¸‹æ¥ã€‚äº‹å®ä¸Šï¼ŒHashHistory å¹¶æ²¡æœ‰ä¾èµ–æµè§ˆå™¨çš„ History API åŠŸèƒ½ã€‚å› æ­¤ï¼Œè¿™é‡Œçš„ <code class=\"language-text\">state</code> ä¼ é€’ä¹‹åï¼Œä¼šå‡ºç°åœ¨ <code class=\"language-text\">history.location.state</code> ä¸­ï¼Œä½†æ˜¯åœ¨æµè§ˆå™¨å‰è¿›/åé€€çš„æ“ä½œä¸­ï¼Œæ•°æ®ä¼šè¢«ä¸¢å¼ƒï¼Œæ— æ³•æ‰¾åˆ°ã€‚</p>\n<p>ä¸€ä¸ªç®€å•çš„ä¾‹å­æ˜¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> h <span class=\"token operator\">=</span> <span class=\"token function\">createHashHistory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">location</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pathname<span class=\"token punctuation\">:</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: 1</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pathname<span class=\"token punctuation\">:</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: 2</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">goBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: undefined</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">goForward</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: undefined</span></code></pre></div>\n<p>å¦‚æœå°† HashHistory æ”¹æˆ BrowserHistoryï¼Œåˆ™å¯ä»¥æ­£ç¡®è¾“å‡ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> h <span class=\"token operator\">=</span> <span class=\"token function\">createBrowserHistory</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">listen</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">location</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pathname<span class=\"token punctuation\">:</span> <span class=\"token string\">'a'</span><span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: 1</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> pathname<span class=\"token punctuation\">:</span> <span class=\"token string\">'b'</span><span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: 2</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">goBack</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: 1</span>\nh<span class=\"token punctuation\">.</span><span class=\"token function\">goForward</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: 2</span></code></pre></div>","frontmatter":{"date":"2019-06-16","title":"HashHistory & State","category":"JavaScript"}}},{"node":{"id":"e68527aa-5b12-5908-891e-1136dfbb4f27","html":"<p><a href=\"https://gist.github.com/jed/982883\">è¿™é‡Œ</a>æœ‰ä¸€æ®µç”Ÿæˆ UUID v4 éå¸¸çŸ­å°çš„ JavaScript ä»£ç ã€‚è™½ç„¶æœ‰ä¸€äº›æ³¨é‡Šï¼Œä½†æ€»ä½“ä¸Šå¹¶ä¸æ˜¯éå¸¸çš„å¥½ç†è§£ã€‚</p>\n<p>é¦–å…ˆï¼Œç”¨ TypeScript ç¿»è¯‘ä¸€éåŸå§‹çš„ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">const</span> slot <span class=\"token operator\">=</span> <span class=\"token string\">'10000000-1000-4000-8000-100000000000'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token keyword\">from</span><span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span><span class=\"token punctuation\">,</span> to<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">floor</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>to <span class=\"token operator\">-</span> <span class=\"token keyword\">from</span> <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token keyword\">from</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getRandomChar</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">input<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> seed <span class=\"token operator\">=</span> input <span class=\"token operator\">===</span> <span class=\"token number\">8</span> <span class=\"token operator\">?</span> <span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">8</span><span class=\"token punctuation\">,</span> <span class=\"token number\">11</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token function\">rand</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token number\">15</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> seed<span class=\"token punctuation\">.</span><span class=\"token function\">toString</span><span class=\"token punctuation\">(</span><span class=\"token number\">16</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">uuidReplacer</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">char<span class=\"token punctuation\">:</span> <span class=\"token builtin\">string</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">getRandomChar</span><span class=\"token punctuation\">(</span><span class=\"token operator\">+</span>char<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">uuid</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> slot<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token regex\">/[018]/g</span><span class=\"token punctuation\">,</span> uuidReplacer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>æ¥ä¸‹æ¥å¯¹åŸå§‹çš„ä»£ç ä¸­çš„éƒ¨åˆ†åšä¸€äº›è§£é‡Šï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">a <span class=\"token operator\">^</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">16</span> <span class=\"token operator\">>></span> a<span class=\"token operator\">/</span><span class=\"token number\">4</span></code></pre></div>\n<p>è¿™ä¸ªéƒ¨åˆ†çš„ä»£ç ä¸å¤ªå¥½ç†è§£ã€‚é¦–å…ˆï¼Œå…ˆæ ¹æ®è¿ç®—ç¬¦çš„<a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Operator_Precedence\">ä¼˜å…ˆçº§</a>ï¼Œç»™ä¸Šé¢è¿™ä¸ªç®—å¼åŠ ä¸Šå¸®åŠ©ç†è§£çš„æ‹¬å·ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">a <span class=\"token operator\">^</span> <span class=\"token punctuation\">(</span> <span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">16</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">>></span> <span class=\"token punctuation\">(</span>a <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">)</span></code></pre></div>\n<p>æ¥ä¸‹æ¥ï¼Œå†æ¥çœ‹æ¯ä¸ªéƒ¨åˆ†éƒ½æ˜¯ä»€ä¹ˆæ„æ€ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">16</span></code></pre></div>\n<p>åˆ›å»ºäº†ä¸€ä¸ª <code class=\"language-text\">0~16</code> èŒƒå›´å†…çš„éšæœºæ•°ï¼Œ<code class=\"language-text\">&gt;&gt; (a / 4)</code> è¿™ä¸ªè¿ç®—ä¹‹åï¼Œä¼šå¾—åˆ°å‡ ç§ä¸åŒçš„ç»“æœï¼ˆæ³¨æ„ï¼Œè¿™é‡Œ <code class=\"language-text\">a</code> åªå¯èƒ½æ˜¯ <code class=\"language-text\">&#39;0&#39;</code>ï¼Œ<code class=\"language-text\">&#39;1&#39;</code>ï¼Œ<code class=\"language-text\">&#39;8&#39;</code> ä¸‰ç§æƒ…å†µï¼‰ï¼š</p>\n<ul>\n<li><code class=\"language-text\">&#39;0&#39;</code> æˆ– <code class=\"language-text\">&#39;1&#39;</code> çš„æ—¶å€™ï¼Œç»“æœæ˜¯ <code class=\"language-text\">0~15</code> çš„éšæœºæ•°ï¼ˆæ•´æ•°ï¼‰</li>\n<li><code class=\"language-text\">&#39;8&#39;</code> çš„æ—¶å€™ï¼Œç­‰ä»·äº <code class=\"language-text\">&gt;&gt; 2</code>ï¼Œæ‰€ä»¥ç»“æœæ˜¯ä¸€ä¸ª <code class=\"language-text\">0~3</code> çš„éšæœºæ•°ï¼ˆæ•´æ•°ï¼‰</li>\n</ul>\n<p>æœ€åä¸€æ­¥å¼‚æˆ–è¿ç®— <code class=\"language-text\">^</code>ï¼Œå¾—åˆ°çš„å¯èƒ½ç»“æœåˆ†åˆ«æ˜¯ï¼š</p>\n<ul>\n<li><code class=\"language-text\">&#39;0&#39;</code> çš„æ—¶å€™ï¼Œå¼‚æˆ–ç»“æœä¸å˜ï¼Œæ˜¯ <code class=\"language-text\">0~15</code> çš„éšæœºæ•°ï¼ˆæ•´æ•°ï¼‰</li>\n<li><code class=\"language-text\">&#39;1&#39;</code> çš„æ—¶å€™ï¼Œå¼‚æˆ–ç»“æœæœ€åä¸€ä¸ªæ¯”ç‰¹ä½çš„å€¼æ­£å¥½ç›¸åï¼Œæœ€ç»ˆçš„ç»“æœä»ç„¶æ˜¯ <code class=\"language-text\">0~15</code> çš„éšæœºæ•°ï¼ˆæ•´æ•°ï¼‰</li>\n<li><code class=\"language-text\">&#39;8&#39;</code> çš„æ—¶å€™ï¼Œæœ€ç»ˆç»“æœæ˜¯ <code class=\"language-text\">8~11</code> çš„éšæœºæ•°ï¼ˆæ•´æ•°ï¼‰ã€‚å› ä¸º <code class=\"language-text\">8</code> çš„ç¬¬å››ä½äºŒè¿›åˆ¶æ˜¯ <code class=\"language-text\">1</code> å…¶ä»–éƒ½æ˜¯ <code class=\"language-text\">0</code>ï¼Œè€Œ <code class=\"language-text\">0~3</code> è¿™å‡ ä¸ªæ•°çš„äºŒè¿›åˆ¶ä½æ•°ä¸è¶…è¿‡ä¸¤ä½ï¼Œæ‰€ä»¥ä½æ•°ä¹‹é—´ä¸å­˜åœ¨äº¤é›†ï¼Œå¼‚æˆ–è¿ç®—ç›¸å½“äºæ˜¯ <code class=\"language-text\">8 + n</code>ï¼Œ<code class=\"language-text\">n</code> æ˜¯ <code class=\"language-text\">0~3</code> ä¸­çš„æŸä¸€ä¸ªæ•°ã€‚æœ€ç»ˆå¾—åˆ°çš„å°±æ˜¯ <code class=\"language-text\">8~11</code> çš„éšæœºæ•°ï¼ˆæ•´æ•°ï¼‰ã€‚</li>\n</ul>\n<p>æœ€ç»ˆï¼Œå°†ç”Ÿæˆçš„ä¸è¶…è¿‡ 16 çš„æ•´æ•°è½¬åŒ–æˆåå…­è¿›åˆ¶çš„å¯¹åº”å­—ç¬¦ã€‚</p>\n<p>ç¬¬äºŒéƒ¨åˆ†çš„ä»£ç ç”¨åˆ°äº†æ­£åˆ™åŒ¹é…å’Œæ›¿æ¢ï¼ˆæ³¨æ„ï¼Œè¿™é‡Œ <code class=\"language-text\">&#39;4&#39;</code> æ²¡æœ‰è¢«æ›¿æ¢ï¼Œä¾ç„¶ä¿ç•™ï¼‰ï¼Œä¸»è¦ä¸å®¹æ˜“ç†è§£çš„æ˜¯ä¸‹é¢è¿™ä¸ªéƒ¨åˆ†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span><span class=\"token number\">1e7</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">1e3</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">4e3</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">8e3</span> <span class=\"token operator\">+</span> <span class=\"token operator\">-</span><span class=\"token number\">1e11</span>    </code></pre></div>\n<p>è¿™é‡Œç”¨åˆ°äº† JavaScript æ¯”è¾ƒå¥‡æ€ªçš„ç±»å‹è½¬åŒ–åŠŸèƒ½ã€‚å› ä¸ºæœ€å¼€å§‹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œæ‰€ä»¥è¿™é‡Œçš„ç›¸åŠ å®é™…ä¸Šæ˜¯å­—ç¬¦ä¸²çš„æ‹¼æ¥ã€‚ç­‰ä»·äº <code class=\"language-text\">&#39;10000000-1000-4000-8000-100000000000&#39;</code> è¿™ä¸ªå­—ç¬¦ä¸²ã€‚ä¸Šé¢è¿™æ ·å†™ä¸»è¦æ˜¯å­—ç¬¦æ•°ä¸Šæ¯”è¾ƒå°‘ã€‚</p>","frontmatter":{"date":"2019-06-12","title":"Generate v4 UUID","category":"JavaScript"}}},{"node":{"id":"a1465a17-f50e-5c80-877c-62f1b261e758","html":"<p>åœ¨ JavaScript ä¸­ï¼Œå¦‚æœå¾—åˆ°äº†ä¸€ä¸²å­—èŠ‚ï¼ˆæ¯”å¦‚ <code class=\"language-text\">Uint8Array</code>ï¼‰ï¼Œè¦è½¬åŒ–æˆå¯¹åº”çš„å­—ç¬¦ä¸²ï¼Œå°±å¯ä»¥ç”¨åˆ° <code class=\"language-text\">TextDecoder</code>ã€‚ç®€å•çš„ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> decoder <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">TextDecoder</span><span class=\"token punctuation\">(</span><span class=\"token string\">'utf-8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> bytes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">119</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> decoder<span class=\"token punctuation\">.</span><span class=\"token function\">decode</span><span class=\"token punctuation\">(</span>bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => \"hello world\"</span></code></pre></div>\n<p>å½“ç„¶ï¼Œä¸Šé¢çš„è¿™ä¸ªä¾‹å­æ˜¯æ¯”è¾ƒç®€å•çš„ã€‚ä¸ä½¿ç”¨ <code class=\"language-text\">TextDecoder</code> ä¹Ÿå¯ä»¥ç›´æ¥è½¬åŒ–æˆå­—ç¬¦ä¸²ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> bytes <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Uint8Array</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n  <span class=\"token number\">104</span><span class=\"token punctuation\">,</span> <span class=\"token number\">101</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">32</span><span class=\"token punctuation\">,</span> <span class=\"token number\">119</span><span class=\"token punctuation\">,</span> <span class=\"token number\">111</span><span class=\"token punctuation\">,</span> <span class=\"token number\">114</span><span class=\"token punctuation\">,</span> <span class=\"token number\">108</span><span class=\"token punctuation\">,</span> <span class=\"token number\">100</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> result <span class=\"token operator\">=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>bytes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => \"hello world\"</span></code></pre></div>\n<p><code class=\"language-text\">TextDecoder</code> çš„ä¸»è¦ä¼˜åŠ¿ï¼Œéœ€è¦åœ¨é ASCII ç èŒƒå›´å†…æ‰ä½“ç°å‡ºæ¥ã€‚ç‰¹åˆ«æ˜¯ utf-8 è¿™ç±»å˜é•¿å­—ç¬¦ä¸²ç¼–ç ï¼Œç›´æ¥å¤„ç†æ¯”è¾ƒå›°éš¾ã€‚äº¤ç»™ç°æˆçš„ API æ¥å¤„ç†ï¼Œç®€å•æ–¹ä¾¿ã€‚</p>\n<p>å‚è€ƒæ–‡æ¡£ï¼š<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/TextDecoder\">MDN</a></p>","frontmatter":{"date":"2019-06-04","title":"TextDecoder","category":"JavaScript"}}},{"node":{"id":"53185fcd-7279-570b-8a64-384a2f60382e","html":"<p>ä¸€ä¸ªé¡¹ç›®å·¥ç¨‹é‡Œçš„ç»„ä»¶ï¼Œå¾ˆå¯èƒ½éœ€è¦ä¾èµ–äºæŸäº›é¡¹ç›®é¡¶å±‚å®šä¹‰çš„ <code class=\"language-text\">Provider</code> æ‰èƒ½æ­£ç¡®ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œmobx çš„é¡¹ç›®å¯èƒ½ä¼šåœ¨é¡¶å±‚é€šè¿‡ <code class=\"language-text\">mobx-react</code> ä¸­çš„ <code class=\"language-text\">Provider</code> æä¾› <code class=\"language-text\">store</code> å‚æ•°ã€‚</p>\n<p>å¦‚æœéœ€è¦åœ¨æ¯ä¸€ä¸ª story ä¸­éƒ½å†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Provider</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">info</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n  </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">ComponentForThisStory</span></span> <span class=\"token punctuation\">/></span></span><span class=\"token plain-text\">\n</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Provider</span></span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>æ˜¾ç„¶å¤ªå•°å—¦äº†ã€‚</p>\n<p>storybook æä¾›äº†å…¨å±€å®šä¹‰ decorator çš„æ–¹æ³•ï¼Œå¯ä»¥ä»¥æ­¤æ¥æ³¨å†Œä¸€äº›å…¨å±€éƒ½ç”¨å¾—åˆ°çš„æ”¹åŠ¨ã€‚ä¸¾ä¾‹å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> configure<span class=\"token punctuation\">,</span> addDecorator <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'@storybook/react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Provider <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'mobx-react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">withProvider</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">story</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span><span class=\"token class-name\">Provider</span></span> <span class=\"token spread\"><span class=\"token punctuation\">{</span><span class=\"token punctuation\">...</span><span class=\"token attr-value\">info</span><span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span><span class=\"token function\">story</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span><span class=\"token class-name\">Provider</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">loadStories</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token function\">addDecorator</span><span class=\"token punctuation\">(</span>withProvider<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">configure</span><span class=\"token punctuation\">(</span>loadStories<span class=\"token punctuation\">,</span> module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™æ ·ï¼Œåœ¨ story ä¸­ï¼Œåªéœ€è¦ç®€å•çš„æä¾›ç»„ä»¶å°±å¯ä»¥äº†ï¼Œ<code class=\"language-text\">decorator</code> ä¼šè‡ªåŠ¨ä¸ºç»„ä»¶åŠ ä¸Šåˆé€‚çš„å¤–å±‚ <code class=\"language-text\">Provider</code>ã€‚</p>\n<p><a href=\"https://alligator.io/react/storybook-with-redux/\">å‚è€ƒæ–‡æ¡£</a></p>","frontmatter":{"date":"2019-06-03","title":"global Provider for storybook","category":"JavaScript"}}},{"node":{"id":"222c8e73-0ed7-5131-a264-185f704ea6de","html":"<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒJest é…ç½®æ–‡ä»¶ä¸­çš„ <code class=\"language-text\">transform</code> å±æ€§ï¼Œæ˜¯ä¸ä¼šè¢«åº”ç”¨åˆ° node_modules ç›®å½•ä¸‹çš„ã€‚å¦‚æœå¼•ç”¨çš„åº“æœ¬èº«ä½¿ç”¨äº†é JavaScript æ–‡ä»¶ï¼ˆæ¯”å¦‚ CSS æ–‡ä»¶ï¼‰ï¼Œä¼šé€ æˆ Jest æ— æ³•æ­£ç¡®å¤„ç†ã€‚</p>\n<p>ä¸€ä¸ªå¯è¡Œçš„æ›¿ä»£æ–¹æ¡ˆï¼Œæ˜¯ç”¨ <code class=\"language-text\">moduleNameMapper</code> æ¥ä»£æ›¿ <code class=\"language-text\">transform</code> çš„åŠŸèƒ½ã€‚</p>\n<p>ä»¥ CSS çš„å¤„ç†ä¸ºä¾‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  transform<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"^.+\\\\.(less|css)$\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jest-transform-stub\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¸Šé¢è¿™ä¸ªæ˜¯å¸¸è§„æ–¹æ¡ˆï¼Œä½†æ˜¯å¯¹ CSS / Less çš„å¤„ç†ä¸åŒ…å« node_modules çš„éƒ¨åˆ†ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  moduleNameMapper<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"^.+\\\\.(less|css)$\"</span><span class=\"token punctuation\">:</span> <span class=\"token string\">\"jest-transform-stub\"</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¸Šé¢è¿™ä¸ªæ–¹æ¡ˆï¼Œå¯ä»¥è¾¾åˆ°ä¸€æ ·çš„æ•ˆæœï¼Œä½†æ˜¯ node_module å†…çš„ CSS å¼•ç”¨ä¹Ÿä¼šè¢«æ­£ç¡®çš„å¤„ç†ã€‚</p>\n<p>ä¸¤ç§æ–¹æ¡ˆæ²¡æœ‰ä¼˜åŠ£ï¼Œä¸»è¦æ˜¯çœ‹ä½¿ç”¨çš„åœºæ™¯ã€‚</p>","frontmatter":{"date":"2019-05-30","title":"Transform node_modules in Jest","category":"JavaScript"}}},{"node":{"id":"02d0ac09-47f0-54ee-ac02-9e0d30ae56a5","html":"<p>ä¸€ç›´ä»¥æ¥ï¼Œ<a href=\"https://github.com/ReactiveX/rxjs\">rxjs</a> å’Œ <a href=\"https://github.com/facebook/react\">react</a> éƒ½ä¸å¤ªæ­ï¼Œè¦åœ¨ React ä¸­ä½¿ç”¨ rxjs å¾€å¾€éœ€è¦å†™å¹¶ä¸æ€ä¹ˆä¼˜é›…çš„ä»£ç ï¼Œæ¯”å¦‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Example</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> initial <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      value<span class=\"token punctuation\">:</span> initial<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscription <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentDidUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>prevProps<span class=\"token punctuation\">.</span>value$ <span class=\"token operator\">!==</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>value$<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">unregister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">unregister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscription <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>value$\n      <span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">value</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">unregister</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscription<span class=\"token punctuation\">)</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>subscription<span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>Example value$<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">interval</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¸Šé¢è¿™æ®µä»£ç ï¼Œä¼šæ ¹æ® <code class=\"language-text\">value$</code> è¿™ä¸ª Observable çš„æ•°æ®ï¼Œé€šè¿‡ React State è¿™ä¸ªæ¡¥æ¢ï¼Œå»æ›´æ–° UIã€‚å¹¶ä¸”ï¼Œä»£ç è€ƒè™‘åˆ°äº†ç»™å®šçš„ <code class=\"language-text\">value$</code> å¯èƒ½åç»­å˜åŒ–çš„æƒ…å†µã€‚å¦‚æœä¸è€ƒè™‘åç»­ <code class=\"language-text\">props</code> çš„ä¿®æ”¹ï¼Œä¸Šé¢çš„ä»£ç ä¾ç„¶éœ€è¦åœ¨ <code class=\"language-text\">componentDidMount</code> çš„æ—¶å€™æ³¨å†Œå›è°ƒå¹¶æ›´æ–°ï¼Œç„¶ååœ¨ <code class=\"language-text\">componentWillUnmount</code> çš„æ—¶å€™æ³¨é”€ï¼Œæ˜¾å¾—éå¸¸çš„å•°å—¦ã€‚</p>\n<p>LeetCode æä¾›çš„ <a href=\"https://github.com/LeetCode-OpenSource/rxjs-hooks\">rxjs-hooks</a> æä¾›äº†ä¸€ä¸ªæ›´ä¸ºä¼˜é›…çš„è§£å†³æ–¹æ¡ˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Example</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">props</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> initial <span class=\"token operator\">=</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> value <span class=\"token operator\">=</span> <span class=\"token function\">useObservable</span><span class=\"token punctuation\">(</span>\n    <span class=\"token punctuation\">(</span><span class=\"token parameter\">inputs$</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> inputs$<span class=\"token punctuation\">.</span><span class=\"token function\">pipe</span><span class=\"token punctuation\">(</span>\n      <span class=\"token function\">switchMap</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">[</span>value$<span class=\"token punctuation\">]</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> value$<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    initial<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">[</span>props<span class=\"token punctuation\">.</span>value$<span class=\"token punctuation\">]</span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\nReactDOM<span class=\"token punctuation\">.</span><span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token operator\">&lt;</span>Example value$<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">interval</span><span class=\"token punctuation\">(</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">,</span> document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>rxjs-hooks å¦å¤–æä¾›äº† <code class=\"language-text\">useEventCallback</code> æ¥æ›´å¥½çš„å¤„ç†äº‹ä»¶æµï¼Œå…·ä½“å¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„<a href=\"https://github.com/LeetCode-OpenSource/rxjs-hooks#useeventcallback\">æ–‡æ¡£</a>ã€‚</p>","frontmatter":{"date":"2019-05-23","title":"rxjs and hooks","category":"JavaScript"}}},{"node":{"id":"3656d85d-6ae6-5937-a3f4-54f2704bdfef","html":"<p><a href=\"https://github.com/JedWatson/classnames\">classnames</a> åº“æä¾›äº†ä¸€ä¸ª <code class=\"language-text\">bind</code> APIï¼Œç”¨äºå¤„ç† CSS Module çš„æƒ…å†µã€‚</p>\n<p>åœ¨ Webpack ä¸­ç”¨ CSS Module çš„æ–¹æ¡ˆç¼–è¯‘ CSS æ–‡ä»¶ï¼Œåç»­åœ¨ JavaScript ä¸­ <code class=\"language-text\">import style from &#39;xxx.css&#39;;</code> åï¼Œ<code class=\"language-text\">style</code> å°±æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚è¿™ä¸ªå¯¹è±¡çš„å¤§ä½“ç»“æ„å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  foo<span class=\"token punctuation\">:</span> <span class=\"token string\">'foo-abcde'</span><span class=\"token punctuation\">,</span>\n  bar<span class=\"token punctuation\">:</span> <span class=\"token string\">'bar-12345'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å…¶ä¸­ï¼Œå¯¹è±¡çš„ <code class=\"language-text\">key</code> æ˜¯åŸå§‹çš„ class nameï¼Œè€Œ <code class=\"language-text\">value</code> åˆ™æ˜¯æ–½åŠ  CSS Module ä¹‹åå¾—åˆ°çš„å”¯ä¸€åç§°ã€‚</p>\n<p>å¦‚æœç›´æ¥ä½¿ç”¨ <code class=\"language-text\">classnames</code> çš„æ ‡å‡† APIï¼Œé‚£ä¹ˆå†™èµ·æ¥å°±éœ€è¦å¤§é‡ä½¿ç”¨ computed property name çš„è¯­æ³•ï¼Œæ¯”å¦‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">classnames</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token punctuation\">[</span>style<span class=\"token punctuation\">.</span>foo<span class=\"token punctuation\">]</span><span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span>style<span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">]</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>è€Œä½¿ç”¨ <code class=\"language-text\">bind</code> APIï¼Œå¯ä»¥äº‹å…ˆå‘ŠçŸ¥ <code class=\"language-text\">classnames</code> class name çš„å¯¹åº”å…³ç³»ï¼ˆé€šè¿‡æŒ‡å®š <code class=\"language-text\">this</code>ï¼‰ï¼Œåç»­åªéœ€è¦ä½¿ç”¨å­—ç¬¦ä¸²ï¼Œ<code class=\"language-text\">classnames</code> å°±å¯ä»¥è‡ªåŠ¨ä½¿ç”¨åˆé€‚çš„ç»“æœï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"jsx\"><pre class=\"language-jsx\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> classNames <span class=\"token keyword\">from</span> <span class=\"token string\">'classnames/bind'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> styles <span class=\"token keyword\">from</span> <span class=\"token string\">'./style.css'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> cx <span class=\"token operator\">=</span> <span class=\"token function\">classNames</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span>styles<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Component</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>\n  <span class=\"token comment\">// result in: className=\"foo-abcde\"</span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">className</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token function\">cx</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> foo<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> bar<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span></span> <span class=\"token punctuation\">/></span></span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"date":"2019-05-20","title":"classnames & css module","category":"JavaScript"}}},{"node":{"id":"55791664-706d-538e-bbf1-6539a03a9d34","html":"<p><code class=\"language-text\">Object.create</code> å¯ä»¥ç”¨æä¾›çš„å¯¹è±¡åšæ–°å¯¹è±¡çš„ <code class=\"language-text\">__proto__</code>ã€‚è¿™å¯¼è‡´äº†ä¸€ä¸ªå¾ˆæœ‰è¶£çš„ç°è±¡ï¼Œå¦‚æœä½¿ç”¨ <code class=\"language-text\">Object.create(null)</code> æ¥åˆ›å»ºæ–°å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–°å¯¹è±¡ä¸Šå°±æ²¡æœ‰ä»»ä½• <code class=\"language-text\">__proto__</code>ã€‚å› ä¸º JavaScript çš„å¯¹è±¡ç»å¸¸è¢«ç”¨æ¥åšå­—å…¸ä½¿ç”¨ï¼Œ<code class=\"language-text\">Object.create(null)</code> å¯ä»¥è®©è¿™ä¸ªåŠŸèƒ½ä½¿ç”¨æ›´åŠ çš„çº¯ç²¹ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> dict <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">getPrototypeOf</span><span class=\"token punctuation\">(</span>dict<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: null</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> dict<span class=\"token punctuation\">.</span>hasOwnProperty<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: \"undefined\"</span>\n<span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>Object<span class=\"token punctuation\">.</span><span class=\"token function\">getPrototypeOf</span><span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output:</span>\n<span class=\"token comment\">// {</span>\n<span class=\"token comment\">//   constructor,</span>\n<span class=\"token comment\">//   hasOwnProperty,</span>\n<span class=\"token comment\">//   isPrototypeOf,</span>\n<span class=\"token comment\">//   propertyIsEnumerable,</span>\n<span class=\"token comment\">//   toLocaleString,</span>\n<span class=\"token comment\">//   toString,</span>\n<span class=\"token comment\">//   valueOf,</span>\n<span class=\"token comment\">//   ...</span>\n<span class=\"token comment\">// }</span></code></pre></div>\n<p>åŒæ ·ï¼Œå› ä¸ºæ²¡æœ‰ <code class=\"language-text\">prototype</code>ï¼Œç†è®ºä¸Šæ¥è¯´ï¼Œåç»­å¦‚æœæœ‰äººå¯¹ <code class=\"language-text\">Object.prototype</code> åšæ“ä½œï¼Œä¹Ÿä¸ä¼šå½±å“åˆ°ä½¿ç”¨ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> dict <span class=\"token operator\">=</span> Object<span class=\"token punctuation\">.</span><span class=\"token function\">create</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">null</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">addSomething</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> dict<span class=\"token punctuation\">.</span>addSomething<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: undefined</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> key <span class=\"token keyword\">in</span> dict<span class=\"token punctuation\">)</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// no output</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>addSomething<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: function</span>\n<span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> key <span class=\"token keyword\">in</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>key<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output: 'addSomething'</span></code></pre></div>\n<p>æ‰€ä»¥ï¼Œå¦‚æœåˆ¤æ–­å¯¹è±¡æœ‰æŸä¸ªå­—æ®µï¼Œé‚£ä¹ˆä¸€å®šæ˜¯ä»–è‡ªèº«æœ‰è¿™ä¸ªå­—æ®µï¼Œè€Œä¸ä¼šæ˜¯å› ä¸ºåŸå‹é“¾ä¸Šçš„å®šä¹‰ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸éœ€è¦ç”¨ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">Object</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span><span class=\"token function\">hasOwnProperty</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>dict<span class=\"token punctuation\">,</span> <span class=\"token string\">'addSomething'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è€Œåªéœ€è¦å†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>dict<span class=\"token punctuation\">.</span>addSomething<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å½“ç„¶ï¼Œè¿™ä¹Ÿä¼šæœ‰ä¸€äº›å¼Šç«¯ï¼Œæ¯”å¦‚é»˜è®¤ <code class=\"language-text\">Object.prototype</code> çš„ä¸œè¥¿å°±æ²¡äº†ï¼Œå¦‚æœéœ€è¦ <code class=\"language-text\">toString</code> ä¹‹ç±»çš„å‡½æ•°ï¼Œå¾—è‡ªå·±å†™ã€‚</p>","frontmatter":{"date":"2019-05-16","title":"Object.create(null)","category":"JavaScript"}}},{"node":{"id":"aba3154d-b96a-54f0-8d97-892f72232bdc","html":"<p>JavaScript çš„ <code class=\"language-text\">performance</code> é™¤äº†å¸¸ç”¨çš„ <code class=\"language-text\">now</code> / <code class=\"language-text\">mark</code> ä¹‹å¤–ï¼Œä¹Ÿæä¾›äº†å’Œé¡µé¢åŠ è½½ç›¸å…³çš„å¾ˆå¤šæ¥å£ã€‚é€šè¿‡è°ƒç”¨è¿™äº›æ¥å£ï¼Œå°±å¯ä»¥å¾ˆæ–¹ä¾¿çš„æ”¶é›†é¡µé¢åŠ è½½çš„ç›¸å…³æŒ‡æ ‡ï¼Œæ–¹ä¾¿äº†è§£ä¸åŒç”¨æˆ·çš„å®é™…ä½“éªŒã€‚</p>\n<p><code class=\"language-text\">perfomance.getEntries</code> è¿”å›çš„æ•°æ®ï¼Œæœ‰ä¸‰ç§ç±»å‹ï¼š<code class=\"language-text\">navigation</code>ï¼Œ<code class=\"language-text\">resource</code>ï¼Œ<code class=\"language-text\">paint</code>ã€‚</p>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">navigation</code> åŒ…å«äº† <code class=\"language-text\">PerformanceNavigationTiming</code>ï¼Œé‡Œé¢è®°å½•äº†å’Œé¡µé¢å¯¼èˆªç›¸å…³çš„æ—¶é—´ä¿¡æ¯ï¼Œæ¯”å¦‚ connection çš„èµ·å§‹/ç»“æŸæ—¶é—´ç­‰ã€‚å¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç æ‹¿åˆ°å®Œæ•´çš„æ•°æ®ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">performance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'navigation'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">toJSON</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// output:</span>\n<span class=\"token comment\">// connectEnd: xxx</span>\n<span class=\"token comment\">// connectStart: xxx</span>\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p><code class=\"language-text\">resource</code> åŒ…å«äº†æ‰€æœ‰çš„ <code class=\"language-text\">PerformanceResourceTiming</code>ã€‚æ¯ä¸€ä¸ªèµ„æºçš„è¯·æ±‚ï¼Œå¯¹åº”ä¸€ä¸ª <code class=\"language-text\">PerformanceResourceTiming</code>ã€‚ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">performance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'resource'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">,</span> duration <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">resource: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> use </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>duration<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> milliseconds to load</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// output:</span>\n  <span class=\"token comment\">// resource: https://xxxx use xxx milliseconds to load</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">paint</code> åŒ…å«äº†æ‰€æœ‰çš„ <code class=\"language-text\">PerformancePaintTiming</code>ã€‚ä¸€å…±æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«æ˜¯ first-paint å’Œ first-contentful-paintã€‚ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">performance<span class=\"token punctuation\">.</span><span class=\"token function\">getEntriesByType</span><span class=\"token punctuation\">(</span><span class=\"token string\">'paint'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> name<span class=\"token punctuation\">,</span> startTime <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">name: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>name<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">, startTime: </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>startTime<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// output:</span>\n  <span class=\"token comment\">// first-paint: xxxx</span>\n  <span class=\"token comment\">// first-contentful-paint: xxx</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"date":"2019-05-13","title":"performance data via JavaScript","category":"JavaScript"}}},{"node":{"id":"216ed083-b608-5ff1-998f-fa09397a0c01","html":"<p>åœ¨ HTML ä¸­ï¼Œå¦‚æœä¸€ä¸ª <code class=\"language-text\">a</code> æ ‡ç­¾ï¼Œå¸¦ä¸Šäº† <code class=\"language-text\">download</code> çš„å±æ€§ï¼Œé“¾æ¥åœ°å€å°±ä¼šè¢«æµè§ˆå™¨ç›´æ¥ç”¨äºä¸‹è½½ã€‚ä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>a</span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>link_here<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">download</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>filename.suffix<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>Link<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>a</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>åŒæ ·ï¼Œå¦‚æœéœ€è¦ JavaScript èƒ½å¤Ÿç›´æ¥è§¦å‘ä¸€ä¸ªèµ„æºçš„ä¸‹è½½ï¼Œå¯ä»¥åˆ›å»ºå¸¦ <code class=\"language-text\">download</code> å±æ€§çš„ <code class=\"language-text\">a</code> æ ‡ç­¾ï¼Œç„¶åè°ƒç”¨è¿™ä¸ªå…ƒç´ çš„ <code class=\"language-text\">click</code> æ–¹æ³•ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createDocument</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\na<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> <span class=\"token string\">'link_here'</span><span class=\"token punctuation\">;</span>\na<span class=\"token punctuation\">.</span>download <span class=\"token operator\">=</span> <span class=\"token string\">'filename'</span><span class=\"token punctuation\">;</span>\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\na<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// trigger download</span>\ndocument<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span>a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p><code class=\"language-text\">download</code> çš„æ”¯æŒæƒ…å†µè§<a href=\"https://caniuse.com/download/embed\">è¿™é‡Œ</a>ã€‚</p>\n<p>è¿™ä¸ªæ–¹æ¡ˆæœ‰ä¸€ä¸ªé—®é¢˜ï¼šå¦‚æœæ˜¯è·¨åŸŸçš„èµ„æºï¼Œç›´æ¥è¿™æ ·çš„ <code class=\"language-text\">a</code> æ ‡ç­¾ç‚¹å‡»æ˜¯ä¸èƒ½è°ƒç”¨ä¸‹è½½çš„ï¼ˆå› ä¸ºæ‰§è¡Œäº†ä¸¥æ ¼çš„åŒæºç­–ç•¥ï¼‰ï¼Œè¡Œä¸ºä¸Šå°±ä¼šå’Œä¸€ä¸ªæ™®é€šçš„å¯¼èˆªæ²¡æœ‰åŒºåˆ«ï¼ˆæ¯”å¦‚ï¼Œå¢åŠ  <code class=\"language-text\">target=_blank</code> ä¹‹åå°±ä¼šæ‰“å¼€ä¸€ä¸ªæ–°çª—å£å±•ç¤ºèµ„æºï¼‰ã€‚</p>\n<p>è§£å†³è·¨åŸŸçš„ä¸€ä¸ªå‰ç«¯æ–¹æ¡ˆæ˜¯ï¼šfetch èµ„æºï¼Œç„¶åå°†ç»“æœè½¬åŒ–æˆ Blobï¼Œç„¶åå°†è¿™ä¸ª Blob ç”Ÿæˆä¸€ä¸ª URLã€‚ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">'link_here'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">repsonse</span> <span class=\"token operator\">=></span> response<span class=\"token punctuation\">.</span><span class=\"token function\">blob</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">blob</span> <span class=\"token operator\">=></span> <span class=\"token constant\">URL</span><span class=\"token punctuation\">.</span><span class=\"token function\">createObjectURL</span><span class=\"token punctuation\">(</span>blob<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">link</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    a<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> link<span class=\"token punctuation\">;</span>\n    a<span class=\"token punctuation\">.</span>download <span class=\"token operator\">=</span> <span class=\"token string\">'filename.here'</span><span class=\"token punctuation\">;</span>\n    document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    a<span class=\"token punctuation\">.</span><span class=\"token function\">click</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">.</span><span class=\"token function\">removeChild</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"date":"2019-05-10","title":"download third party resource","category":"JavaScript"}}},{"node":{"id":"683b3848-8eb5-5274-8d09-afff4543ca05","html":"<p>Promise.allSettled å·²ç»åœ¨ Chrome 76 ä¸­ä¸Šçº¿äº†ã€‚</p>\n<p>ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> promises <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  Promise<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fulfilled'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  Promise<span class=\"token punctuation\">.</span><span class=\"token function\">reject</span><span class=\"token punctuation\">(</span><span class=\"token string\">'rejected'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\nPromise<span class=\"token punctuation\">.</span><span class=\"token function\">allSettled</span><span class=\"token punctuation\">(</span>promises<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">result</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">/**\n     * output:\n     * [\n     *   { status: 'fulfilled', value: 'fulfilled' },\n     *   { status: 'rejected', reason: 'rejected' },\n     * ]\n     */</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>result<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åªæœ‰æ‰€æœ‰æ•°ç»„ä¸­çš„ Promise çš„ç»“æœä¸å†æ˜¯ <code class=\"language-text\">pending</code>ï¼Œ<code class=\"language-text\">.allSettled</code> æ‰ä¼šè¿”å›ç»“æœã€‚</p>\n<p>å’Œ <code class=\"language-text\">.all</code>ï¼Œ<code class=\"language-text\">.race</code> ä¸¤ä¸ª API æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼Œ<code class=\"language-text\">.allSettled</code> ä¸ä¼šæå‰ç»“æŸã€‚<code class=\"language-text\">.all</code> ä¼šåœ¨ä»»æ„ä¸€ä¸ª Promise <code class=\"language-text\">reject</code> çš„æ—¶å€™å¤±è´¥ï¼Œè€Œ <code class=\"language-text\">.race</code> åˆ™ä¼šåœ¨ä»»æ„ä¸€ä¸ª Promise <code class=\"language-text\">fulfilled</code> çš„æ—¶å€™æˆåŠŸã€‚<code class=\"language-text\">.allSettled</code> ä¼šç­‰åˆ°æ‰€æœ‰ç»“æœéƒ½å‡ºæ¥ä¹‹åï¼Œå†å¦‚å®è¿”å›ï¼ˆä»¥ <code class=\"language-text\">fulfilled</code> çš„çŠ¶æ€ï¼‰ã€‚</p>\n<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œè¿”å›çš„ç»“æœæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªå¯¹è±¡ã€‚å…¶ä¸­ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½æœ‰ <code class=\"language-text\">status</code> çš„å­—æ®µï¼Œè¡¨ç¤ºå¯¹åº”çš„ Promise æœ€ç»ˆçš„ç»“æœæ˜¯ <code class=\"language-text\">fulfilled</code> è¿˜æ˜¯ <code class=\"language-text\">rejected</code>ã€‚å¦‚æœæ˜¯ <code class=\"language-text\">fulfilled</code> çŠ¶æ€ï¼Œé‚£ä¹ˆå¯¹è±¡ä¼šæœ‰ <code class=\"language-text\">value</code> å­—æ®µï¼Œå€¼ç›¸å½“äº <code class=\"language-text\">.then</code> å›è°ƒä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ï¼›å¦‚æœæ˜¯ <code class=\"language-text\">rejected</code> çŠ¶æ€ï¼Œé‚£ä¹ˆå¯¹è±¡ä¼šæœ‰ <code class=\"language-text\">reason</code> å­—æ®µï¼Œå€¼ç›¸å½“äº <code class=\"language-text\">.catch</code> å›è°ƒä¸­çš„ç¬¬ä¸€ä¸ªå‚æ•°ã€‚</p>","frontmatter":{"date":"2019-05-09","title":"Promise.allSettled","category":"JavaScript"}}},{"node":{"id":"59648bef-5b8c-51a7-bd1c-badf363cd310","html":"<p>æµè§ˆå™¨æ˜¾ç¤º Notification é»˜è®¤æ˜¯æœ‰ä¸€ä¸ªè‡ªåŠ¨æ¶ˆå¤±æ—¶é—´çš„ã€‚ä¸åŒçš„æµè§ˆå™¨ï¼Œè¿™é‡Œçš„æ¶ˆå¤±æ—¶é—´å¹¶ä¸ä¸€è‡´ï¼Œä»æµ‹è¯•æ¥çœ‹ï¼š</p>\n<ul>\n<li>Chrome: ~6s</li>\n<li>Firefox: ~19s</li>\n<li>Edge: ~6s</li>\n</ul>\n<p>ä»ç›®å‰æµè§ˆå™¨å…¬å¼€çš„ API æ¥çœ‹ï¼Œå¹¶æ²¡æœ‰ä¸€ä¸ªæ¥å£å¯ä»¥ç›´è§‚çš„ä¿®æ”¹è¿™é‡Œçš„æ¶ˆå¤±æ—¶é—´ã€‚ä¸€ä¸ªå¯è¡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ï¼šç”¨ <code class=\"language-text\">requireInteraction</code> æ¥å¼ºåˆ¶è¦æ±‚æµè§ˆå™¨ä¸è‡ªåŠ¨å…³é—­ Notificationï¼Œç„¶åè®¾ç½® <code class=\"language-text\">setTimeout</code> å¹¶åœ¨åˆé€‚çš„æ—¶æœºæ‰‹åŠ¨å…³é—­è¿™ä¸ªæ˜¾ç¤ºçš„ Notificationã€‚</p>\n<p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> delay <span class=\"token operator\">=</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\nNotification<span class=\"token punctuation\">.</span><span class=\"token function\">requestPermission</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">===</span> <span class=\"token string\">\"granted\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> notification <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Notification</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"Hi! \"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        requireInteraction<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> timer <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      notification<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç›®å‰ <code class=\"language-text\">requireInteraction</code> çš„æµè§ˆå™¨æ”¯æŒæƒ…å†µå¹¶ä¸éå¸¸ç†æƒ³ï¼Œåªæœ‰ Chrome, Edge(17+) å’Œ Opera åšäº†æ”¯æŒã€‚å…·ä½“çš„æ”¯æŒåˆ—è¡¨ï¼Œå¯ä»¥çœ‹<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Notification/requireInteraction\">è¿™é‡Œ</a>ã€‚</p>\n<p>å¦å¤–ï¼Œä»å®é™…çš„ä½¿ç”¨ä¸Šæ¥çœ‹ï¼ŒEdge æµè§ˆå™¨ä¸­å³ä½¿è®¾ç½®äº† <code class=\"language-text\">requireInteraction</code>ï¼Œnotification åœ¨ä¸€å®šæ—¶é—´ä¹‹åä¹Ÿä¼šæ¶ˆå¤±ï¼Œåªæ˜¯æ¶ˆå¤±çš„æ—¶é—´ä¼šæ¯”åŸæ¥é»˜è®¤çš„æƒ…å†µè¦é•¿ä¸€äº›ï¼Œå¤§çº¦æ˜¯ 25 ç§’ã€‚Chrome çš„ Notification å¦‚æœè®¾ç½®äº† <code class=\"language-text\">requireInteraction</code>ï¼Œä¼šå¤šä¸€ä¸ª Close çš„æŒ‰é’®ï¼Œå±•ç¤ºæ•ˆæœå’Œæ²¡æœ‰ <code class=\"language-text\">requireInteraction</code> çš„æƒ…å†µæœ‰æ‰€ä¸åŒã€‚</p>","frontmatter":{"date":"2019-05-07","title":"custom display time of notification","category":"JavaScript"}}},{"node":{"id":"4e93db01-f1ba-59f4-a707-1cda13162c97","html":"<p><code class=\"language-text\">style</code> æœ¬èº«æ˜¯ä¸€ä¸ªæ ‡å‡†çš„ HTML æ ‡ç­¾ï¼Œåœ¨é‡Œé¢å†™çš„ CSS æ ·å¼ï¼Œä¼šè¢«åº”ç”¨åˆ°é¡µé¢ä¸Šã€‚åŒæ—¶ï¼Œä½œä¸ºä¸€ä¸ª HTML æ ‡ç­¾ï¼Œ<code class=\"language-text\">style</code> æœ¬èº«ä¹Ÿå¯ä»¥è¢«èµ‹äºˆä¸€å®šçš„å±•ç¤ºæ ·å¼ï¼ˆæ¯”å¦‚å°†é»˜è®¤çš„ <code class=\"language-text\">style { display: none; }</code> ç»™è¦†ç›–æ‰ï¼‰ã€‚åŠ ä¸Š <code class=\"language-text\">contenteditable</code> çš„å±æ€§ï¼Œå°±ä¼šå¾—åˆ°ä¸€ä¸ªå¯ç¼–å†™çš„ <code class=\"language-text\">style</code> æ ‡ç­¾ã€‚é€šè¿‡ç›´æ¥ç¼–å†™å…¶ä¸­çš„ CSS æ ·å¼ï¼Œé¡µé¢ä¼šè‡ªåŠ¨æ›´æ–°ï¼Œå±•ç¤ºåº”ç”¨æ ·å¼åçš„æ•ˆæœã€‚</p>\n<style>\n\n.editable-style-indicator {\n  width: 20px;\n  height: 20px;\n  border-radius: 20px;\n  margin-left: 3px;\n  background-color: #e65525;\n  box-shadow: 0 0 0 3px #e78267;\n}\n.editable-style-indicator:hover + style.editable-style,\nstyle.editable-style:focus,\nstyle.editable-style:hover {\n  display: block;\n  min-height: 5rem;\n  max-height: 10rem;\n  overflow: auto;\n  margin-top: -23px;\n  background-color: #ccc;\n}\n</style>\n<p></p>\n<div class=\"editable-style-indicator\"></div>\n<style contenteditable class=\"editable-style\"></style>\n<p></p>\n<p>ä¸Šé¢å±•ç¤ºçš„è¿™ä¸ªåœ†ç‚¹ï¼Œé¼ æ ‡æ‚¬åœä¹‹åï¼Œå°±ä¼šæ˜¾ç¤ºä¸€ä¸ªå¯è¾“å…¥çš„æ¡†ã€‚åœ¨é‡Œé¢è¾“å…¥ä¸€äº› CSS å¯ä»¥çœ‹åˆ°å¯¹é¡µé¢å…ƒç´ çš„ä¿®æ”¹ã€‚æ¯”å¦‚ï¼Œå¯ä»¥è¯•è¯•è¾“å…¥ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">article small:nth-child(3)</span> <span class=\"token punctuation\">{</span> <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #007acc<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>å‡ ç‚¹æ³¨æ„ï¼š</p>\n<ol>\n<li>ç›´æ¥å¤åˆ¶ä¸Šé¢çš„ CSS ç„¶åé»è´´ä¸ä¼šèµ·æ•ˆï¼Œå› ä¸ºæ ·å¼ä¹Ÿè¢«é»è´´åˆ° <code class=\"language-text\">style</code> é‡Œé¢å»äº†ï¼Œè¿™ä¼šå¯¼è‡´ <code class=\"language-text\">style</code> é‡Œçš„å†…å®¹ä¸æ˜¯åˆæ³•çš„ CSSï¼Œæ— æ³•åº”ç”¨æ ·å¼</li>\n<li>CSS éœ€è¦å†™åœ¨ä¸€è¡Œé‡Œé¢ï¼Œå›è½¦ä¼šå¯¼è‡´æ’å…¥ <code class=\"language-text\">&lt;br /&gt;</code>ï¼ŒåŒæ ·ä¼šå¯¼è‡´ CSS è¯­æ³•é”™è¯¯ï¼Œæ— æ³•åº”ç”¨æ ·å¼</li>\n</ol>","frontmatter":{"date":"2019-05-05","title":"contenteditable style","category":"JavaScript"}}},{"node":{"id":"951e3d2b-04c7-59ef-b089-9512c23b864d","html":"<p>å¦‚æœæ‹¿åˆ°äº†ä¸€ä»½å¸¦æœ‰ source map çš„ JavaScript ä»£ç ï¼Œé‚£ä¹ˆç†è®ºä¸Šå°±å¯ä»¥é€šè¿‡è¿™ä»½ source map å»å°½å¯èƒ½çš„è¿˜åŸå‡ºåŸå§‹çš„æ–‡ä»¶å†…å®¹ã€‚</p>\n<p>é¦–å…ˆï¼Œsource map æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ª JSON æ–‡ä»¶ã€‚åœ¨å…¶ä¸­ï¼Œ<code class=\"language-text\">sourceContent</code> æ•°ç»„å°±è®°å½•äº†æ‰€æœ‰æºæ–‡ä»¶çš„çº¯æ–‡æœ¬å†…å®¹ï¼Œè€Œè¿™äº›æ–‡ä»¶çš„æ–‡ä»¶è·¯å¾„åŠæ–‡ä»¶ååˆ™å­˜æ”¾åœ¨äº† <code class=\"language-text\">sources</code> æ•°ç»„ä¸­ã€‚ä¸¤è€…ç›¸äº’å¯¹åº”ï¼Œç†è®ºä¸Šæ¥è¯´å‚ç…§è¿™ä¸¤è€…çš„æ•°æ®ï¼Œå°±å¯ä»¥å°†æºæ–‡ä»¶è¿˜åŸåˆ°åŸå§‹çš„ç›®å½•ä¸‹ã€‚</p>\n<p>ç„¶è€Œï¼ŒWebpack çš„æ‰“åŒ…ç»“æœï¼Œæ–‡ä»¶çš„è·¯å¾„åç§°éƒ½å¸¦ä¸Šäº† <code class=\"language-text\">webpack:///</code> çš„å‰ç¼€ã€‚åœ¨å®é™…å¤„ç†çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨å·²æœ‰çš„åº“ï¼Œæ¯”å¦‚ <a href=\"https://github.com/alexkuz/restore-source-tree\"><code class=\"language-text\">restore-source-tree</code></a>ã€‚</p>\n<p>è¿™ä¸ªåº“å› ä¸ºå·²ç»æ¯”è¾ƒè€äº†ï¼Œå¯¹ Webpack 3/4 ç­‰æ–°ç‰ˆæœ¬çš„æ”¯æŒå­˜åœ¨é—®é¢˜ã€‚åœ¨åŸåº“åˆå¹¶ PR ä¹‹å‰ï¼Œå¯ä»¥å…ˆä½¿ç”¨æ”¹è¿›è¿‡çš„ç‰ˆæœ¬ <a href=\"https://github.com/laysent/restore-source-tree\"><code class=\"language-text\">restore-source-tree</code></a>ã€‚</p>\n<p>è¿™ä¸ªä¿®æ”¹è¿‡çš„ç‰ˆæœ¬ï¼Œé™¤äº†ä¿®å¤å¯¹æ–°ç‰ˆ Webpack ç¼–è¯‘ç»“æœçš„æ”¯æŒå¤–ï¼Œä¹ŸåŠ å…¥äº† glob çš„æ”¯æŒï¼Œå¯ä»¥æ›´æ–¹ä¾¿çš„è¿›è¡Œæ‰¹é‡ source map è¿˜åŸã€‚</p>\n<p>å‚è€ƒä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">restore-source-tree -o output_folder path/to/source-maps/*.map</code></pre></div>\n<p>æœ€ç»ˆç”Ÿæˆçš„æ–‡ä»¶ä¼šå­˜æ”¾åœ¨ output_folder ä¸‹ã€‚</p>","frontmatter":{"date":"2019-05-03","title":"restore source map","category":"JavaScript"}}},{"node":{"id":"f0198f26-c43f-5ce7-b342-efb1aed6b269","html":"<p>åœ¨ã€ŠJavaScript: The Good Partsã€‹é‡Œï¼Œä½œè€…å¹¶ä¸èµæˆ <code class=\"language-text\">switch</code> è¯­å¥çš„ä½¿ç”¨ï¼ˆä¸»è¦æ˜¯å› ä¸º fall-through çš„æƒ…å†µå¾ˆå®¹æ˜“é€ æˆé”™è¯¯ï¼‰ã€‚ç„¶è€Œåœ¨å®é™…çš„ä»£ç é‡Œï¼Œè¿˜æ˜¯æœ‰ä¸å°‘åœ°æ–¹å¯ä»¥çœ‹åˆ° switch çš„ä½¿ç”¨ã€‚ç›®çš„å„ä¸ç›¸åŒï¼Œæœ‰ä¸å°‘å¯ä»¥å€Ÿé‰´çš„åœ°æ–¹ã€‚</p>\n<section><h2>é»˜è®¤å€¼è®¾ç½®</h2><p>React çš„ <a href=\"https://github.com/facebook/react/blob/master/packages/scheduler/src/Scheduler.js#L220\">Scheduler</a> ä¸­ï¼Œæœ‰è¿™æ ·ä¸€æ®µä»£ç ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>priorityLevel<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">case</span> ImmediatePriority<span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">case</span> UserBlockingPriority<span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">case</span> NormalPriority<span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">case</span> LowPriority<span class=\"token punctuation\">:</span>\n  <span class=\"token keyword\">case</span> IdlePriority<span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n    priorityLevel <span class=\"token operator\">=</span> NormalPriority<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>ä¸å¤±ä¸ºè®¾ç½®é»˜è®¤å€¼çš„ä¸€ç§å†™æ³•ï¼Œçœ‹ä¸Šå»æ¯”ä½¿ç”¨ if æ¥å¾—æ›´æ˜ç¡®ä¸€äº›ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>\n  priorityLevel <span class=\"token operator\">!==</span> ImmediatePriority <span class=\"token operator\">&amp;&amp;</span>\n  priorityLevel <span class=\"token operator\">!==</span> UserBlockingPriority <span class=\"token operator\">&amp;&amp;</span>\n  priorityLevel <span class=\"token operator\">!==</span> NormalPriority <span class=\"token operator\">&amp;&amp;</span>\n  priorityLevel <span class=\"token operator\">!==</span> LowPriority <span class=\"token operator\">&amp;&amp;</span>\n  priorityLevel <span class=\"token operator\">!==</span> IdlePriority\n<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  priorityLevel <span class=\"token operator\">=</span> NormalPriority<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div></section>\n<section><h2>é˜²æ­¢ä»£ç ç¯¡æ”¹çš„åˆ¤å®š</h2><p>ä¸Šé¢çš„éœ€æ±‚ï¼Œä¹Ÿå¾ˆå®¹æ˜“å†™æˆä¸‹é¢è¿™ç§æ•°ç»„çš„æ–¹æ¡ˆï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> allowedValues <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  ImmediatePriority<span class=\"token punctuation\">,</span>\n  UserBlockingPriority<span class=\"token punctuation\">,</span>\n  NormalPriority<span class=\"token punctuation\">,</span>\n  LowPriority<span class=\"token punctuation\">,</span>\n  IdlePriority<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isNot</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">value</span> <span class=\"token operator\">=></span> <span class=\"token parameter\">comparedTo</span> <span class=\"token operator\">=></span> value <span class=\"token operator\">!==</span> comparedTo<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>allowedValues<span class=\"token punctuation\">.</span><span class=\"token function\">every</span><span class=\"token punctuation\">(</span><span class=\"token function\">isNot</span><span class=\"token punctuation\">(</span>priorityLevel<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  priorityLevel <span class=\"token operator\">=</span> NormalPriority<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>ç„¶è€Œï¼Œè¿™æ ·çš„ä»£ç æ–¹å¼ï¼Œå¯èƒ½å­˜åœ¨è¢«å…¥ä¾µçš„å±é™©ã€‚ä¸è®ºæ˜¯ä¸Šé¢ä¾‹å­ä¸­çš„ <code class=\"language-text\">every</code> å‡½æ•°ï¼Œè¿˜æ˜¯ç”¨ <code class=\"language-text\">Array.prototype</code> ä¸Šçš„ä»»æ„å‡½æ•°ï¼Œéƒ½æœ‰è¢«ç¯¡æ”¹çš„å¯èƒ½æ€§ã€‚å¦‚æœå…¶ä»–åœ°æ–¹çš„ä»£ç ä¿®æ”¹äº† <code class=\"language-text\">Array.prototype.every</code> çš„è¡Œä¸ºï¼Œè®©è¿™é‡Œçš„è¿”å›å€¼å‘ç”Ÿäº†å˜åŒ–ï¼Œé‚£ä¹ˆä»£ç æœ€ç»ˆå°±ä¼šäº§ç”Ÿæ„æ–™ä¹‹å¤–çš„è¡Œä¸ºã€‚</p><p>åœ¨ Scheduler ä¸­å½“ç„¶ä¸éœ€è¦è€ƒè™‘è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯åœ¨å…¶ä»–çš„åº”ç”¨åœºæ™¯ä¸‹ï¼Œè¿™å¯èƒ½æ˜¯ä¸å¾—ä¸è€ƒè™‘çš„é—®é¢˜ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœä¸€ä¸ª Web åº”ç”¨å…è®¸ç¬¬ä¸‰æ–¹è„šæœ¬çš„è¿è¡Œï¼ŒåŒæ—¶è‡ªèº«æœ‰å¯¹æ•°æ®è¿›è¡Œç™½åå•æ£€æŸ¥çš„éœ€æ±‚ï¼Œé‚£ä¹ˆå°±åªèƒ½ä½¿ç”¨ switch ç¡¬ç¼–ç æ‰€æœ‰çš„æƒ…å†µï¼Œè€Œä¸èƒ½ä½¿ç”¨æ•°ç»„æˆ–è€…å¯¹è±¡ï¼Œå¦åˆ™ç¬¬ä¸‰æ–¹çš„è„šæœ¬æœ‰å¯èƒ½å¯¹æœ€ç»ˆçš„è¡Œä¸ºåšç¯¡æ”¹ã€‚</p><p>Microsoft Teams çš„ä»£ç é‡Œï¼Œå°±æœ‰ç±»ä¼¼çš„åº”ç”¨åœºæ™¯ï¼ˆè§ extracted/lib/renderer/preload_sandbox.jsï¼‰ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">isChannelAllowed</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">channel</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token keyword\">let</span> isAllowed <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// IMPORTANT - the allowList must be a hardcorded switch statement.</span>\n  <span class=\"token comment\">// Array and object methods can be overridden and forced to return true.</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>channel<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> xxx<span class=\"token punctuation\">:</span>\n    <span class=\"token comment\">// ...</span>\n    <span class=\"token keyword\">case</span> zzz<span class=\"token punctuation\">:</span>\n      isAllowed <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n      isAllowed <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div></section>","frontmatter":{"date":"2019-05-01","title":"use case of switch","category":"JavaScript"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"category":"JavaScript"}}}
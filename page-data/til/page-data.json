{"componentChunkName":"component---src-pages-til-js","path":"/til/","result":{"data":{"site":{"siteMetadata":{"title":"LaySent's Site"}},"allMarkdownRemark":{"edges":[{"node":{"id":"202b1c1f-e486-5449-863c-b7cad49cf68a","html":"<p>åœ¨ä½¿ç”¨ TypeScript + Webpack çš„é¡¹ç›®ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°å¦‚ä¸‹ç±»ä¼¼çš„æŠ¥é”™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">WARNING in ./src/xxx.tsx 346:0-62\n&quot;export &#39;xxx&#39; was not found in &#39;./xxxx&#39;</code></pre></div>\n<p>è¿™ç±»æŠ¥é”™å‡ºç°çš„æƒ…å†µæ˜¯ï¼Œåœ¨ <code class=\"language-text\">./scr/xxx.tsx</code> æ–‡ä»¶ä¸­ï¼Œå…ˆ <code class=\"language-text\">import</code> äº†ä¸€ä¸ªç±»å‹å®šä¹‰ï¼Œç„¶ååˆå°†è¿™ä¸ªç±»å‹å®šä¹‰é‡æ–° <code class=\"language-text\">export</code> å‡ºå»äº†ã€‚äº§ç”ŸæŠ¥é”™çš„åŸå› åœ¨äºï¼ŒTypeScript çš„æ–‡ä»¶éœ€è¦é€šè¿‡ loaderï¼ˆæ— è®ºæ˜¯ babel-loader è¿˜æ˜¯ ts-loaderï¼‰è½¬åŒ–æˆ Webpack å¯è¯†åˆ«çš„ JavaScript æ–‡ä»¶ã€‚åœ¨è½¬åŒ–ä¹‹åï¼ŒTypeScript ä¸­å®šä¹‰çš„çº¯ç±»å‹ï¼ˆå¦‚ interfaceï¼‰éƒ½ä¸¢å¤±äº†ã€‚æ­£å› ä¸ºè¿™äº›ç±»å‹ä¸¢å¤±äº†ï¼Œåœ¨è¯•å›¾é‡æ–° <code class=\"language-text\">export</code> çš„æ—¶å€™ï¼ŒWebpack å°±æ— æ³•æ‰¾åˆ°å¯¹åº”çš„å®šä¹‰ï¼Œåªèƒ½æŠ¥é”™ï¼ˆWarningï¼‰äº†ã€‚</p>\n<p>å¯ä»¥è€ƒè™‘é€šè¿‡ä»¥ä¸‹çš„æ–¹æ¡ˆé¿å…è­¦å‘Šï¼š</p>\n<ol>\n<li>å°†æ‰€æœ‰çš„ç±»å‹å®šä¹‰æ”¾åˆ°å•ç‹¬çš„æ–‡ä»¶ï¼ˆæ¯”å¦‚ <code class=\"language-text\">types.ts</code> ä¸­ï¼‰ï¼Œç„¶åé€šè¿‡ <code class=\"language-text\">export * from &#39;types.ts&#39;</code> ä¸€æ¬¡æ€§å°†æ‰€æœ‰å†…å®¹ export å‡ºå»ï¼ˆè¿™æ ·å¯ä»¥é¿å…å…·ä½“å£°æ˜éœ€è¦ export çš„å†…å®¹ï¼‰ï¼›</li>\n<li>é‡æ–°åœ¨å½“å‰æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªç±»å‹ï¼Œç„¶åå°†è¿™ä¸ªç±»å‹ export å‡ºå»ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Type <span class=\"token keyword\">as</span> _Type <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./type'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> Type <span class=\"token operator\">=</span> _Type<span class=\"token punctuation\">;</span></code></pre></div>\n<p>åœ¨ TypeScript 3.7 ä¹‹å‰ï¼Œä¸Šé¢çš„ä»£ç å¯ä»¥ç®€å†™ä¸ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Type <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./type'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">type</span> Type <span class=\"token operator\">=</span> Type<span class=\"token punctuation\">;</span></code></pre></div>\n<p>åœ¨ 3.7 åŠä¹‹åçš„ç‰ˆæœ¬ä¸­ï¼Œå¿…é¡»ä¿è¯æ–°å®šä¹‰çš„ç±»å‹åç§°å’ŒåŸæ¥çš„ç±»å‹åç§°ä¸åŒã€‚è¿™æ˜¯å› ä¸ºåœ¨ TypeScript 3.7 ä¸­å¯¹ç±»å‹å®šä¹‰åšäº†è°ƒæ•´ï¼Œåœ¨æä¾›æ›´å¼ºå¤§çš„é€’å½’å¼•ç”¨ç±»å‹åŠŸèƒ½çš„åŒæ—¶ï¼Œä¸å†å…è®¸å®šä¹‰åŒåçš„ç±»å‹ã€‚ç›¸å…³çš„ä»‹ç»ï¼Œå¯ä»¥æŸ¥çœ‹å®˜æ–¹çš„<a href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-3-7/#more-recursive-type-aliases\">å‘å¸ƒæ–‡æ¡£</a>ã€‚</p>","frontmatter":{"date":"2019-12-05","title":"Export was Not Found","category":"TypeScript"}}},{"node":{"id":"6f7bce64-d072-5ef5-abd7-98cd4c6118b3","html":"<p>è¦çŸ¥é“ä¸€ä¸ªç½‘é¡µä¸­çš„æ–‡æœ¬ï¼Œå…·ä½“æ˜¯ä½¿ç”¨ä»€ä¹ˆå­—ä½“æ¸²æŸ“å‡ºæ¥çš„ï¼Œå¹¶ä¸æ˜¯éå¸¸ç®€å•çš„äº‹æƒ…ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸€äº›æ–¹æ¡ˆè¿›è¡Œå°è¯•ã€‚</p>\n<section><h2>getComputedStyle</h2><p>ä½¿ç”¨ <code class=\"language-text\">window.getComputedStyle</code> å±æ€§è·å–å¯¹åº”å…ƒç´ çš„ <code class=\"language-text\">font-family</code> å­—æ®µã€‚å› ä¸ºå­—ä½“çš„è®¾ç½®ä¸€èˆ¬æ˜¯é€šè¿‡é¡¶å±‚é…ç½®ï¼Œå­å…ƒç´ ç»§æ‰¿çš„æ–¹å¼å®Œæˆçš„ï¼Œå› æ­¤åœ¨å¤§å¤šæ•°çš„å…ƒç´ ä¸Šï¼Œå¹¶æ²¡æœ‰ <code class=\"language-text\">font-family</code> è®¾ç½®ã€‚å³ä½¿æœ‰ï¼Œå¤§æ¦‚ç‡ä¹Ÿæ˜¯é€šè¿‡ CSS å®Œæˆçš„ï¼Œå› æ­¤ä» <code class=\"language-text\">.style</code> æˆ–è€… <code class=\"language-text\">.attributeStyleMap</code> æ— æ³•æ‹¿åˆ°éœ€è¦çš„æ•°æ®ã€‚<code class=\"language-text\">getComputedStyle</code> å¯ä»¥è·å–å½“å‰å…ƒç´ ä¸Šæ ·å¼çš„æœ€ç»ˆè®¡ç®—å€¼ï¼Œå› æ­¤å³ä½¿å­—ä½“å®é™…æ¥è‡ªäºç»§æ‰¿æˆ–è€…ç³»ç»Ÿé»˜è®¤å­—ä½“ï¼Œéƒ½å¯ä»¥é€šè¿‡è¯¥ API è·å–åˆ°ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªæ²¡æœ‰ CSS è®¾ç½®çš„é¡µé¢ä¸Šï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç çŸ¥é“å…·ä½“ä½¿ç”¨çš„ç³»ç»Ÿé»˜è®¤å­—ä½“æ˜¯ä»€ä¹ˆï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">window<span class=\"token punctuation\">.</span><span class=\"token function\">getComputedStyle</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fontFamily<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// MacOS (Chrome): Times</span>\n<span class=\"token comment\">// Windows (Chrome): Microsoft YaHei</span></code></pre></div><p>éç¼–ç¨‹çš„æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨ Chrome DevTools ä¸­ç›´æ¥æ‰¾åˆ° Elements ä¸‹çš„ Computed éƒ¨åˆ†ï¼ŒæŸ¥çœ‹å®é™…ä½¿ç”¨çš„ CSS å±æ€§å€¼ã€‚æ³¨ï¼šå¦‚æœ <code class=\"language-text\">font-family</code> å¹¶æ²¡æœ‰è¢«å®šä¹‰è¿‡ï¼Œå¯ä»¥å‹¾é€‰ All æ¥æŸ¥çœ‹ç³»ç»Ÿé»˜è®¤çš„å±æ€§å€¼ã€‚</p><p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2f6b9b41cfadb16613696e96a940262e/cb0d3/2019-12-04-computed-style.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 130.95975232198143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAABYlAAAWJQFJUiTwAAAD40lEQVRIx5WVi2/aVhjF+Uv336ybFjKSNMnWbR1dq6pb1ocqVVMndWuabqFZIh62IZSHedoY24BtwOAXZ9+9EAYk1VpLB/va3OPfvd/1uTHXddFut1EsFlEqlTAYDKB1VOQlAYW8CLlawXg0Qr3egCSJME0ThmHw84juO47Dxfr1ej3EuIGmodPpoKt1oOs6qi0TUrmNS7mDgtyF0u1B73b5i9lz1rHf73MT27ZhWRZvM8UajQYymQw3VDUDFxkRZ2kJqQsBTdVEvalAlPKQ5Srevy8in5egKHNjBjIcDrnplWKe52E6nXIZtgfN8qDbPp199IYBgsCH7/vwvIX8FVHfTcVw0xF59BMAMx9R4GEW+iRvTez+TUdsNpthKboRei5aJ0mkn+9C/uM79M9+gn6ahJFKwkzdo/M99E7vwkw/5f9f609aErIGh/MnUI73UX71JaTfvoB5tgcnvY/B+W3YF/v82kxtQ0vdX/a76ssJNw1DbwLt7SE0cR9/v72FdOoWikIc8mWC9DUqhV30hD0yfPDxhuqbA7TEBB78voOthwfYe3yA5Mvvcfflj3iR2oOajn+aoXJMhsI2Hh0nkXj2DIknjxA/eoivjh7j+V930ElvoXP6CYbaySEU6TZSmS2c57bwTy6Oc4GJXW+jm91F991HGrKitGnIjkTKf0vnb2CJh1w2XQ8LdzDI7KLzoSGvlnxOOIZGVe4eJ6C/2eHSXieovbNoE92fcRjv7vNlg81ls/mGKAzg6jI8s/afDGrr1YUqXK5Rx2xldNfWYRRFcy3MZ/+jqz7XvhSWGCalx9KQFBIlF33HIZsGpYrw9RHCFz8g/HUX0eefIfplGz49sxZptUwbhxKiT9kW0MceBswoXBd7wdRFaCgI60WEpTSCVz/Dz57AJ1SWlSwfWaTxtDFbLYwokgYUYXa5jAklhjuZzEXhyzWZwvVpbsMILBKafQdCpU5G5iKJVtKmryoY5/MYCgJ8wmeUAZkt6VZpA5ZAEQ9bQZCIyOGFCFZGFtObDViZNCwhB7t4yc+WKGA86GNCGTkhwgm9YLIgZkTliox6o8mJ3JXnTLGBqmIsinzYbqOOMe0rXr/Hq705n0EY8krKtL+0FXW+bjf+E9Mbc8JBLgunViNCAQ7FPadbefMVISteqVzlhIz2ZkJJwpCG6ZIhI+TV3pw/RsjmkA5m1mi2rq8IRmjQTuaQoV0uwcpmiE5em7dNQjZvakdDJieiVKEvx5tuENJuxwgZ3Yh2NZeK9CFCJvbtdnUDWapyrd7kVV4jNInQpqI4NXk5H8v1d4PY7qjTQs4XiqjKNd5eff4vE5Ka/A6hyHoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Screenshot of Chrome DevTools > Elements > Computed\"\n        title=\"\"\n        src=\"/static/2f6b9b41cfadb16613696e96a940262e/b9e4f/2019-12-04-computed-style.png\"\n        srcset=\"/static/2f6b9b41cfadb16613696e96a940262e/cf440/2019-12-04-computed-style.png 148w,\n/static/2f6b9b41cfadb16613696e96a940262e/d2d38/2019-12-04-computed-style.png 295w,\n/static/2f6b9b41cfadb16613696e96a940262e/b9e4f/2019-12-04-computed-style.png 590w,\n/static/2f6b9b41cfadb16613696e96a940262e/cb0d3/2019-12-04-computed-style.png 646w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p></section>\n<section><h2>Rendered Fonts</h2><p>ä½¿ç”¨ <code class=\"language-text\">getComputedStyle</code> åªèƒ½å¾—åˆ°å®é™…ä½¿ç”¨çš„ CSS å±æ€§å€¼ï¼Œæœ‰æ—¶å€™å¹¶ä¸èƒ½å‡†ç¡®è¡¨è¾¾å®é™…çœŸå®ä½¿ç”¨çš„å…·ä½“å­—ä½“ç±»å‹ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œä¸€ä¸ª <code class=\"language-text\">font-family</code> å®šä¹‰å¯èƒ½æ˜¯ï¼š</p><div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span>\n    <span class=\"token string\">'Rubik'</span><span class=\"token punctuation\">,</span>\n    -apple-system<span class=\"token punctuation\">,</span> <span class=\"token string\">'system-ui'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'BlinkMacSystemFont'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PingFang SC'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Segoe UI'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Roboto'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Oxygen'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Ubuntu'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Cantarell'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Fira Sans'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Droid Sans'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Helvetica Neue'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Helvetica'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Arial'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Hiragino Sans GB'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Microsoft Yahei'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'WenQuanYi Micro Hei'</span><span class=\"token punctuation\">,</span> sans-serifï¼›\n<span class=\"token punctuation\">}</span></code></pre></div><p>åœ¨å¦‚æ­¤ä¼—å¤šçš„å®šä¹‰ä¸­ï¼Œå…·ä½“æµè§ˆå™¨ä½¿ç”¨äº†å“ªä¸€æ¬¾å­—ä½“ï¼Œå¹¶ä¸å®¹æ˜“çŸ¥é“ã€‚è¿™å…¶ä¸­æ¶‰åŠåˆ°äº†å¤§é‡çš„å˜é‡ã€‚ç”¨æˆ·ä½¿ç”¨çš„ç³»ç»Ÿç¯å¢ƒã€å­—ä½“ä¸‹è½½æƒ…å†µã€æ­£åœ¨é˜…è¯»çš„æ–‡å­—æ˜¯ä¸­æ–‡è¿˜æ˜¯è‹±æ–‡ç­‰ï¼Œè¿™äº›éƒ½æœ‰å¯èƒ½å½±å“åˆ°æœ€ç»ˆæµè§ˆå™¨æ‰€é€‰ç”¨çš„å­—ä½“ã€‚ç”šè‡³åœ¨ä¸å¤æ‚çš„ <code class=\"language-text\">font-family</code> è®¾ç½®ä¸‹ï¼Œæœ€ç»ˆçš„é€‰ç”¨å­—ä½“ä¾ç„¶å¯èƒ½å¹¶ä¸ç›´è§‚ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœè®¾ç½® CSS ä¸ºï¼š<code class=\"language-text\">font-family: system-ui</code>ï¼Œå…·ä½“ä½¿ç”¨çš„å­—ä½“å¹¶æ²¡æœ‰ä»è®¾ç½®çš„å­—æ®µä¸­ç›´è§‚çš„åé¦ˆå‡ºæ¥ã€‚</p><p>Chrome DevTools æä¾›äº†ä¸€ä¸ª Rendered Fonts åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…äº†è§£å½“å‰çœŸå®ä½¿ç”¨çš„å­—ä½“ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc6b98d142218bfc4e588ffbe34ab2d0/26dcc/2019-12-04-rendered-fonts.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 538px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 187.36059479553904%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAlCAYAAABCr8kFAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFB0lEQVRIx51WyW4bRxCdjw5yygfkB5KD7zkFCAIYQbwFgeEttixS3HeJ5HAdchbOvvLlVZMjUbJkC27goXt6ZqpreVXVWhAE2Gw26PV6GI1GGA6H0HUdnh9gZjj4XO/hvN5HpdHHYLyC4/pYr1YIwxDyr+d52O12sCxLydGWyyUGgwEmk4l6sd0YuLocot/voUohnaGO+cZFpTnEh/M2qvUWut0uqtUqarUarq6ulKDFYqGEa9vtVmk36PdhmhauZgZqrQEq9S7RRrM7xMa00e92UK9dUFgHrVZLCRSMx2Ol3Ypa+74PLc9zlCPNcpgB4EQH7GLAljks8NAoigJZll3Pmmzu93tCrbAvMs65Whd5gjyLOadI0+QWkkSQqn9Ph3YQdtiUE1zXw2K1wehqBj/kT+keYZwjIuK0QJwckGYFgxJSeIobpfY3GsoQ813XRaf+Bp/fP8V08B/MRQ3bWRXm/AIW1/JsLWswZnX4DEKaZTiVcUug+MG2LTjT59Dbf6BX+R3R6iUK818k65dIN6+QGv8g5+zpTxlEg0oUDwvMRaBlwtFfIfaXGF1ekgFdzGa68qP4MxP/RQ682QtY5gbZ1wQWxZ4UOAiMfAMrw8RkqqM/GMFxdjBJDz+IKNA7CvyGhiJwu93AHL9A6K4YkAxbc0vyjrE2eMB6Ta4FCDybbnnGJFg9wmT60J6+Qp44KsLCzYwRTdJyZoSTEO7s5eNNdvVn2NtvkFsfUNgfkJrvkJnvkXOtYL1FMP/r2yYfaLODMT2DM38He0ZwtvS3CuqZkHfG5D1z36HW+W2Bd4kdhpEyL4i4FsQZCZ4iIGQdHvfjhGSPoq8TW+YojhETScI5KdfJzd7JHFKgcPcLDcsNeVme9BjcNzQpkpZpImLBFB+K2QK1Vs/59b7MYqJAtJYia9ukkOOolBVoATcnrNA+1T+q+mCpuquVPM/nM2bSTNVDg1zVRGrIhT+dIuBJEUuSaCsOP4VYIi5pt9t4/fo1ib7BJQlv2w7Jb1LgmpSzoRlkv91swm2werD6xqy6ydGkU0gQZEi1/vvZc3S6fZWWko4GW4BkkgjXXPYRj/0jYAvwW01E1DSnQIFoJH4rISa6no/Fco2pPlN7KsongdWkg1ntFmz2ix2ri/nxI6xKBTtqGx5NLRHHkTKt0WxTwx5anS4Lx1AV5fIbRZuc2ZFRdcGpw++jSRwnLBKG4ut932oBfebQ0Q59s2P3c6Wdsk0GrMaioVCj7MHiS302R6PVVi2z3C+/EWgZfeV3OtidfYLXaChfevUaYgYr54klL7NjqZ/Pl8rkIs9v8baEllB1f0Q/NBvwhwNWkTmCxRwhfZsKkZPkmsgSgDUPavaGvFn41yQ/hSacC8ijgA0/pBkxT4n4QuGEj2J+HAbYRTHmrRqW0wn34i/4eqg2pXPvOPh2Rz9eCFYT4O2fN1l1ty/jUeP4U+gBv/0MRMGDX2oWk1vYLrMwXa2ZQnJxKqMoDT0MfGS//ICw9g4iLjhG+S60erOFT2fn+Fyp4rxygWa7g8pFDbV6U1Vvhwfs2EeSX39E/OQn2BTmsHE5PFCqjKUUuIEmoV6S/XNexwTS2URbOU0iqa541NhsVeCy38heeSf074m0un1VLuoqjc7Oq7igZv3hSHFMTB9djjEYXmKoL7DZmtiwCMxJLYFJdnzhw/1X6t+jwnUnPbXvLf8PtQHte4Q8BFHqf1USFQCODxGiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Screenshot of Chrome DevTools > Elements > Computed > Rendered Fonts\"\n        title=\"\"\n        src=\"/static/dc6b98d142218bfc4e588ffbe34ab2d0/26dcc/2019-12-04-rendered-fonts.png\"\n        srcset=\"/static/dc6b98d142218bfc4e588ffbe34ab2d0/cf440/2019-12-04-rendered-fonts.png 148w,\n/static/dc6b98d142218bfc4e588ffbe34ab2d0/d2d38/2019-12-04-rendered-fonts.png 295w,\n/static/dc6b98d142218bfc4e588ffbe34ab2d0/26dcc/2019-12-04-rendered-fonts.png 538w\"\n        sizes=\"(max-width: 538px) 100vw, 538px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p><p>Chrome ä¼šå°†å½“å‰é€‰ä¸­å…ƒç´ çœŸå®ä½¿ç”¨çš„æ‰€æœ‰å­—ä½“éƒ½åˆ—å‡ºæ¥ã€‚éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š</p><ol>\n<li>éœ€è¦é€‰ä¸­ä¸€ä¸ªæœ‰æ–‡å­—å†…å®¹çš„å…ƒç´ ï¼Œä¸ç„¶è¿™é‡Œå¹¶ä¸ä¼šæ˜¾ç¤ºï¼›</li>\n<li>\n<p>é€‰ä¸­çš„æ–‡å­—å†…å®¹å¯èƒ½éœ€è¦å¤šç§å­—ä½“ç±»å‹å…±åŒé…åˆæ¸²æŸ“ï¼ŒChrome ä¼šè®²æ‰€æœ‰ç”¨åˆ°çš„å…ƒç´ éƒ½åˆ—ä¸¾å‡ºæ¥ã€‚</p>\n<p>æ¯”å¦‚ï¼Œ<code class=\"language-text\">ç¬‘ï¼ŒğŸ˜Šï¼Œsmile</code> è¿™æ ·ä¸€æ®µæ–‡å­—ï¼Œåœ¨ MacOS Chrome ä¸‹ï¼Œé»˜è®¤å°±éœ€è¦ä»¥ä¸‹ä¸‰ç§å­—ä½“æ¥è¿›è¡Œæ¸²æŸ“ï¼š</p>\n<ul>\n<li>Timesï¼ˆæ¸²æŸ“è‹±æ–‡ï¼‰</li>\n<li>Songti SCï¼ˆæ¸²æŸ“ä¸­æ–‡ï¼‰</li>\n<li>Apple Color Emojiï¼ˆæ¸²æŸ“ emojiï¼‰</li>\n</ul>\n<p>ä»¥ä¸Šä¸‰ç§å­—ä½“åœ¨ Rendered Fonts ä¸­éƒ½ä¼šè¢«åˆ—ä¸¾å‡ºæ¥ã€‚</p>\n</li>\n</ol><p>Chrome çš„ Blog ä»‹ç»å¯ä»¥æŸ¥çœ‹<a href=\"https://developers.google.com/web/updates/2013/09/DevTools-answers-What-font-is-that\">è¿™é‡Œ</a>ã€‚</p><p>è¿™ä¸€æ–¹æ¡ˆæš‚æ—¶æ²¡æœ‰ JavaScript API å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œæ— æ³•åœ¨ç¨‹åºè¿è¡Œæ—¶è¿›è¡Œè‡ªåŠ¨çš„åˆ¤æ–­ã€‚</p></section>","frontmatter":{"date":"2019-12-04","title":"Rendered Fonts","category":"Chrome"}}},{"node":{"id":"ddf203aa-1bf8-5e71-9ad4-a9dbe9bd9530","html":"<p>åœ¨ JavaScript ä¸­ï¼Œç›´æ¥å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼ˆObjectï¼‰ï¼Œæ€§èƒ½ä¸Šè¿œä¸å¦‚å®šä¹‰ä¸€ä¸ª <code class=\"language-text\">JSON.parse()</code> çš„è¡¨è¾¾å¼ã€‚å…·ä½“æ¥è¯´ï¼Œä¸‹é¢çš„ä¸¤è¡Œï¼Œ<code class=\"language-text\">JSON.parse</code> çš„è¡¨è¾¾å¼ä¼šæœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> slow <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> foo<span class=\"token punctuation\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> bar<span class=\"token punctuation\">:</span> <span class=\"token number\">1337</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> fast <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{\"foo\":42,\"bar\":1337}'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åŒæ ·çš„æ•ˆæœï¼Œä½†æ˜¯åœ¨ JavaScript å¼•æ“ä¸­çš„è¡¨ç°å´å·®åˆ«å¾ˆå¤§ã€‚æ ¹æ®<a href=\"https://github.com/GoogleChromeLabs/json-parse-benchmark\">è¿™é‡Œ</a>ç»™å‡ºçš„æµ‹è¯•æ•°æ®ï¼Œ<code class=\"language-text\">JSON.parse</code> çš„é€Ÿåº¦æ˜¯ç›´æ¥å†™å¯¹è±¡é€Ÿåº¦çš„ 1.7 å€ã€‚è€Œä¸”è¿™ä¸ä»…ä»…åªæ˜¯ V8 è¡¨ç°ä¸Šçš„ä¸åŒï¼Œåœ¨å„ç±» JavaScript å¼•æ“ä¸Šéƒ½æœ‰ç±»ä¼¼çš„è¡¨ç°ï¼Œæ€§èƒ½å·®å¼‚å‡éå¸¸æ˜æ˜¾ï¼ˆ<a href=\"https://developer.apple.com/documentation/javascriptcore\">JavaScriptCore</a> çš„æ€§èƒ½å·®å¼‚å¯ä»¥åˆ°ä¸¤å€ï¼‰ã€‚</p>\n<p>è¿™é‡Œå·®å¼‚çš„ä¸»è¦åŸå› åœ¨äºï¼Œå¼•æ“åœ¨è§£ææ—¶å€™ç®—æ³•å¤æ‚åº¦æœ‰ç€å·¨å¤§çš„å·®å¼‚ã€‚ç®€å•æ¥è¯´ï¼ŒJSON çš„æ•°æ®ç»“æ„æ˜¯éå¸¸ç®€å•ä¸”å›ºå®šçš„ï¼Œå› è€Œåœ¨è§£æçš„æ—¶å€™å¯ä»¥æœ‰æ›´å¥½çš„è¡¨ç°ã€‚è¿™ç§ç®€å•ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>\n<ol>\n<li>JSON çš„æ•°æ®æ”¯æŒç±»å‹ä¸å¤šï¼Œåªæœ‰å­—ç¬¦ä¸²ï¼Œæ•°ç»„ï¼Œæ•°å­—ï¼ŒNULLï¼Œå¯¹è±¡è¿™å‡ ç§ï¼›ç›¸æ¯”ä¹‹ä¸‹ï¼ŒJavaScript ä¸­ä¸€ä¸ªå¯¹è±¡çš„æ”¯æŒç±»å‹éå¸¸çš„å¤æ‚ï¼Œæƒ…å†µæ›´å¤šï¼›</li>\n<li>ä»æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰çš„è§’åº¦çœ‹ï¼Œ<code class=\"language-text\">JSON.parse</code> çš„æƒ…å†µæ¯”å•çº¯å†™ä¸€ä¸ª JavaScript å¯¹è±¡è¦ç®€å•çš„å¤šã€‚å¯¹äºå‰è€…æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ª CallExpression å’Œä¸€ä¸ª StringLiteralï¼›è€Œå¯¹äºä¸€ä¸ª JavaScript å¯¹è±¡æ¥è¯´ï¼Œæ¶‰åŠåˆ°å¤§é‡çš„ ObjectExpressionï¼Œå½“ä¸­å¯èƒ½è¿˜åŒ…å« StringLiteralï¼ŒNumericLiteralï¼ŒIdentifier ç­‰ç­‰ï¼›</li>\n<li>JSON çš„è§£ææ˜¯ä¸Šä¸‹æ–‡æ— å…³çš„ï¼›è€Œ JavaScript å¯¹è±¡çš„è§£æå´éœ€è¦ç»“åˆå½“å‰çš„ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰æ¥ç¡®å®šï¼›</li>\n</ol>\n<p>ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼šå‡è®¾æœ‰è¿™æ ·ä¸€ä¸ª JavaScript ä»£ç ç‰‡æ®µï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> x <span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™é‡Œçš„ <code class=\"language-text\">x</code> ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Œå…¶å®æœ‰éå¸¸å¤šçš„å¯èƒ½æ€§ï¼Œæ¯”å¦‚ï¼š</p>\n<ul>\n<li><code class=\"language-text\">const y = ({ x })</code>ï¼Œæ­¤æ—¶ <code class=\"language-text\">x</code> çš„å€¼å’Œä¸Šä¸‹æ–‡ä¸­çš„ <code class=\"language-text\">x</code> å˜é‡æ˜¯ç›¸å…³çš„ï¼Œå®šä¹‰æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼›</li>\n<li><code class=\"language-text\">const y = ({ x } = { x: 2 })</code>ï¼Œæ­¤æ—¶ <code class=\"language-text\">x</code> å’Œä¸Šä¸‹æ–‡æ˜¯ç›¸å…³çš„ï¼Œä½†å®šä¹‰çš„æ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼Œè€Œä¸æ˜¯å¯¹è±¡ï¼ˆæ ¹æ®è¯­æ³•ï¼Œå¯¹ <code class=\"language-text\">const</code> äºŒæ¬¡èµ‹å€¼å¯¼è‡´è¯­æ³•é”™è¯¯ï¼‰ï¼›</li>\n<li><code class=\"language-text\">const y = ({ x }) =&gt; x;</code>ï¼Œæ­¤æ—¶ <code class=\"language-text\">x</code> çš„å€¼å’Œä¸Šé¢çš„ <code class=\"language-text\">x</code> æ— å…³ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ï¼›</li>\n</ul>\n<p>æ¢å¥è¯è¯´ï¼Œå½“ JavaScript å¼•æ“åœ¨è§£æä¸€ä¸ª JavaScript å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘å¾ˆå¤šçš„å¯èƒ½æ€§ï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­å¾ˆå¯èƒ½æ— æ³•ç¡®å®šå½“å‰çš„ç±»å‹ï¼Œç”šè‡³è¿è¯­æ³•æ˜¯å¦æ­£ç¡®ä¹Ÿä¸èƒ½ç¡®å®šã€‚ä½†åè§‚ JSONï¼Œå®šä¹‰å°±ç®€å•çš„å¤šï¼Œåœ¨è§£æçš„å½“ä¸‹ï¼Œå¼•æ“å°±å¯ä»¥å¾ˆæ¸…æ¥šçš„çŸ¥é“å½“å‰çš„å†…å®¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œäº¦æˆ–æ˜¯æœ‰è¯­æ³•é”™è¯¯ã€‚</p>\n<p>é™¤äº†ä¸Šè¿°æåˆ°çš„æ€§èƒ½æ¯”è¾ƒæ•°æ®ä¹‹å¤–ï¼Œ<a href=\"https://joreteg.com/blog/improving-redux-state-transfer-performance\">è¿™é‡Œ</a>è¿˜æœ‰ä¸€ä»½é’ˆå¯¹ Redux åº”ç”¨çš„ä¼˜åŒ–åˆ†æã€‚æ•°æ®æ˜¾ç¤ºï¼Œä½¿ç”¨ <code class=\"language-text\">JSON.parse</code> è°ƒç”¨ä¹‹å TTI (Time To Interactive) æ—¶é—´ç¼©çŸ­äº† 0.74s (18%)ã€‚è€ƒè™‘åˆ°æ•´ä¸ªæ”¹åŠ¨æ˜¯éå¸¸â€œç®€å•â€çš„ï¼Œè¿™ä¸€æ€§èƒ½æå‡æ˜¾å¾—éå¸¸å®¢è§‚ã€‚</p>\n<p>è¿™é‡Œä¹‹æ‰€ä»¥è¯´æ”¹åŠ¨æ˜¯éå¸¸â€œç®€å•â€çš„ï¼Œæ˜¯å› ä¸ºæ•´ä¸ªä¼˜åŒ–æ€è·¯éå¸¸çš„æ˜ç¡®ï¼Œå®Œå…¨å¯ä»¥é€šè¿‡å¯¹åº”çš„å·¥å…·åœ¨ç¼–è¯‘æ—¶å®Œæˆã€‚ç›®å‰å¼€æºç¤¾åŒºå·²ç»æä¾›äº†å„ç±»ç›¸å…³çš„å·¥å…·ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œåˆ—ä¸¾ä¸€äº›å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>Webpackï¼ˆ<a href=\"https://github.com/webpack/webpack/releases/tag/v4.35.3\">v4.35.3</a> æˆ–ä»¥ä¸Šï¼‰é»˜è®¤ä¼šå°† JSON æ‰“åŒ…æˆ <code class=\"language-text\">JSON.parse()</code>ï¼›ä½¿ç”¨ <code class=\"language-text\">json-loader</code> å¯ä»¥å»æ‰è¿™ä¸€ä¼˜åŒ–ï¼ˆå…·ä½“è§è¿™ä¸ª <a href=\"https://github.com/webpack/webpack/pull/9349\">Pull Request</a>ï¼‰ï¼›</li>\n<li>ä¸€äº› Babel Plugin æ”¯æŒå°†æ»¡è¶³è¦æ±‚çš„ JavaScript å¯¹è±¡è½¬åŒ–æˆ <code class=\"language-text\">JSON.parse</code> è¯­æ³•ï¼Œæ¯”å¦‚ <a href=\"https://github.com/nd-02110114/babel-plugin-object-to-json-parse\">babel-plugin-object-to-json-parse</a> æˆ– <a href=\"https://github.com/keyz/babel-plugin-transform-optimize-object-literal\">babel-plugin-transform-optimize-object-literal</a>ã€‚</li>\n</ul>","frontmatter":{"date":"2019-12-03","title":"Cost of parsing JSON","category":"JavaScript"}}},{"node":{"id":"1f47e54e-3226-5831-b830-c394c36ddda6","html":"<p>Node.js çš„ Docker æœ‰åŸºäº Alpine çš„ç‰ˆæœ¬ã€‚åœ¨è¿™ä¸ª Docker ä¸­ä½¿ç”¨ <a href=\"https://github.com/develar/7zip-bin\">7zip-bin</a> åº“çš„æ—¶å€™é‡åˆ°äº†é”™è¯¯ï¼Œæ— æ³•æ­£å¸¸å¯åŠ¨ã€‚</p>\n<p>ä¸€ä¸ªç®€å•çš„é‡ç° <code class=\"language-text\">Dockerfile</code> å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> node<span class=\"token punctuation\">:</span>10<span class=\"token punctuation\">-</span>alpine\n\n<span class=\"token keyword\">RUN</span> mkdir <span class=\"token punctuation\">-</span>p example &amp;&amp; \\\n  cd example &amp;&amp; \\\n  yarn init <span class=\"token punctuation\">-</span>y &amp;&amp; \\\n  yarn add 7zip<span class=\"token punctuation\">-</span>bin &amp;&amp; \\\n  mkdir /lib64 &amp;&amp; \\\n  ln <span class=\"token punctuation\">-</span>s /lib/libc.musl<span class=\"token punctuation\">-</span>x86_64.so.1 /lib64/ld<span class=\"token punctuation\">-</span>linux<span class=\"token punctuation\">-</span>x86<span class=\"token punctuation\">-</span>64.so.2\n\n<span class=\"token keyword\">ADD</span> run.sh /run.sh\n\n<span class=\"token keyword\">RUN</span> chmod +x /run.sh\n\n<span class=\"token keyword\">CMD</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/run.sh\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">run.sh</code> å¯ä»¥å†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> example\n<span class=\"token variable\"><span class=\"token variable\">$(</span>node -e \"console.log<span class=\"token punctuation\">(</span>require<span class=\"token punctuation\">(</span><span class=\"token string\">'7zip-bin'</span><span class=\"token punctuation\">)</span>.path7za<span class=\"token variable\">)</span></span>\"<span class=\"token punctuation\">)</span></code></pre></div>\n<p>æŠ¥é”™çš„å†…å®¹æ˜¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">/run.sh: line 2: /example/node_modules/7zip-bin/linux/x64/7za: not found</code></pre></div>\n<p>é€šè¿‡è¿›å…¥ Docker å†…éƒ¨è§‚å¯Ÿä¸éš¾å‘ç°ï¼Œ<code class=\"language-text\">/example/node_modules/7zip-bin/linux/x64/7za</code> è¿™ä¸ªæ–‡ä»¶å®é™…æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨çš„æ—¶å€™ç³»ç»Ÿå´æŠ¥é”™ <code class=\"language-text\">not found</code>ã€‚é€ æˆè¿™ä¸€é—®é¢˜çš„åŸå› ï¼Œå¯èƒ½æ˜¯åŠ¨æ€åº“ç¼ºå¤±ã€‚</p>\n<p>é€šè¿‡ <code class=\"language-text\">ldd</code> å‘½ä»¤å¯ä»¥åˆ—å‡ºåŠ¨æ€åº“ä¾èµ–å…³ç³»ï¼ˆ<a href=\"https://linux.die.net/man/1/ldd\">æ–‡æ¡£</a>ï¼‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ldd /example/node_modules/7zip-bin/linux/x64/7za</code></pre></div>\n<p>è¾“å‡ºç»“æœæ˜¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">/lib64/ld-linux-x86-64.so.2 (0x7febe540e000)\nlibpthread.so.0 =&gt; /lib64/ld-linux-x86-64.so.2 (0x7febe540e000)\nlibstdc++.so.6 =&gt; /usr/lib/libstdc++.so.6 (0x7febe52b9000)\nlibm.so.6 =&gt; /lib64/ld-linux-x86-64.so.2 (0x7febe540e000)\nlibgcc_s.so.1 =&gt; /usr/lib/libgcc_s.so.1 (0x7febe52a5000)\nlibc.so.6 =&gt; /lib64/ld-linux-x86-64.so.2 (0x7febe540e000)</code></pre></div>\n<p>æ³¨æ„åˆ°ç¼ºå°‘äº† <code class=\"language-text\">/lib64/ld-linux-x86-64.so.2</code> è¿™ä¸ªåŠ¨æ€åº“ï¼Œå› æ­¤å¯¼è‡´äº† <code class=\"language-text\">7zip-bin</code> è¿™ä¸ªåº“æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚é€ æˆè¿™ä¸ªçš„åŸå› æ˜¯ï¼ŒAlpine ä½¿ç”¨çš„æ˜¯ <a href=\"https://www.musl-libc.org/\">musl</a>ï¼Œè€Œ <code class=\"language-text\">7zip-bin</code> ä½¿ç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯åŸºäº glibc ç¼–è¯‘å‡ºæ¥çš„ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸¤ç§æ€è·¯ï¼š</p>\n<ol>\n<li>åœ¨ Alpine ä¸­å®‰è£… libc çš„å…¼å®¹åº“ï¼š<code class=\"language-text\">RUN apk add --no-cache libc6-compat</code>ï¼›</li>\n<li>æˆ–è€…ï¼Œ<code class=\"language-text\">ln -s /lib/libc.musl-x86_64.so.1 /lib/ld-linux-x86-64.so.2</code> å°† musl çš„ç‰ˆæœ¬è½¯è¿è¿‡å»ï¼Œç›´æ¥è®© <code class=\"language-text\">7zip-bin</code> çš„äºŒè¿›åˆ¶ä½¿ç”¨</li>\n</ol>\n<p>å½“ç„¶ï¼Œæœ€ä½³çš„æ–¹æ¡ˆæ˜¯ä¸ä½¿ç”¨ <code class=\"language-text\">7zip-bin</code> ä¸­çš„ pre-build ç‰ˆæœ¬ï¼Œè€Œæ”¹ç”¨ Alpine çš„ <a href=\"https://pkgs.alpinelinux.org/package/edge/main/x86/p7zip\">p7zip</a> ç‰ˆæœ¬ã€‚ç”¨ Alpine çš„åŒ…ç®¡ç†å™¨å®‰è£…å¥½ <code class=\"language-text\">pz7ip</code> ä¹‹åï¼ˆ<code class=\"language-text\">apk add p7zip</code>ï¼‰ï¼Œä½¿ç”¨ç±»ä¼¼ä¸‹é¢çš„ä»£ç ç›´æ¥æ›¿æ¢è„šæœ¬å°±å¥½äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cp</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">type</span> -p 7za<span class=\"token variable\">)</span></span> <span class=\"token variable\"><span class=\"token variable\">$(</span>node -p <span class=\"token string\">\"require('7zip-bin').path7za\"</span><span class=\"token variable\">)</span></span></code></pre></div>\n<section><h2>å‚è€ƒé“¾æ¥</h2><ul>\n<li>åœ¨ 7zip-bin issue ä¸­çš„<a href=\"https://github.com/develar/7zip-bin/issues/8\">ç›¸å…³è®¨è®º</a></li>\n<li>é‡ç°çš„é…ç½®ä»£ç  <a href=\"https://gist.github.com/laysent/b12faceac4bcf10bee04aabfa505c244\">gist</a></li>\n<li>node-gyp åœ¨ Alpine ä¸­ä¹Ÿå¯èƒ½ä¼šé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œåœ¨<a href=\"https://medium.com/devgorilla/node-gyp-support-in-alpine-linux-9374c6191140\">è¿™é‡Œ</a>å¯ä»¥æ‰¾åˆ°ç›¸å…³çš„è®¨è®º</li>\n</ul></section>","frontmatter":{"date":"2019-12-02","title":"7zip-bin in Alpine Docker","category":"Docker"}}},{"node":{"id":"fd022b7a-07a5-588c-83eb-4dc5e5ec807c","html":"<p><code class=\"language-text\">arguments.callee</code> æ˜¯ä¸€ä¸ªä¸åº”è¯¥è¢«ä½¿ç”¨çš„ APIï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä½¿ç”¨ä¼šç›´æ¥æŠ¥é”™ã€‚è¿™é‡Œä»…ä»…æ˜¯ä½œä¸ºäº†è§£ï¼Œè®°å½•ä¸€ä¸‹è¯¥ API çš„ä½œç”¨ã€‚</p>\n<p>åœ¨æ—©æœŸçš„ JavaScript ç‰ˆæœ¬ä¸­ï¼Œä¸å…è®¸å†™å¸¦åå­—çš„å‡½æ•°è¡¨è¾¾å¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦åšé€’å½’è°ƒç”¨ï¼Œå°±æ— æ³•æ˜¾å¼å¾—æŒ‡æ˜éœ€è¦è°ƒç”¨çš„å‡½æ•°åç§°ã€‚<code class=\"language-text\">arguments.callee</code> è¿™ä¸ªå€¼ï¼ŒæŒ‡å‘äº†å½“å‰è¢«è°ƒç”¨çš„å‡½æ•°æœ¬èº«ï¼Œå› æ­¤å¯ä»¥åœ¨åŒ¿åå‡½æ•°é€’å½’è°ƒç”¨ä¸­è¢«ä½¿ç”¨ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨æ—©æœŸçš„ JavaScript ä¸­ï¼Œ<code class=\"language-text\">Array.prototype.map</code> å‡½æ•°ç»™å®šçš„å›è°ƒå‡½æ•°åªèƒ½æ˜¯åŒ¿åçš„ï¼Œå¦‚æœè¦å®ç°ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œåªèƒ½è¿™ä¹ˆå†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> arguments<span class=\"token punctuation\">.</span><span class=\"token function\">callee</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> num<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç„¶è€Œï¼Œ<code class=\"language-text\">arguments.callee</code> çš„è°ƒç”¨ä¼šå¯¼è‡´ <code class=\"language-text\">this</code> çš„æŒ‡å‘å‡ºç°é—®é¢˜ï¼ˆå…·ä½“è§ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee\">MDN</a>ï¼‰ï¼Œä½¿ç”¨èµ·æ¥æ¯”è¾ƒå±é™©ã€‚</p>\n<p>åœ¨ ECMAScript 3 ä¸­å·²ç»æ”¯æŒäº†å¸¦å‡½æ•°åçš„è¡¨è¾¾å¼ï¼Œå› æ­¤ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€å•çš„æ”¹å†™ä¸ºä¸€ä¸‹è¿™ç§æ­£å¸¸çš„å†™æ³•ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">factorial</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">factorial</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> num<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ¢å¥è¯è¯´ï¼Œåªéœ€è¦ç»™å‡½æ•°æŒ‡å®šåç§°ï¼Œå°±å¯ä»¥è§„é¿ç»å¤§å¤šæ•°çš„ <code class=\"language-text\">arguments.callee</code> ä½¿ç”¨äº†ï¼ˆæ³¨ï¼šåŒ¿åå‡½æ•°/ç®­å¤´å‡½æ•°æ— æ³•æŒ‡å®šåç§°ï¼Œä½†åŒæ—¶è§„èŒƒä¹Ÿæ˜ç¡®äº†åŒ¿åå‡½æ•°ä¸­æ²¡æœ‰ <code class=\"language-text\">arguments</code>ï¼‰ã€‚</p>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee\">MDN</a> ç»™å‡ºäº†ä¸€ä¸ª <code class=\"language-text\">arguments.callee</code> æ— æ³•æ›¿æ¢çš„åœºæ™¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">createPerson</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sIdentity</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> oPerson <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Function</span><span class=\"token punctuation\">(</span><span class=\"token string\">'alert(arguments.callee.identity);'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oPerson<span class=\"token punctuation\">.</span>identity <span class=\"token operator\">=</span> sIdentity<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> oPerson<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> john <span class=\"token operator\">=</span> <span class=\"token function\">createPerson</span><span class=\"token punctuation\">(</span><span class=\"token string\">'John Smith'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">john</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œçš„å‡½æ•° <code class=\"language-text\">oPerson</code> æ˜¯é€šè¿‡ <code class=\"language-text\">new Function</code> åˆ›å»ºçš„ã€‚åœ¨å­—ç¬¦ä¸²å†…æ— æ³•â€œå¾—çŸ¥â€å‡½æ•°ä¼šè¢«èµ‹å€¼çš„åç§°ï¼Œå› æ­¤åªèƒ½é€šè¿‡ <code class=\"language-text\">arguments.callee</code> å»è·å–ã€‚åœ¨æŸäº›éå¸¸ç‰¹æ®Šçš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¯èƒ½ä¼šæœ‰éœ€æ±‚å°†æŸäº›è¡¨è¾¾å¼é€šè¿‡å­—ç¬¦ä¸²è¿›è¡Œå­˜å‚¨ï¼Œå¹¶é€šè¿‡ <code class=\"language-text\">new Function</code> æ„å»ºæ‰§è¡Œã€‚è¿™ç§æ—¶å€™ï¼Œä½¿ç”¨ <code class=\"language-text\">arguments.callee</code> è·å–æ•°æ®ç±»ä¼¼äºä¼ å‚ã€‚å½“ç„¶ï¼Œå¦‚æœåªæ˜¯ä¼ å‚çš„éœ€æ±‚ï¼Œå…¶å®å¯ä»¥å†™æˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> script <span class=\"token operator\">=</span> <span class=\"token string\">'alert(arg.identity)'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createPerson</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">identity</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> closure <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'const arg = arguments[0];'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">return function () { </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>script<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> }</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">closure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> identity <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> john <span class=\"token operator\">=</span> <span class=\"token function\">createPerson</span><span class=\"token punctuation\">(</span><span class=\"token string\">'John Smith'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">john</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"date":"2019-12-01","title":"arguments.callee","category":"JavaScript"}}},{"node":{"id":"c366bb01-a2f9-54c4-ac76-8013cd32b800","html":"<p>åœ¨ä½¿ç”¨äº† <a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin\">mini-css-extract-plugin</a> çš„é¡¹ç›®ä¸­ï¼Œæœ‰æ—¶ä¼šé‡åˆ°å¦‚ä¸‹çš„ Warning è¾“å‡ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">WARNING in chunk styles [mini-css-extract-plugin]\nConflicting order between:\n* css xxx/css-loader/dist/cjs.js!./e1.css\n* css xxx/css-loader/dist/cjs.js!./e2.css\n* css xxx/css-loader/dist/cjs.js!./e3.css</code></pre></div>\n<section><h2>tl;dr</h2><p>ä¸Šé¢è¿™æ®µ Warning çš„å®é™…å«ä¹‰æ˜¯ï¼š</p><blockquote>\n<p>ç”±äºæ²¡æ³•æ‰¾åˆ°æœ€åˆé€‚çš„è§£ï¼Œplugin è¢«è¿«ä½¿ç”¨äº†ç›¸å¯¹æœ€ä¼˜çš„è§£ï¼Œå°† <code class=\"language-text\">e1.css</code> æ”¾åˆ°äº†ç¼–è¯‘äº§ç‰©ä¸­ã€‚åœ¨æŸäº› chunk group ä¸­ï¼Œ<code class=\"language-text\">e2.css</code> æˆ– <code class=\"language-text\">e3.css</code> è¿™ä¸¤ä¸ªæ–‡ä»¶å¼•ç”¨ä½ç½®åœ¨ <code class=\"language-text\">e1.css</code> ä¹‹å‰ï¼›è€Œåœ¨ plugin å°† <code class=\"language-text\">e1.css</code> åŠ å…¥ç¼–è¯‘äº§ç‰©çš„æ—¶å€™ï¼Œ<code class=\"language-text\">e2.css</code> å’Œ <code class=\"language-text\">e3.css</code> è¿˜æ²¡æœ‰è¢«æ·»åŠ ã€‚</p>\n</blockquote><p>æ¢å¥è¯è¯´ï¼Œå¦‚æœ <code class=\"language-text\">e1.css</code> æœ¬æ¥çš„ç”¨é€”æ˜¯è¦†ç›– <code class=\"language-text\">e2.css</code> çš„å†…å®¹ï¼Œä¸”è¦†ç›–ä¾é çš„æ˜¯åŒä¼˜å…ˆçº§ä¸‹ CSS å®šä¹‰å‡ºç°çš„å…ˆåé¡ºåºï¼Œé‚£ä¹ˆåœ¨ plugin ç¼–è¯‘å®Œæˆä¹‹åï¼Œè¿™ä¸ªè¦†ç›–å°±ä¼šå¤±æ•ˆã€‚</p></section>\n<section><h2>é€ æˆ Warning çš„ä¾‹å­</h2><p>ä»¥ä¸‹é€šè¿‡ä¸€ä¸ªç›´è§‚çš„ä¾‹å­æ¥è¯´æ˜ plugin åœ¨ä½•æ—¶å¯èƒ½ä¼šè¾“å‡ºä¸Šè¿° Warningï¼š</p><p>å‡è®¾æœ‰ä¸¤ä¸ªæ–‡ä»¶ <code class=\"language-text\">entry1.js</code>ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">'./e1.css'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./e2.css'</span><span class=\"token punctuation\">;</span></code></pre></div><p><code class=\"language-text\">entry2.js</code>ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">'./e2.css'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token string\">'./e1.css'</span><span class=\"token punctuation\">;</span></code></pre></div><p>ä¸” Webpack é…ç½®äº†éœ€è¦å°† <code class=\"language-text\">e1.css</code> å’Œ <code class=\"language-text\">e2.css</code> æ‰“åŒ…åˆ°åŒä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚å¦‚æœ plugin é€‰æ‹©å°† <code class=\"language-text\">e1.css</code> æ”¾åœ¨ <code class=\"language-text\">e2.css</code> çš„å‰é¢ï¼Œé‚£ä¹ˆå°±ä¸æ»¡è¶³ <code class=\"language-text\">entry2.js</code> çš„ä½¿ç”¨é¡ºåºï¼›åä¹‹åˆ™ä¸æ»¡è¶³ <code class=\"language-text\">entry1.js</code> çš„ã€‚æ­£æ˜¯åœ¨è¿™æ ·çš„â€œçŸ›ç›¾â€æƒ…å†µä¸‹ï¼Œplugin è¾“å‡ºäº†ä¸€ä¸ª Warningï¼Œå¹¶é€‰æ‹©äº†ä¸€ä¸ªç›¸å¯¹æœ€ä¼˜çš„è§£ã€‚</p></section>\n<section><h2>æ›´å¥½çš„ Warning</h2><p>ä¸Šé¢æåˆ°çš„ mini-css-extract-plugin Warning å¹¶ä¸æ˜¯éå¸¸ç›´è§‚ï¼Œä¹Ÿå¾ˆéš¾çŸ¥é“å…·ä½“æ˜¯å“ªä¸€ä¸ª chunk group å‡ºç°äº†é—®é¢˜ã€‚æ–°æäº¤çš„ PR <a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/pull/465\">#465</a> ä»¥åŠ <a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/pull/468\">#468</a> å¯¹æ­¤åšäº†ä¼˜åŒ–ã€‚ä¼˜åŒ–åçš„è¾“å‡ºç±»ä¼¼ï¼š</p><div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">WARNING in chunk styles [mini-css-extract-plugin]\nConflicting order. Following module has been added:\n * css xxx!./e1.css\ndespite it was not able to fulfill desired ordering with these modules:\n * css xxx!./e2.css\n   - couldn&#39;t fulfill desired order of chunk group(s) entry2\n   - while fulfilling desired order of chunk group(s) entry1</code></pre></div><p>æ ¹æ® Warning çš„æç¤ºï¼Œåªéœ€è¦è§‚å¯Ÿ entry2 ä¸­å¯¹åº”çš„ä»£ç ï¼Œå°±å¯ä»¥æ‰¾åˆ°ä¸æ»¡è¶³çš„å¼•å…¥é¡ºåºäº†ã€‚</p></section>\n<section><h2>æ˜¯å¦éœ€è¦å…³å¿ƒ</h2><p>è¿™ä¸ª Warning æ˜¯å¦éœ€è¦å…³æ³¨ï¼Œå–å†³äº CSS åœ¨é¡¹ç›®ä¸­æ˜¯å¦‚ä½•è¢«ä½¿ç”¨çš„ï¼šåªè¦åœ¨é¡¹ç›®çš„ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œæ²¡æœ‰ CSS æ˜¯é€šè¿‡åŠ è½½çš„é¡ºåºè¿›è¡Œä¼˜å…ˆçº§è¦†ç›–çš„ï¼Œé‚£ä¹ˆå°±å¯ä»¥å¿½ç•¥ plugin ç»™å‡ºçš„ Warningï¼›åä¹‹ï¼Œå¦‚æœæœ‰è¿™æ ·çš„æƒ…å†µï¼Œåˆ™ä¸€å®šéœ€è¦æ ¹æ® Warning ä¿®æ­£è¾“å‡ºï¼Œé˜²æ­¢ç¼–è¯‘å¯¼è‡´çš„æ„å¤–ã€‚</p><p>å½“ç„¶ï¼Œæœ€ä¿é™©çš„åšæ³•æ˜¯å¯ç”¨ CSS Moduleï¼Œä»æºå¤´ä¸Šä¿è¯å„ä¸ªæ¨¡å—é—´çš„ CSS æ˜¯ä¸ä¼šç›¸äº’è¦†ç›–çš„ã€‚</p></section>\n<section><h2>ä»£ç åˆ†æ</h2><p>ä»¥ä¸‹ä»è¿™ä¸ª Warning å…¥æ‰‹ï¼Œåˆ†æ plugin æ˜¯å¦‚ä½•ä» modules ç”Ÿæˆæœ€ç»ˆçš„æ‰“åŒ…äº§ç‰©çš„ã€‚</p><p>è§‚å¯Ÿ mini-css-extract-plugin çš„æºä»£ç ï¼Œä¸éš¾æ‰¾åˆ°è¿™ä¸ª Warning çš„å…·ä½“è¾“å‡º<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L494\">ä»£ç </a>ã€‚æ¥ä¸‹æ¥ï¼Œå°†é’ˆå¯¹è¿™æ®µä»£ç æ‰€åœ¨çš„ <code class=\"language-text\">renderContentAsset</code> è¿›è¡Œåˆ†æï¼Œäº†è§£ plugin ç”Ÿæˆæ‰“åŒ…äº§ç‰©çš„ç®—æ³•ã€‚</p><p>é¦–å…ˆè§‚å¯Ÿ <code class=\"language-text\">renderContentAsset</code> å‡½æ•°æœ€å¼€å§‹çš„<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L416\">æ¯”è¾ƒè¯­å¥</a>ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">typeof</span> chunkGroup<span class=\"token punctuation\">.</span>getModuleIndex2 <span class=\"token operator\">===</span> <span class=\"token string\">'function'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">else</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>è¿™é‡Œï¼Œ<code class=\"language-text\">chunkGroup.getModuleIndex2</code> æ˜¯ Webpack 4 ä¸­çš„ APIï¼Œåœ¨ä¹‹å‰çš„ç‰ˆæœ¬ä¸­ä¸å­˜åœ¨ï¼ˆWebpack 3 åŠä¹‹å‰ä½¿ç”¨çš„æ˜¯ <a href=\"https://github.com/webpack-contrib/extract-text-webpack-plugin\">extract-text-webpack-plugin</a>ï¼‰ã€‚æ¥ä¸‹æ¥ï¼Œé‡ç‚¹å…³å¿ƒ Webpack 4 å¯¹åº”çš„ä»£ç æ®µã€‚</p><p>é¦–å…ˆçœ‹ <code class=\"language-text\">moduleDependencies</code> å˜é‡çš„åˆå§‹åŒ–ï¼ˆ<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L418\">æºç </a>ï¼‰ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> moduleDependencies <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Map</span><span class=\"token punctuation\">(</span>modules<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">m</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">[</span>m<span class=\"token punctuation\">,</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Set</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><p><code class=\"language-text\">moduleDependencies</code> ä¸ºæ¯ä¸€ä¸ª module éƒ½å®šä¹‰äº†ä¸€ä¸ªå¯¹åº”çš„ç©º Setï¼ˆå…·ä½“ Set å†…çš„å€¼ä¼šåœ¨åç»­å¡«å……ï¼‰ã€‚</p><p>æ¥ä¸‹æ¥çœ‹ <code class=\"language-text\">modulesByChunkGroup</code> å˜é‡çš„å®šä¹‰ï¼ˆ<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L423\">æºç </a>ï¼‰ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> modulesByChunkGroup <span class=\"token operator\">=</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>chunk<span class=\"token punctuation\">.</span>groupsIterable<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">cg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n  <span class=\"token keyword\">return</span> sortedModules<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œ<code class=\"language-text\">modulesByChunkGroup</code> æœ¬è´¨ä¸Šï¼Œæ˜¯å°†æ‰€æœ‰çš„ chunk groupï¼ˆ<code class=\"language-text\">chunk.groupsIterable</code>ï¼‰è½¬åŒ–æˆäº†å¯¹åº”çš„ <code class=\"language-text\">sortedModules</code>ã€‚è¿™é‡Œ <code class=\"language-text\">sortedModules</code> å˜é‡çš„å®šä¹‰ä¸ºï¼ˆ<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L424-L434\">æºç </a>ï¼‰ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> sortedModules <span class=\"token operator\">=</span> modules\n  <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">m</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n      module<span class=\"token punctuation\">:</span> m<span class=\"token punctuation\">,</span>\n      index<span class=\"token punctuation\">:</span> cg<span class=\"token punctuation\">.</span><span class=\"token function\">getModuleIndex2</span><span class=\"token punctuation\">(</span>m<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token comment\">// eslint-disable-next-line no-undefined</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span>index <span class=\"token operator\">!==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">sort</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">a<span class=\"token punctuation\">,</span> b</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> b<span class=\"token punctuation\">.</span>index <span class=\"token operator\">-</span> a<span class=\"token punctuation\">.</span>index<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">item</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> item<span class=\"token punctuation\">.</span>module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><p>ç®€å•æ¥è¯´ï¼Œåšäº†å‡ ä»¶äº‹æƒ…ï¼š</p><ol>\n<li>å°† <code class=\"language-text\">modules</code> ä¸­ä¸å±äºå½“å‰ chunk groupï¼ˆ<code class=\"language-text\">cg</code>ï¼‰çš„éƒ¨åˆ†å‰”é™¤ï¼Œå¯¹åº”çš„æ˜¯ <code class=\"language-text\">.filter((item) =&gt; item.index !== undefined)</code>ï¼›</li>\n<li>æ ¹æ® module åœ¨ chunk group ä¸­å®é™…å‡ºç°çš„ä½ç½®ï¼ŒæŒ‰ä»åå¾€å‰è¿›è¡Œæ’åºï¼Œå¯¹åº”çš„æ˜¯ <code class=\"language-text\">.sort((a, b) =&gt; b.index - a.index)</code></li>\n</ol><p>è¿™é‡Œï¼Œè¶Šæ˜¯å…ˆå‡ºç°çš„ module åœ¨æœ€ç»ˆçš„ <code class=\"language-text\">sortedModules</code> æ•°ç»„ä¸­æ’çš„è¶Šé åã€‚æ¢å¥è¯è¯´ï¼Œå‡ºç°åœ¨æ•°ç»„æœ€åçš„ä¸€ä¸ª moduleï¼Œæ²¡æœ‰ä»»ä½•å‰ç½®çš„ä¾èµ–ï¼ˆåœ¨è¯¥ chunk group ä¸­ï¼Œè¿™ä¸ª module æ˜¯ç¬¬ä¸€ä¸ªè¢«å¼•å…¥çš„ï¼‰ï¼›è€Œç†è®ºä¸Šæ¥è¯´ï¼Œæ•°ç»„çš„ç¬¬ä¸€ä¸ª module ä¾èµ–äº†æ•°ç»„åé¢çš„æ‰€æœ‰ modulesï¼ˆä» CSS çš„è§’åº¦æ¥è¯´ï¼Œè¿™ä¸ªæ¨¡å—å‡ºç°åœ¨æœ€åã€‚åœ¨æ‰€æœ‰é€‰æ‹©å™¨ä¼˜å…ˆçº§ä¸€æ ·çš„å‰æä¸‹ï¼Œè¿™ä¸ª module ç†è®ºä¸Šå¯ä»¥å¯¹ä¹‹å‰æ‰€æœ‰çš„ module è¿›è¡Œè¦†ç›–ï¼‰ã€‚è¿™é‡Œé‡‡ç”¨å€’å™çš„æ–¹å¼ç»„ç»‡æ•°ç»„ï¼Œæ˜¯ä¸ºäº†åç»­å¯ä»¥æ–¹ä¾¿çš„ä½¿ç”¨ <code class=\"language-text\">Array.prototype.pop</code> å‡½æ•°å»è·å–å½“å‰æ²¡æœ‰ä¾èµ–çš„ moduleã€‚</p><p>æ¥ä¸‹æ¥ï¼Œ<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L436-L442\">ä»£ç </a>å¯¹ <code class=\"language-text\">sortedModules</code> å˜é‡å€¼è¿›è¡Œäº†å¡«å……ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> sortedModules<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token keyword\">set</span> <span class=\"token operator\">=</span> moduleDependencies<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>sortedModules<span class=\"token punctuation\">[</span>i<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> j <span class=\"token operator\">=</span> i <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span> j <span class=\"token operator\">&lt;</span> sortedModules<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">;</span> j<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">set</span><span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>sortedModules<span class=\"token punctuation\">[</span>j<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>å¦‚ä¸Šæ‰€è¿°ï¼Œ<code class=\"language-text\">sortedModules</code> ä¸­åå‡ºç°çš„ module æ˜¯å…ˆå‡ºç° module çš„ä¾èµ–ã€‚è¿™é‡Œçš„ <code class=\"language-text\">moduleDependencies</code> å˜é‡è®°å½•äº†å„ä¸ª module çš„æ‰€æœ‰ä¾èµ–ï¼ˆä¸ä»…ä»…æ˜¯å½“å‰ chunk group çš„ä¾èµ–ï¼Œæ‰€æœ‰ chunk group çš„ä¾èµ–æœ€ç»ˆéƒ½ä¼šè¢«å†™å…¥åˆ°è¿™ä¸ª Set ä¸­ï¼‰ï¼Œå…¶ä¸­ key æ˜¯å„ä¸ª moduleï¼Œè€Œå¯¹åº”çš„ value åˆ™æ˜¯ä¸€ä¸ª Setï¼ŒSet ä¸­çš„æ¯ä¸ªå…ƒç´ éƒ½æ˜¯å½“å‰è¿™ä¸ª module çš„ä¾èµ–ã€‚</p><p>ä¹‹åå®šä¹‰äº† <code class=\"language-text\">usedModules</code> å’Œ <code class=\"language-text\">unusedModulesFilter</code> å‡½æ•°ï¼ˆ<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L448-L450\">æºç </a>ï¼‰ï¼Œç›®çš„æ˜¯ä¸ºäº†åˆ¤æ–­æŸä¸€ä¸ª module æ˜¯å¦å·²ç»è¢«å½“å‰çš„ plugin ä½¿ç”¨äº†ã€‚</p><p>æ¥ä¸‹æ¥çš„<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L452-L455\">ä»£ç </a>éœ€è¦ç¡®ä¿æ‰€æœ‰çš„ modules éƒ½ä¼šæ ¹æ®æŸä¸ªå…·ä½“çš„ç®—æ³•åœ¨æœ€ç»ˆçš„ç¼–è¯‘äº§ç‰©ä¸­è¢«ä½¿ç”¨åˆ°ã€‚è¿™é‡Œåˆ¤æ–­çš„æ–¹æ³•å°±æ˜¯ <code class=\"language-text\">usedModules</code> æ˜¯å¦åŒ…å«äº† <code class=\"language-text\">modules</code> ä¸­æ‰€æœ‰çš„å†…å®¹ã€‚</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>usedModules<span class=\"token punctuation\">.</span>size <span class=\"token operator\">&lt;</span> modules<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> success <span class=\"token operator\">=</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> bestMatch<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">let</span> bestMatchDeps<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>è‡³æ­¤ï¼Œå‡†å¤‡å·¥ä½œéƒ½åšå®Œäº†ã€‚æ¥ä¸‹æ¥å°±æ˜¯æ ¸å¿ƒçš„éƒ¨åˆ†ï¼šå¦‚ä½•åœ¨å„ä¸ª chunk group ä¸­é€‰å–åˆé€‚çš„ moduleï¼Œä¾æ¬¡æ”¾åˆ°æœ€ç»ˆç”Ÿæˆçš„ CSS æ–‡ä»¶ä¸­ã€‚<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L458-L484\">ä»£ç </a>å¦‚ä¸‹ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">const</span> list <span class=\"token keyword\">of</span> modulesByChunkGroup<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// skip and remove already added modules</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> <span class=\"token number\">0</span> <span class=\"token operator\">&amp;&amp;</span> usedModules<span class=\"token punctuation\">.</span><span class=\"token function\">has</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">[</span>list<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    list<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// skip empty lists</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">.</span>length <span class=\"token operator\">!==</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> module <span class=\"token operator\">=</span> list<span class=\"token punctuation\">[</span>list<span class=\"token punctuation\">.</span>length <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> deps <span class=\"token operator\">=</span> moduleDependencies<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>module<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// determine dependencies that are not yet included</span>\n    <span class=\"token keyword\">const</span> failedDeps <span class=\"token operator\">=</span> Array<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>deps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>unusedModulesFilter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// store best match for fallback behavior</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>bestMatchDeps <span class=\"token operator\">||</span> bestMatchDeps<span class=\"token punctuation\">.</span>length <span class=\"token operator\">></span> failedDeps<span class=\"token punctuation\">.</span>length<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      bestMatch <span class=\"token operator\">=</span> list<span class=\"token punctuation\">;</span>\n      bestMatchDeps <span class=\"token operator\">=</span> failedDeps<span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>failedDeps<span class=\"token punctuation\">.</span>length <span class=\"token operator\">===</span> <span class=\"token number\">0</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      <span class=\"token comment\">// use this module and remove it from list</span>\n      usedModules<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>list<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      success <span class=\"token operator\">=</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">break</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>ç†æƒ³æƒ…å†µä¸‹ï¼Œä¸¤ä¸ª CSS module åœ¨æœ€ç»ˆç¼–è¯‘äº§ç‰©ä¸­çš„å…ˆåé¡ºåºï¼Œåº”è¯¥å’Œè¿™ä¸¤ä¸ª CSS module åœ¨æŸä¸€ä¸ª chunk group ä¸­çš„å…ˆåé¡ºåºæ˜¯ä¸€è‡´çš„ã€‚å¦‚æœé¡ºåºä¸Šæ— æ³•ä¿è¯ä¸€è‡´ï¼Œé‚£ä¹ˆåº”è¯¥å°½å¯èƒ½å°†ä¸ä¸€è‡´çš„æƒ…å†µé™åˆ°æœ€ä½ã€‚mini-css-extract-plugin å°±æ˜¯éµå¾ªè¿™ä¸€ä¸ªåŸåˆ™æ¥å¯¹ module è¿›è¡Œæ’åºçš„ã€‚åœ¨æ¯ä¸€æ¬¡çš„é€‰å–æ­¥éª¤ä¸­ï¼Œç®—æ³•éƒ½ä¼šä¾æ¬¡éå†æ¯ä¸€ä¸ª chunk groupï¼Œåšä¸‹é¢å‡ ä¸ªäº‹æƒ…ï¼š</p><ol>\n<li>æ‹¿åˆ°å½“å‰è¯¥ chunk group ä¸­æ²¡æœ‰ä¾èµ–çš„é‚£ä¸ª CSS moduleï¼ˆ<code class=\"language-text\">const module = list[list.length - 1];</code>ï¼‰ï¼›</li>\n<li>åˆ¤æ–­è¿™ä¸ªæ‹¿åˆ°çš„ CSS module æ˜¯å¦æœ‰å‰ç½®çš„ä¾èµ–è¿˜æ²¡æœ‰è¢«æ”¾åˆ°æœ€ç»ˆäº§ç‰©ä¸­å»ï¼ˆ<code class=\"language-text\">const failedDeps = Array.from(deps).filter(unusedModulesFilter)</code>ï¼‰;</li>\n<li>å¦‚æœæ²¡æœ‰å‰ç½®ä¾èµ–äº†ï¼Œé‚£ä¹ˆè¿™ä¸ª CSS module å°±å¯ä»¥è¢«â€œå®‰å…¨â€çš„æ”¾åˆ°å½“å‰çš„ç¼–è¯‘äº§ç‰©ä¸­å»ï¼ˆ<code class=\"language-text\">if (failedDeps.length === 0) {</code> å¯¹åº”çš„éƒ¨åˆ†ï¼‰ï¼›</li>\n<li>å¦‚æœæœ‰ä¸æ»¡è¶³çš„å‰ç½®ä¾èµ–ï¼Œé‚£ä¹ˆå°±å»å¯»æ‰¾ä¸æ»¡è¶³æƒ…å†µæœ€å°‘çš„ä¸€ä¸ªï¼ˆ<code class=\"language-text\">bestMatchDeps.length &gt; failedDeps.length</code>ï¼‰ï¼Œç„¶åè®°ä¸‹æ¥ï¼ˆ<code class=\"language-text\">bestMatchDeps = failedDeps;</code>ï¼‰</li>\n</ol><p>å¦‚æœæ‰¾åˆ°äº†æ²¡æœ‰å‰ç½®ä¾èµ–çš„ moduleï¼Œä»£ç å°±ç›´æ¥ breakï¼Œè·³åˆ°ä¸‹ä¸€æ¬¡ while å¾ªç¯ä¸­å»äº†ï¼›å¦‚æœæ²¡æœ‰æ‰¾åˆ°å®Œç¾åŒ¹é…çš„æƒ…å†µï¼Œå°±ä¼šè¿›å…¥æ¥ä¸‹æ¥çš„<a href=\"https://github.com/webpack-contrib/mini-css-extract-plugin/blob/50434b55c9df9cd3c26f2243e23df83e2964c720/src/index.js#L486-L507\">ä»£ç </a>ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>success<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// no module found => there is a conflict</span>\n  <span class=\"token comment\">// use list with fewest failed deps</span>\n  <span class=\"token comment\">// and emit a warning</span>\n  <span class=\"token keyword\">const</span> fallbackModule <span class=\"token operator\">=</span> bestMatch<span class=\"token punctuation\">.</span><span class=\"token function\">pop</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>options<span class=\"token punctuation\">.</span>ignoreOrder<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    compilation<span class=\"token punctuation\">.</span>warnings<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span>\n      <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span>\n        <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">chunk </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>chunk<span class=\"token punctuation\">.</span>name <span class=\"token operator\">||</span> chunk<span class=\"token punctuation\">.</span>id<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> [</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>pluginName<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">]\\n</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n          <span class=\"token string\">'Conflicting order between:\\n'</span> <span class=\"token operator\">+</span>\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> * </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>fallbackModule<span class=\"token punctuation\">.</span><span class=\"token function\">readableIdentifier</span><span class=\"token punctuation\">(</span>\n            requestShortener\n          <span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\\n</span><span class=\"token template-punctuation string\">`</span></span> <span class=\"token operator\">+</span>\n          <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>bestMatchDeps\n            <span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">m</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\"> * </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>m<span class=\"token punctuation\">.</span><span class=\"token function\">readableIdentifier</span><span class=\"token punctuation\">(</span>requestShortener<span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n            <span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span>\n      <span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  usedModules<span class=\"token punctuation\">.</span><span class=\"token function\">add</span><span class=\"token punctuation\">(</span>fallbackModule<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>ä¸Šé¢ä»£ç ä¸­çš„ <code class=\"language-text\">bestMatch</code> å°±æ˜¯å¯¹åº”äº†æœ€ä½³æƒ…å†µæ—¶å€™ modules æ’åºçš„æ•°ç»„ï¼Œè¿™é‡Œ <code class=\"language-text\">fallbackModule = bestMatch.pop()</code> å°±å¯ä»¥æ‹¿åˆ°å½“å‰è¿™ä¸ªæœ€ä½³æƒ…å†µçš„ chunk group ä¸­ï¼Œæ²¡æœ‰ä¾èµ–çš„é‚£ä¸ª CSS moduleã€‚å’Œä¹‹å‰ä»£ç ä¸­ <code class=\"language-text\">module = list[list.length - 1]</code> æ‹¿åˆ°çš„æ•°æ®æ˜¯ä¸€æ ·çš„ã€‚</p><p>åŒæ—¶ï¼Œ<code class=\"language-text\">bestMatchDeps</code> å¯¹åº”çš„å°±æ˜¯ä¸Šé¢ä»£ç é‡Œçš„ <code class=\"language-text\">failedDeps</code> æ•°ç»„ï¼Œè¡¨ç¤ºçš„æ˜¯å½“å‰è¿™ä¸ª <code class=\"language-text\">fallbackModule</code> è¢«é€‰ä¸­æ—¶ï¼Œæœ‰å“ªäº›è¯¥ module çš„å‰ç½®ä¾èµ–å¹¶æ²¡æœ‰è¢«äº‹å…ˆæ”¾åˆ°ç¼–è¯‘äº§ç‰©ä¸­å»ã€‚</p><p>æ¥ä¸‹æ¥å°±æ˜¯å‘ Webpack è¾“å‡º Warning çš„ä»£ç äº†ã€‚å†æ¥çœ‹ä¸‹é¢è¿™æ®µ Warningï¼š</p><div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">WARNING in chunk styles [mini-css-extract-plugin]\nConflicting order between:\n* css xxx/css-loader/dist/cjs.js!./e1.css\n* css xxx/css-loader/dist/cjs.js!./e2.css\n* css xxx/css-loader/dist/cjs.js!./e3.css</code></pre></div><p>å¯çŸ¥é“ï¼Œå…·ä½“çš„å«ä¹‰æ˜¯ï¼šç”±äºæ²¡æ³•æ‰¾åˆ°æœ€åˆé€‚çš„è§£ï¼Œplugin è¢«è¿«ä½¿ç”¨äº†ç›¸å¯¹æœ€ä¼˜çš„è§£ï¼Œå°† <code class=\"language-text\">e1.css</code> æ”¾åˆ°äº†ç¼–è¯‘äº§ç‰©ä¸­ã€‚åœ¨æŸäº› chunk group ä¸­ï¼Œ<code class=\"language-text\">e2.css</code> æˆ– <code class=\"language-text\">e3.css</code> è¿™ä¸¤ä¸ªæ–‡ä»¶å¼•ç”¨ä½ç½®åœ¨ <code class=\"language-text\">e1.css</code> ä¹‹å‰ï¼›è€Œåœ¨ plugin å°† <code class=\"language-text\">e1.css</code> åŠ å…¥ç¼–è¯‘äº§ç‰©çš„æ—¶å€™ï¼Œ<code class=\"language-text\">e2.css</code> å’Œ <code class=\"language-text\">e3.css</code> è¿˜æ²¡æœ‰è¢«æ·»åŠ ã€‚</p></section>","frontmatter":{"date":"2019-11-28","title":"Conflicting order in mini-css-extract-plugin","category":"Build"}}},{"node":{"id":"4932e15d-274d-516f-988d-6f70cc3496f0","html":"<p>Chunk Group æ˜¯ Webpack 4 ä¸­æ–°äº§ç”Ÿçš„ä¸€ä¸ªæ¦‚å¿µã€‚</p>\n<p>åœ¨ Webpack ä¸­ï¼Œä¸€ä¸ªæ–‡ä»¶/èµ„æºåœ¨æ‰“åŒ…æ—¶å°±æ˜¯ä¸€ä¸ª moduleï¼Œä¸€äº› module è¢«æ‰“åŒ…åˆ°ä¸€èµ·ï¼Œç”Ÿæˆä¸€ä¸ª chunkã€‚åœ¨åŸæ¥çš„ Webpack ä¸­ï¼Œchunk ä¹‹é—´çš„ä¾èµ–æ˜¯ä¸€ç§çˆ¶å­å…³ç³»ï¼šå¦‚æœä¸€ä¸ª chunk æœ‰çˆ¶ chunkï¼Œé‚£ä¹ˆå°±å¯ä»¥è®¤å®šï¼Œåœ¨è¿™ä¸ª chunk è¢«åŠ è½½çš„æ—¶å€™ï¼Œè‡³å°‘å…¶ä¸€ä¸ªçˆ¶ chunk å·²ç»è¢«åŠ è½½äº†ã€‚åœ¨è¿™ç§å‡è®¾ä¸‹ï¼ŒWebpack å¯ä»¥å¯¹ chunk è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼Œæ¯”å¦‚ï¼šå¦‚æœä¸€ä¸ª chunk ä¸­çš„æŸä¸ª module è¢«æ‰€æœ‰çˆ¶ chunk ä½¿ç”¨äº†ï¼Œé‚£ä¹ˆè¿™ä¸ª module å°±å¯ä»¥ä» chunk ä¸­åˆ é™¤ï¼ˆå› ä¸ºåœ¨åŠ è½½ chunk çš„æ—¶å€™ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªçˆ¶ chunk å·²ç»è¢«åŠ è½½äº†ï¼Œæ•…è¿™ä¸ª module è‚¯å®šå·²ç»å­˜åœ¨äº†ï¼‰ã€‚</p>\n<p>ç„¶è€Œï¼Œè¿™ç§çˆ¶å­å…³ç³»çš„æ¨¡å¼ï¼Œå¹¶ä¸åˆ©äº chunk çš„æ‹†åˆ†ï¼šåœ¨ CommonsChunkPlugin ä¸­ï¼Œå¦‚æœä¸€ä¸ª chunk è¢«æ‹†åˆ†äº†å‡ºæ¥ï¼Œé‚£ä¹ˆè¿™ä¸ª chunk ä¼šè¢«â€œå½“ä½œâ€æ˜¯åŸæ¥ chunk çš„çˆ¶ chunk è¿›è¡Œå¤„ç†ã€‚è¿™ç§çˆ¶å­å…³ç³»å…¶å®æ˜¯ä¸æ­£ç¡®çš„ï¼Œå› æ­¤ä¹Ÿä¼šå½±å“åˆ°å…¶ä»–ä¸€äº›ä¼˜åŒ–çš„è¿›è¡Œã€‚</p>\n<p>å› æ­¤ï¼Œåœ¨ Webpack 4 ä¸­ï¼Œå¼•å…¥äº† chunk group çš„æ¦‚å¿µï¼Œç›®çš„å°±æ˜¯ä¿®æ­£è¿™ä¸€æ¦‚å¿µã€‚</p>\n<p>ä¸€ä¸ª chunk groupï¼Œé¡¾åæ€ä¹‰ï¼Œå°±æ˜¯ä¸€ç»„ chunk çš„é›†åˆã€‚ä¸€ä¸ª Webpack çš„åŠ è½½å…¥å£ã€æˆ–æ˜¯ä¸€ä¸ªå¼‚æ­¥åŠ è½½ç‚¹å°±æ˜¯ä¸€ä¸ª chunk groupï¼Œè¿™ä¸ª group ä¸­æ‰€æœ‰çš„ chunk éƒ½æ˜¯å¯ä»¥è¢«å¹¶è¡ŒåŠ è½½çš„ã€‚åŒæ—¶ï¼Œä¸€ä¸ª chunk ä¹Ÿå¯ä»¥å½’å±äºå¤šä¸ªä¸åŒçš„ chunk groupã€‚æœ‰äº† chunk group çš„æ¦‚å¿µï¼Œåœ¨é€šè¿‡ SplitChunksPlugin è¿›è¡Œæ‹†åˆ†çš„æ—¶å€™ï¼Œåªéœ€è¦å°†æ‹†å‡ºæ¥çš„ chunk åˆ’åˆ†åˆ°å¯¹åº”çš„å„ä¸ª chunk group ä¸­å»ï¼Œå°±å¯ä»¥ä¿è¯æ­£å¸¸çš„ä½¿ç”¨äº†ã€‚</p>\n<p>å‚è€ƒæ–‡æ¡£è§<a href=\"https://medium.com/webpack/webpack-4-code-splitting-chunk-graph-and-the-splitchunks-optimization-be739a861366\">è¿™é‡Œ</a>ã€‚</p>","frontmatter":{"date":"2019-11-27","title":"Chunk Group","category":"Build"}}},{"node":{"id":"7dc217cf-0b7c-5c89-bffe-de976e7fdcfd","html":"<p><code class=\"language-text\">Node.isEqualNode</code> å¯ä»¥ç”¨äºæ¯”è¾ƒå½“å‰èŠ‚ç‚¹ï¼ˆNodeï¼‰å’ŒæŒ‡å®šèŠ‚ç‚¹æ˜¯å¦æ˜¯ç›¸åŒçš„ã€‚å’Œ <code class=\"language-text\">Node.isSameNode</code> ä¸åŒï¼Œ<code class=\"language-text\">.isEqualNode</code> API å¹¶ä¸éœ€è¦ä¸¤ä¸ªè¢«æ¯”è¾ƒçš„èŠ‚ç‚¹æ˜¯åŒä¸€ä¸ªã€‚åªéœ€è¦æ»¡è¶³ä»¥ä¸‹çš„æ¡ä»¶ï¼Œä¸¤ä¸ªèŠ‚ç‚¹å°±ä¼šè¢«è®¤ä¸ºæ˜¯ç›¸åŒçš„ï¼š</p>\n<ol>\n<li>ä¸¤ä¸ªèŠ‚ç‚¹çš„ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Node/nodeType\">nodeType</a> æ˜¯ç›¸åŒçš„ï¼›</li>\n<li>ï¼ˆçœç•¥é Element æ¯”è¾ƒçš„æƒ…å†µï¼Œå…·ä½“ç»†èŠ‚å¯ä»¥å‚è€ƒ <a href=\"https://dom.spec.whatwg.org/#concept-node-equals\">DOM è§„èŒƒ</a>ï¼‰ï¼›</li>\n<li>å¦‚æœèŠ‚ç‚¹æ˜¯ element çš„è¯ï¼Œé‚£ä¹ˆå¯¹ <code class=\"language-text\">A.isEqualNode(B)</code> æ¥è¯´ï¼ŒA ä¸­æ‰€æœ‰çš„å±æ€§ï¼Œéƒ½å¯ä»¥åœ¨ B ä¸Šæ‰¾åˆ°ç›¸åŒçš„å€¼ï¼ˆåä¹‹äº¦ç„¶ï¼‰ï¼›</li>\n<li>ä¸¤ä¸ªèŠ‚ç‚¹åº”è¯¥æœ‰ç­‰é•¿çš„ <code class=\"language-text\">children</code>ï¼›</li>\n<li>ä¸¤ä¸ªèŠ‚ç‚¹çš„ <code class=\"language-text\">children</code> çš„æ¯ä¸ªç›¸åŒä½ç½®ä¸Šçš„å€¼éƒ½æ˜¯ç›¸åŒçš„ï¼ˆé€’å½’è°ƒç”¨ <code class=\"language-text\">isEqualNode</code> çš„å®šä¹‰ï¼‰ã€‚</li>\n</ol>\n<p>è¿™é‡Œéœ€è¦è¯´æ˜çš„å‡ ç‚¹æ˜¯ï¼š</p>\n<ol>\n<li>åœ¨å±æ€§åˆ¤æ–­çš„æ—¶å€™ï¼Œå¹¶ä¸éœ€è¦å…³å¿ƒé¡ºåºï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> first <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> second <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> <span class=\"token string\">'id'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> className <span class=\"token operator\">=</span> <span class=\"token string\">'className'</span><span class=\"token punctuation\">;</span>\n\nfirst<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> id<span class=\"token punctuation\">;</span>\nfirst<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> className<span class=\"token punctuation\">;</span>\n\nsecond<span class=\"token punctuation\">.</span>className <span class=\"token operator\">=</span> className<span class=\"token punctuation\">;</span>\nsecond<span class=\"token punctuation\">.</span>id <span class=\"token operator\">=</span> id<span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// first: &lt;div id=\"id\" className=\"className\">&lt;/div></span>\n<span class=\"token comment\">// second: &lt;div className=\"className\" id=\"id\">&lt;/div></span>\nfirst<span class=\"token punctuation\">.</span><span class=\"token function\">isEqualNode</span><span class=\"token punctuation\">(</span>second<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => true</span></code></pre></div>\n<ol start=\"2\">\n<li>å±æ€§çš„åˆ¤æ–­æ˜¯ç›´æ¥å¯¹å€¼è¿›è¡Œæ¯”è¾ƒçš„ï¼Œå› æ­¤ <code class=\"language-text\">style</code> çš„é¡ºåºä¸åŒä¼šé€ æˆç»“æœçš„ä¸åŒï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> first <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> second <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nfirst<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">;</span>\nfirst<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">;</span>\n\nsecond<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>color <span class=\"token operator\">=</span> <span class=\"token string\">'red'</span><span class=\"token punctuation\">;</span>\nsecond<span class=\"token punctuation\">.</span>style<span class=\"token punctuation\">.</span>display <span class=\"token operator\">=</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// first: &lt;div style=\"display:block;color:red\">&lt;/div></span>\n<span class=\"token comment\">// second: &lt;div style=\"color:red;display:block\">&lt;/div></span>\nfirst<span class=\"token punctuation\">.</span><span class=\"token function\">isEqualNode</span><span class=\"token punctuation\">(</span>second<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => false</span></code></pre></div>\n<ol start=\"3\">\n<li>å±æ€§çš„æ¯”è¾ƒæ˜¯é¡ºåºæ— å…³çš„ï¼Œä½†æ˜¯ <code class=\"language-text\">children</code> çš„æ¯”è¾ƒæ˜¯é¡ºåºç›¸å…³çš„ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> first <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> second <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> childA <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> childB <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">createElement</span><span class=\"token punctuation\">(</span><span class=\"token string\">'div'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nfirst<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>childA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nfirst<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>childB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nsecond<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>childB<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nsecond<span class=\"token punctuation\">.</span><span class=\"token function\">appendChild</span><span class=\"token punctuation\">(</span>childA<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nfirst<span class=\"token punctuation\">.</span><span class=\"token function\">isEqualNode</span><span class=\"token punctuation\">(</span>second<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => false</span></code></pre></div>\n<ol start=\"4\">\n<li>Node æ˜¯ Element çš„â€œçˆ¶ç±»â€ï¼Œé™¤äº†ä¸€èˆ¬çš„ DOM èŠ‚ç‚¹ä¹‹å¤–ï¼ŒèŠ‚ç‚¹ä¸Šçš„ attributesï¼ŒèŠ‚ç‚¹ä¸­çš„ comment ç­‰ä¹Ÿæ˜¯ Nodeã€‚è¿™äº›èŠ‚ç‚¹ä¹Ÿæœ‰ <code class=\"language-text\">isEqualNode</code> API å¯ä»¥ç”¨äºæ¯”è¾ƒã€‚å¯¹äºä¸€èˆ¬çš„ Element æ¥è¯´ï¼Œå¯ä»¥ç®€å•çš„è®¤ä¸ºç±»å‹ï¼Œå±æ€§å’Œå­èŠ‚ç‚¹ä¸€æ ·ï¼Œ<code class=\"language-text\">isEqualNode</code> å°±ä¼šè¿”å› <code class=\"language-text\">true</code>ã€‚</li>\n</ol>\n<p>åŸå§‹çš„æ¯”è¾ƒç®—æ³•ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://dom.spec.whatwg.org/#concept-node-equals\">DOM è§„èŒƒ</a>ï¼›MDN çš„ä»‹ç»åœ¨<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Node/isEqualNode\">è¿™é‡Œ</a>ã€‚</p>","frontmatter":{"date":"2019-11-26","title":"isEqualNode","category":"JavaScript"}}},{"node":{"id":"1de0a311-e54d-5928-bcf7-eccaae105279","html":"<p><code class=\"language-text\">Node.isSameNode</code> è¿™ä¸ª API çš„ä½œç”¨ï¼Œæ˜¯åˆ¤æ–­å¦ä¸€ä¸ª Node èŠ‚ç‚¹å’Œå½“å‰èŠ‚ç‚¹æ˜¯å¦æ˜¯ç›¸åŒçš„ã€‚ä¸¾ä¾‹æ¥è¯´ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> a <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#a'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> b <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelector</span><span class=\"token punctuation\">(</span><span class=\"token string\">'#b'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> c <span class=\"token operator\">=</span> a<span class=\"token punctuation\">;</span>\n\na<span class=\"token punctuation\">.</span><span class=\"token function\">isSameNode</span><span class=\"token punctuation\">(</span>c<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => true</span>\na<span class=\"token punctuation\">.</span><span class=\"token function\">isSameNode</span><span class=\"token punctuation\">(</span>b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// => false</span></code></pre></div>\n<p>å› ä¸ºåœ¨ä¸€ä¸ªåŒä¸€ä¸ª document ä¸­ï¼Œä¸€ä¸ª Node å®é™…åªæœ‰ä¸€ä¸ªå¼•ç”¨ï¼Œå› æ­¤ <code class=\"language-text\">.isSameNode</code> API çš„å®é™…æ•ˆæœå…¶å®å’Œ <code class=\"language-text\">==</code> æˆ– <code class=\"language-text\">===</code> è¿ç®—æ˜¯ä¸€è‡´çš„ã€‚ç®€å•æ¥è¯´ï¼Œä¸Šé¢çš„ä»£ç ï¼Œå¯ä»¥ç­‰ä»·äºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">a <span class=\"token operator\">===</span> c<span class=\"token punctuation\">;</span> <span class=\"token comment\">// => true</span>\na <span class=\"token operator\">===</span> b<span class=\"token punctuation\">;</span> <span class=\"token comment\">// => false</span></code></pre></div>\n<p>åœ¨ <a href=\"https://dom.spec.whatwg.org/#dom-node-issamenode-othernode-othernode\">DOM (Living Standard) è§„èŒƒ</a>ä¸­ï¼Œä¹Ÿå¯ä»¥çœ‹åˆ°ç›¸å…³çš„æ³¨é‡Šï¼Œè¯´æ˜ <code class=\"language-text\">.isSameNode</code> æœ¬è´¨ä¸Šåªæ˜¯å› ä¸ºå†å²åŸå› è€Œç»™å‡ºçš„ <code class=\"language-text\">===</code> çš„åˆ«åï¼ˆaliasï¼‰ã€‚</p>\n<p>ç„¶è€Œåœ¨æŸäº›æœ‰é™çš„åœºæ™¯ä¸‹ï¼Œ<code class=\"language-text\">.isSameNode</code> ä¾ç„¶æœ‰å‘æŒ¥çš„åº”ç”¨åœºæ™¯ï¼Œç›®å‰å¯ä»¥æƒ³åˆ°çš„æœ‰ä»¥ä¸‹å‡ ç‚¹ï¼š</p>\n<ol>\n<li>åœ¨èŠ‚ç‚¹ç›¸å…³ç®—æ³•ï¼ˆå¦‚ Diff ç®—æ³•ï¼‰ä¸­ä½œä¸ºæŠ½è±¡æ–¹æ³•ç›´æ¥ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œåœ¨ <a href=\"https://github.com/patrick-steele-idem/morphdom\">morphdom</a> ä¸­ï¼Œå°±ä½¿ç”¨äº† <code class=\"language-text\">.isSameNode</code> è¿™ä¸ª API æ¥æ¯”è¾ƒä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦ç›¸åŒï¼Œä»è€ŒèŠ‚çœæ¯”è¾ƒçš„æ¬¡æ•°(<a href=\"https://github.com/patrick-steele-idem/morphdom/blob/56f330fa0fa6df9e51eeeaaae5894e24f30edb7c/src/morphdom.js#L237\">æºç </a>)ã€‚æ ¹æ® morphdom ç»™å‡ºçš„<a href=\"https://github.com/patrick-steele-idem/morphdom/blob/e4a34d934b24bb5aad1fcbc6222ed21bcdb5e56d/docs/virtual-dom.md#L23\">æ–‡æ¡£</a>å¯ä»¥çœ‹åˆ°ï¼Œmorphdom çš„ç®—æ³•ä¹Ÿæ”¯æŒå¯¹ virtual dom è¿›è¡Œæ¯”è¾ƒï¼Œåªéœ€è¦ virtual dom ä¹Ÿå¯¹èŠ‚ç‚¹å®ç°äº†ç›¸åº”çš„ <code class=\"language-text\">.isSameNode</code> APIï¼Œå°±æœ‰å¯èƒ½å¯ä»¥åœ¨æ¯”è¾ƒçš„æ—¶å€™èŠ‚çœä¸€å®šçš„è®¡ç®—æ¬¡æ•°ã€‚è¿™é‡Œï¼Œ<code class=\"language-text\">.isSameNode</code> åœ¨ morphdom ä¸­å°±è¢«ä½œä¸ºæŠ½è±¡æ–¹æ³•ä½¿ç”¨äº†ï¼Œç®—æ³•æœ¬èº«å¹¶ä¸åœ¨æ„çœŸæ­£åœ¨ diff çš„å¯¹è±¡æ˜¯çœŸå®çš„ DOM è¿˜æ˜¯ virtual DOMï¼Œåªè¦èŠ‚ç‚¹å®ç°äº†ç¬¦åˆè¦æ±‚çš„ APIï¼Œç®—æ³•å°±å¯ä»¥æ­£ç¡®çš„è¿›è¡Œã€‚</li>\n<li>é€šè¿‡é‡å†™æ–¹æ³•æ¥è¾¾åˆ°â€œä»£ç†èŠ‚ç‚¹â€çš„åŠŸèƒ½ã€‚ç°åœ¨å¤§å¤šæ•°çš„ UI åº“ï¼Œéƒ½é€šè¿‡å£°æ˜å¼çš„æ–¹å¼æ¥å®šä¹‰ç»„ä»¶ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¼€å‘è€…å¹¶ä¸éœ€è¦æ˜¾ç¤ºçš„å†™å‡ºåœ¨ä½•æ—¶é€šè¿‡ä½•ç§æ–¹å¼åˆ›å»ºæˆ–æ›´æ–°ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåªéœ€è¦å†™å‡º <code class=\"language-text\">state =&gt; UI</code> è¿™æ ·çš„æ˜ å°„å‡½æ•°ï¼ŒUI åº“å°±ä¼šåœ¨ state æ›´æ–°åï¼Œé€šè¿‡æ˜ å°„å‡½æ•°å»å¾—åˆ°æ–°çš„ UI ç»„ä»¶ï¼Œç„¶åé€šè¿‡ diff ç®—æ³•å»è®¡ç®—å¾—åˆ°éœ€è¦ä¿®æ”¹çš„éƒ¨åˆ†ï¼Œæœ€ç»ˆå°†å¿…è¦çš„éƒ¨åˆ†è¿›è¡Œæ›´æ–°ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå°±æ²¡æœ‰åŠæ³•é€šè¿‡ <code class=\"language-text\">===</code> å»æ¯”è¾ƒä¸¤ä¸ªèŠ‚ç‚¹æ˜¯å¦ç›¸åŒäº†ï¼Œå› ä¸ºæµç¨‹ä¸Šæ˜¯éœ€è¦é€šè¿‡æ–°çš„ state ç”ŸæˆèŠ‚ç‚¹ï¼Œç„¶åå†å’Œå·²æœ‰çš„ Node è¿›è¡Œæ¯”è¾ƒã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œé€šè¿‡æ”¹å†™ <code class=\"language-text\">.isSameNode</code> å°±å¯ä»¥è¾¾åˆ°äººä¸ºæ§åˆ¶çš„ç›®çš„ã€‚</li>\n</ol>\n<p>ä¸¾ä¸€ä¸ª <a href=\"https://github.com/choojs/nanocomponent\">nanocomponent</a> ä¸­æåˆ°çš„ä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> html <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'nanohtml'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> el1 <span class=\"token operator\">=</span> html<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div>pink is the best&lt;/div></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> el2 <span class=\"token operator\">=</span> html<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div>blue is the best&lt;/div></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// å¯¹ el1 è¿›è¡Œä»£ç†æ“ä½œ</span>\n<span class=\"token keyword\">const</span> proxy <span class=\"token operator\">=</span> html<span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">&lt;div>&lt;/div></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">;</span>\nproxy<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">isSameNode</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">targetNode</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>targetNode <span class=\"token operator\">===</span> el1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nel1<span class=\"token punctuation\">.</span><span class=\"token function\">isSameNode</span><span class=\"token punctuation\">(</span>el1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// true</span>\nel1<span class=\"token punctuation\">.</span><span class=\"token function\">isSameNode</span><span class=\"token punctuation\">(</span>el2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>   <span class=\"token comment\">// false</span>\nproxy<span class=\"token punctuation\">.</span><span class=\"token function\">isSameNode</span><span class=\"token punctuation\">(</span>el1<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// true</span>\nproxy<span class=\"token punctuation\">.</span><span class=\"token function\">isSameNode</span><span class=\"token punctuation\">(</span>el2<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// false</span></code></pre></div>\n<p>è™½ç„¶ <code class=\"language-text\">proxy</code> å’Œ <code class=\"language-text\">el1</code> å¹¶ä¸æ˜¯çœŸçš„ä¸€æ ·çš„ä¸¤ä¸ªèŠ‚ç‚¹ï¼Œä½†æ˜¯å› ä¸ºå¯¹ <code class=\"language-text\">isSameNode</code> è¿›è¡Œäº†æ”¹å†™ï¼Œå› è€Œåœ¨ diff ç®—æ³•ä¸­ï¼Œä¸¤ä¸ªèŠ‚ç‚¹ä¼šè¢«å½“ä½œæ˜¯ä¸€è‡´çš„ã€‚è¿™æœ‰åŠ©äºèŠ‚çœæ¯”è¾ƒçš„æ¬¡æ•°ã€‚</p>\n<p><code class=\"language-text\">.isSameNode</code> API çš„æ”¯æŒæƒ…å†µï¼Œå¯ä»¥æŸ¥çœ‹ <a href=\"https://caniuse.com/#search=isSameNode\">Can I Use</a>ï¼›æ–‡æ¡£å¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Node/isSameNode\">MDN</a>ã€‚</p>","frontmatter":{"date":"2019-11-25","title":"isSameNode","category":"JavaScript"}}},{"node":{"id":"d4f2cc35-174d-5e24-86fa-274d23e4c9a1","html":"<p>åœ¨ TypeScript ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šé‡åˆ°å¦‚ä¸‹çš„æŠ¥é”™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">Exported variable &lt;variable name&gt; has or is using private name &lt;private name&gt;</code></pre></div>\n<p>è¿™ä¸€æŠ¥é”™åªä¼šå‡ºç°åœ¨å¼€å¯äº† declaration è¾“å‡ºä¹‹åã€‚å¼€å¯çš„æ–¹å¼æ˜¯ç¼–è¯‘æ—¶å¢åŠ  <code class=\"language-text\">--declaration</code>ï¼Œæˆ–è€…åœ¨ tsconfig.json ä¸­åŠ å…¥ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"compilerOptions\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"declaration\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å‡ºç°è¿™ä¸€æŠ¥é”™çš„åŸå› æ˜¯ï¼Œæœ€ç»ˆè¢«ä½¿ç”¨çš„æŸä¸€ä¸ªç±»å‹ï¼Œå¼•ç”¨åˆ°äº†æŸä¸€ä¸ªæ²¡æœ‰è¢«å…¬å¼€ï¼ˆexportï¼‰çš„ç±»å‹ã€‚ç®€å•çš„ä¾‹å­å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">interface</span> <span class=\"token class-name\">A</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">interface</span> <span class=\"token class-name\">B</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">declare</span> <span class=\"token keyword\">type</span> Props <span class=\"token operator\">=</span> <span class=\"token constant\">A</span> <span class=\"token operator\">|</span> <span class=\"token constant\">B</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œï¼Œä¹‹æ‰€ä»¥ä¼šå‡ºç°é—®é¢˜ï¼Œç†ç”±å¾ˆç®€å•ï¼šTypeScript è¯•å›¾è¾“å‡ºä¸€ä¸ªå®šä¹‰ç±»å‹çš„æ–‡ä»¶ï¼Œå…¶ä¸­å°±åŒ…æ‹¬äº† <code class=\"language-text\">Props</code> çš„å®šä¹‰ã€‚ç„¶è€Œï¼Œå¦‚æœè¦æ˜ç¡®å®šä¹‰ <code class=\"language-text\">Props</code>ï¼Œå°±éœ€è¦ç”¨åˆ°ä¸¤ä¸ªç±»å‹ <code class=\"language-text\">A</code> å’Œ <code class=\"language-text\">B</code>ã€‚åœ¨è¿™é‡Œï¼Œ<code class=\"language-text\">A</code> å’Œ <code class=\"language-text\">B</code> è¿™ä¸¤ä¸ªç±»å‹å› ä¸ºæ²¡æœ‰è¢«å…¬å¼€ï¼ˆexportï¼‰ï¼Œå› è€Œæ˜¯ç§æœ‰ï¼ˆprivateï¼‰çš„ã€‚æ•…ï¼Œç†è®ºä¸Šæ¥è¯´ï¼ŒTypeScript çš„å¯¼å‡ºå®šä¹‰æ–‡ä»¶ä¸­ä¸åº”è¯¥åŒ…å«è¿™ä¸¤ä¸ªç±»å‹ã€‚è€Œæ²¡æœ‰è¿™ä¸¤ä¸ªç±»å‹çš„è¯ï¼ŒTypeScript å°±æ²¡æœ‰åŠæ³•å®šä¹‰ <code class=\"language-text\">Props</code> äº†ã€‚æœ€ç»ˆï¼ŒTypeScript åªèƒ½æŠ¥é”™ã€‚</p>\n<p>å®˜æ–¹ç»™å‡ºçš„è§£é‡Šå¯ä»¥å‚è€ƒ<a href=\"https://github.com/ant-design/ant-design/pull/19846#event-2817984936\">è¿™é‡Œ</a>ã€‚</p>\n<p>è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ–¹æ³•ä¹Ÿå¾ˆç®€å•ï¼šæ‰€æœ‰ä½¿ç”¨åˆ°çš„ç±»å‹ï¼Œå…¨éƒ¨éƒ½å…¬å¼€ï¼ˆexportï¼‰å°±å¥½äº†ã€‚</p>","frontmatter":{"date":"2019-11-21","title":"Export Variable using Private Name","category":"TypeScript"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":true}}}
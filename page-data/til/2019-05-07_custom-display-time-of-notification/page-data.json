{"componentChunkName":"component---src-templates-til-js","path":"/til/2019-05-07_custom-display-time-of-notification","result":{"data":{"markdownRemark":{"id":"59648bef-5b8c-51a7-bd1c-badf363cd310","html":"<p>浏览器显示 Notification 默认是有一个自动消失时间的。不同的浏览器，这里的消失时间并不一致，从测试来看：</p>\n<ul>\n<li>Chrome: ~6s</li>\n<li>Firefox: ~19s</li>\n<li>Edge: ~6s</li>\n</ul>\n<p>从目前浏览器公开的 API 来看，并没有一个接口可以直观的修改这里的消失时间。一个可行的解决方案是：用 <code class=\"language-text\">requireInteraction</code> 来强制要求浏览器不自动关闭 Notification，然后设置 <code class=\"language-text\">setTimeout</code> 并在合适的时机手动关闭这个显示的 Notification。</p>\n<p>示例代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">var</span> delay <span class=\"token operator\">=</span> <span class=\"token number\">10</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000</span><span class=\"token punctuation\">;</span>\nNotification<span class=\"token punctuation\">.</span><span class=\"token function\">requestPermission</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">status</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>status <span class=\"token operator\">===</span> <span class=\"token string\">\"granted\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">var</span> notification <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Notification</span><span class=\"token punctuation\">(</span>\n      <span class=\"token string\">\"Hi! \"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">{</span>\n        requireInteraction<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">var</span> timer <span class=\"token operator\">=</span> <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n      notification<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> delay<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>目前 <code class=\"language-text\">requireInteraction</code> 的浏览器支持情况并不非常理想，只有 Chrome, Edge(17+) 和 Opera 做了支持。具体的支持列表，可以看<a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Notification/requireInteraction\">这里</a>。</p>\n<p>另外，从实际的使用上来看，Edge 浏览器中即使设置了 <code class=\"language-text\">requireInteraction</code>，notification 在一定时间之后也会消失，只是消失的时间会比原来默认的情况要长一些，大约是 25 秒。Chrome 的 Notification 如果设置了 <code class=\"language-text\">requireInteraction</code>，会多一个 Close 的按钮，展示效果和没有 <code class=\"language-text\">requireInteraction</code> 的情况有所不同。</p>","frontmatter":{"title":"custom display time of notification","category":"JavaScript","date":"2019-05-07"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"time":"2019-05-07","title":"custom display time of notification","previous":{"time":"2019-05-06","title":"context menu of electron"},"next":{"time":"2019-05-08","title":"debuglog in node.js"}}}}
{"componentChunkName":"component---src-templates-til-js","path":"/til/2019-05-24_css-for-dark-mode","webpackCompilationHash":"d0c1c456129354e33ddb","result":{"data":{"markdownRemark":{"id":"26dadd1a-c817-510f-93ad-ed148fd87706","html":"<p><code class=\"language-text\">prefers-color-scheme</code> 这个 Media Query 可以用于检测当前的操作系统是否选择了 Dark Mode。这是一个依然处于初始草案阶段的功能（见 <a href=\"https://drafts.csswg.org/mediaqueries-5/#descdef-media-prefers-color-scheme\">Draft</a>），不过 Safari (12.1) / Chrome (76) / Firefox (67) 的最新版本都已经做了支持。</p>\n<p>示例代码如下：</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token atrule\"><span class=\"token rule\">@media</span> <span class=\"token punctuation\">(</span><span class=\"token property\">prefers-color-scheme</span><span class=\"token punctuation\">:</span> dark<span class=\"token punctuation\">)</span></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> #333<span class=\"token punctuation\">;</span>\n    <span class=\"token property\">color</span><span class=\"token punctuation\">:</span> #fff<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token selector\">:not(pre) > code[class*=\"language-\"]</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">background-color</span><span class=\"token punctuation\">:</span> <span class=\"token function\">rgba</span><span class=\"token punctuation\">(</span>255<span class=\"token punctuation\">,</span>229<span class=\"token punctuation\">,</span>100<span class=\"token punctuation\">,</span>0.8<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>下面是一个可编辑的 CSS 代码，可以直接试一试：</p>\n<style>\nstyle.editable-style {\n  display: block;\n}\n</style>\n<p></p>\n<div class=\"gatsby-highlight\" style=\"border:1px solid red\">\n<pre class=\"language-css\"><code class=\"language-css\"><style contenteditable class=\"editable-style\">@media (prefers-color-scheme: dark) { body { /* try here */ } }</style></code></pre>\n</div>\n<p></p>\n<p>注：上面这段代码是可改的，修改后的 CSS 会直接生效。但是由于 <code class=\"language-text\">contenteditable</code> 的限制，所有代码需要在一行内完成。</p>\n<p>除了 <code class=\"language-text\">dark</code> 之外，<code class=\"language-text\">prefers-color-scheme</code> 可以接受的属性还有 <code class=\"language-text\">light</code> 和 <code class=\"language-text\">no-preference</code> 两种。其中，<code class=\"language-text\">light</code> 表示用户选择的是 Light 模式，<code class=\"language-text\">no-preference</code> 表示用户并没有做选择。</p>\n<p>在 JavaScript 中，也可以通过下面的代码来判断当前是否是 Dark Mode：</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> ifDarkMode <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span><span class=\"token function\">matchMedia</span><span class=\"token punctuation\">(</span><span class=\"token string\">'(prefers-color-scheme: dark)'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>matches<span class=\"token punctuation\">;</span></code></pre></div>\n<p>注：从当前的实验结果来看，<code class=\"language-text\">matchMedia</code> 的结果用 <code class=\"language-text\">.addListener</code> 注册回调事件并不能生效（Safari 12 测试）。</p>\n<p>如果图片的展示也需要区分，<code class=\"language-text\">mediaQuery</code> 也可以帮上忙：</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>picture</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>source</span> <span class=\"token attr-name\">srcset</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>mojave-night.jpg<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">media</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>(prefers-color-scheme: dark)<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>img</span> <span class=\"token attr-name\">src</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>mojave-day.jpg<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>picture</span><span class=\"token punctuation\">></span></span></code></pre></div>","frontmatter":{"title":"CSS for Dark Mode","category":"CSS","date":"2019-05-24"}}},"pageContext":{"isCreatedByStatefulCreatePages":false,"time":"2019-05-24","title":"CSS for Dark Mode","previous":{"time":"2019-05-23","title":"rxjs and hooks"},"next":{"time":"2019-05-27","title":"Recursively delete files by type"}}}}
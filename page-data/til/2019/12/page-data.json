{"componentChunkName":"component---src-templates-til-per-month-js","path":"/til/2019/12","result":{"data":{"site":{"siteMetadata":{"title":"LaySent's Site"}},"allMarkdownRemark":{"edges":[{"node":{"id":"6f7bce64-d072-5ef5-abd7-98cd4c6118b3","html":"<p>è¦çŸ¥é“ä¸€ä¸ªç½‘é¡µä¸­çš„æ–‡æœ¬ï¼Œå…·ä½“æ˜¯ä½¿ç”¨ä»€ä¹ˆå­—ä½“æ¸²æŸ“å‡ºæ¥çš„ï¼Œå¹¶ä¸æ˜¯éå¸¸ç®€å•çš„äº‹æƒ…ï¼Œå¯ä»¥æœ‰ä»¥ä¸‹ä¸€äº›æ–¹æ¡ˆè¿›è¡Œå°è¯•ã€‚</p>\n<section><h2>getComputedStyle</h2><p>ä½¿ç”¨ <code class=\"language-text\">window.getComputedStyle</code> å±æ€§è·å–å¯¹åº”å…ƒç´ çš„ <code class=\"language-text\">font-family</code> å­—æ®µã€‚å› ä¸ºå­—ä½“çš„è®¾ç½®ä¸€èˆ¬æ˜¯é€šè¿‡é¡¶å±‚é…ç½®ï¼Œå­å…ƒç´ ç»§æ‰¿çš„æ–¹å¼å®Œæˆçš„ï¼Œå› æ­¤åœ¨å¤§å¤šæ•°çš„å…ƒç´ ä¸Šï¼Œå¹¶æ²¡æœ‰ <code class=\"language-text\">font-family</code> è®¾ç½®ã€‚å³ä½¿æœ‰ï¼Œå¤§æ¦‚ç‡ä¹Ÿæ˜¯é€šè¿‡ CSS å®Œæˆçš„ï¼Œå› æ­¤ä» <code class=\"language-text\">.style</code> æˆ–è€… <code class=\"language-text\">.attributeStyleMap</code> æ— æ³•æ‹¿åˆ°éœ€è¦çš„æ•°æ®ã€‚<code class=\"language-text\">getComputedStyle</code> å¯ä»¥è·å–å½“å‰å…ƒç´ ä¸Šæ ·å¼çš„æœ€ç»ˆè®¡ç®—å€¼ï¼Œå› æ­¤å³ä½¿å­—ä½“å®é™…æ¥è‡ªäºç»§æ‰¿æˆ–è€…ç³»ç»Ÿé»˜è®¤å­—ä½“ï¼Œéƒ½å¯ä»¥é€šè¿‡è¯¥ API è·å–åˆ°ã€‚æ¯”å¦‚ï¼Œåœ¨ä¸€ä¸ªæ²¡æœ‰ CSS è®¾ç½®çš„é¡µé¢ä¸Šï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„ä»£ç çŸ¥é“å…·ä½“ä½¿ç”¨çš„ç³»ç»Ÿé»˜è®¤å­—ä½“æ˜¯ä»€ä¹ˆï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">window<span class=\"token punctuation\">.</span><span class=\"token function\">getComputedStyle</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>fontFamily<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// MacOS (Chrome): Times</span>\n<span class=\"token comment\">// Windows (Chrome): Microsoft YaHei</span></code></pre></div><p>éç¼–ç¨‹çš„æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨ Chrome DevTools ä¸­ç›´æ¥æ‰¾åˆ° Elements ä¸‹çš„ Computed éƒ¨åˆ†ï¼ŒæŸ¥çœ‹å®é™…ä½¿ç”¨çš„ CSS å±æ€§å€¼ã€‚æ³¨ï¼šå¦‚æœ <code class=\"language-text\">font-family</code> å¹¶æ²¡æœ‰è¢«å®šä¹‰è¿‡ï¼Œå¯ä»¥å‹¾é€‰ All æ¥æŸ¥çœ‹ç³»ç»Ÿé»˜è®¤çš„å±æ€§å€¼ã€‚</p><p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/2f6b9b41cfadb16613696e96a940262e/cb0d3/2019-12-04-computed-style.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 590px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 130.95975232198143%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAaCAYAAAC3g3x9AAAACXBIWXMAABYlAAAWJQFJUiTwAAAD40lEQVRIx5WVi2/aVhjF+Uv336ybFjKSNMnWbR1dq6pb1ocqVVMndWuabqFZIh62IZSHedoY24BtwOAXZ9+9EAYk1VpLB/va3OPfvd/1uTHXddFut1EsFlEqlTAYDKB1VOQlAYW8CLlawXg0Qr3egCSJME0ThmHw84juO47Dxfr1ej3EuIGmodPpoKt1oOs6qi0TUrmNS7mDgtyF0u1B73b5i9lz1rHf73MT27ZhWRZvM8UajQYymQw3VDUDFxkRZ2kJqQsBTdVEvalAlPKQ5Srevy8in5egKHNjBjIcDrnplWKe52E6nXIZtgfN8qDbPp199IYBgsCH7/vwvIX8FVHfTcVw0xF59BMAMx9R4GEW+iRvTez+TUdsNpthKboRei5aJ0mkn+9C/uM79M9+gn6ahJFKwkzdo/M99E7vwkw/5f9f609aErIGh/MnUI73UX71JaTfvoB5tgcnvY/B+W3YF/v82kxtQ0vdX/a76ssJNw1DbwLt7SE0cR9/v72FdOoWikIc8mWC9DUqhV30hD0yfPDxhuqbA7TEBB78voOthwfYe3yA5Mvvcfflj3iR2oOajn+aoXJMhsI2Hh0nkXj2DIknjxA/eoivjh7j+V930ElvoXP6CYbaySEU6TZSmS2c57bwTy6Oc4GJXW+jm91F991HGrKitGnIjkTKf0vnb2CJh1w2XQ8LdzDI7KLzoSGvlnxOOIZGVe4eJ6C/2eHSXieovbNoE92fcRjv7vNlg81ls/mGKAzg6jI8s/afDGrr1YUqXK5Rx2xldNfWYRRFcy3MZ/+jqz7XvhSWGCalx9KQFBIlF33HIZsGpYrw9RHCFz8g/HUX0eefIfplGz49sxZptUwbhxKiT9kW0MceBswoXBd7wdRFaCgI60WEpTSCVz/Dz57AJ1SWlSwfWaTxtDFbLYwokgYUYXa5jAklhjuZzEXhyzWZwvVpbsMILBKafQdCpU5G5iKJVtKmryoY5/MYCgJ8wmeUAZkt6VZpA5ZAEQ9bQZCIyOGFCFZGFtObDViZNCwhB7t4yc+WKGA86GNCGTkhwgm9YLIgZkTliox6o8mJ3JXnTLGBqmIsinzYbqOOMe0rXr/Hq705n0EY8krKtL+0FXW+bjf+E9Mbc8JBLgunViNCAQ7FPadbefMVISteqVzlhIz2ZkJJwpCG6ZIhI+TV3pw/RsjmkA5m1mi2rq8IRmjQTuaQoV0uwcpmiE5em7dNQjZvakdDJieiVKEvx5tuENJuxwgZ3Yh2NZeK9CFCJvbtdnUDWapyrd7kVV4jNInQpqI4NXk5H8v1d4PY7qjTQs4XiqjKNd5eff4vE5Ka/A6hyHoAAAAASUVORK5CYII='); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Screenshot of Chrome DevTools > Elements > Computed\"\n        title=\"\"\n        src=\"/static/2f6b9b41cfadb16613696e96a940262e/b9e4f/2019-12-04-computed-style.png\"\n        srcset=\"/static/2f6b9b41cfadb16613696e96a940262e/cf440/2019-12-04-computed-style.png 148w,\n/static/2f6b9b41cfadb16613696e96a940262e/d2d38/2019-12-04-computed-style.png 295w,\n/static/2f6b9b41cfadb16613696e96a940262e/b9e4f/2019-12-04-computed-style.png 590w,\n/static/2f6b9b41cfadb16613696e96a940262e/cb0d3/2019-12-04-computed-style.png 646w\"\n        sizes=\"(max-width: 590px) 100vw, 590px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p></section>\n<section><h2>Rendered Fonts</h2><p>ä½¿ç”¨ <code class=\"language-text\">getComputedStyle</code> åªèƒ½å¾—åˆ°å®é™…ä½¿ç”¨çš„ CSS å±æ€§å€¼ï¼Œæœ‰æ—¶å€™å¹¶ä¸èƒ½å‡†ç¡®è¡¨è¾¾å®é™…çœŸå®ä½¿ç”¨çš„å…·ä½“å­—ä½“ç±»å‹ã€‚</p><p>ä¸¾ä¾‹æ¥è¯´ï¼Œä¸€ä¸ª <code class=\"language-text\">font-family</code> å®šä¹‰å¯èƒ½æ˜¯ï¼š</p><div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token selector\">body</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token property\">font-family</span><span class=\"token punctuation\">:</span>\n    <span class=\"token string\">'Rubik'</span><span class=\"token punctuation\">,</span>\n    -apple-system<span class=\"token punctuation\">,</span> <span class=\"token string\">'system-ui'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'BlinkMacSystemFont'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'PingFang SC'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Segoe UI'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Roboto'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Oxygen'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Ubuntu'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Cantarell'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Fira Sans'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Droid Sans'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Helvetica Neue'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Helvetica'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Arial'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'Hiragino Sans GB'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'Microsoft Yahei'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'WenQuanYi Micro Hei'</span><span class=\"token punctuation\">,</span> sans-serifï¼›\n<span class=\"token punctuation\">}</span></code></pre></div><p>åœ¨å¦‚æ­¤ä¼—å¤šçš„å®šä¹‰ä¸­ï¼Œå…·ä½“æµè§ˆå™¨ä½¿ç”¨äº†å“ªä¸€æ¬¾å­—ä½“ï¼Œå¹¶ä¸å®¹æ˜“çŸ¥é“ã€‚è¿™å…¶ä¸­æ¶‰åŠåˆ°äº†å¤§é‡çš„å˜é‡ã€‚ç”¨æˆ·ä½¿ç”¨çš„ç³»ç»Ÿç¯å¢ƒã€å­—ä½“ä¸‹è½½æƒ…å†µã€æ­£åœ¨é˜…è¯»çš„æ–‡å­—æ˜¯ä¸­æ–‡è¿˜æ˜¯è‹±æ–‡ç­‰ï¼Œè¿™äº›éƒ½æœ‰å¯èƒ½å½±å“åˆ°æœ€ç»ˆæµè§ˆå™¨æ‰€é€‰ç”¨çš„å­—ä½“ã€‚ç”šè‡³åœ¨ä¸å¤æ‚çš„ <code class=\"language-text\">font-family</code> è®¾ç½®ä¸‹ï¼Œæœ€ç»ˆçš„é€‰ç”¨å­—ä½“ä¾ç„¶å¯èƒ½å¹¶ä¸ç›´è§‚ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœè®¾ç½® CSS ä¸ºï¼š<code class=\"language-text\">font-family: system-ui</code>ï¼Œå…·ä½“ä½¿ç”¨çš„å­—ä½“å¹¶æ²¡æœ‰ä»è®¾ç½®çš„å­—æ®µä¸­ç›´è§‚çš„åé¦ˆå‡ºæ¥ã€‚</p><p>Chrome DevTools æä¾›äº†ä¸€ä¸ª Rendered Fonts åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©å¼€å‘è€…äº†è§£å½“å‰çœŸå®ä½¿ç”¨çš„å­—ä½“ã€‚ç¤ºæ„å›¾å¦‚ä¸‹ï¼š</p><p>\n  <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dc6b98d142218bfc4e588ffbe34ab2d0/26dcc/2019-12-04-rendered-fonts.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n  \n  <span\n    class=\"gatsby-resp-image-wrapper\"\n    style=\"position: relative; display: block;  max-width: 538px; margin-left: auto; margin-right: auto;\"\n  >\n    <span\n      class=\"gatsby-resp-image-background-image\"\n      style=\"padding-bottom: 187.36059479553904%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAlCAYAAABCr8kFAAAACXBIWXMAABYlAAAWJQFJUiTwAAAFB0lEQVRIx51WyW4bRxCdjw5yygfkB5KD7zkFCAIYQbwFgeEttixS3HeJ5HAdchbOvvLlVZMjUbJkC27goXt6ZqpreVXVWhAE2Gw26PV6GI1GGA6H0HUdnh9gZjj4XO/hvN5HpdHHYLyC4/pYr1YIwxDyr+d52O12sCxLydGWyyUGgwEmk4l6sd0YuLocot/voUohnaGO+cZFpTnEh/M2qvUWut0uqtUqarUarq6ulKDFYqGEa9vtVmk36PdhmhauZgZqrQEq9S7RRrM7xMa00e92UK9dUFgHrVZLCRSMx2Ol3Ypa+74PLc9zlCPNcpgB4EQH7GLAljks8NAoigJZll3Pmmzu93tCrbAvMs65Whd5gjyLOadI0+QWkkSQqn9Ph3YQdtiUE1zXw2K1wehqBj/kT+keYZwjIuK0QJwckGYFgxJSeIobpfY3GsoQ813XRaf+Bp/fP8V08B/MRQ3bWRXm/AIW1/JsLWswZnX4DEKaZTiVcUug+MG2LTjT59Dbf6BX+R3R6iUK818k65dIN6+QGv8g5+zpTxlEg0oUDwvMRaBlwtFfIfaXGF1ekgFdzGa68qP4MxP/RQ682QtY5gbZ1wQWxZ4UOAiMfAMrw8RkqqM/GMFxdjBJDz+IKNA7CvyGhiJwu93AHL9A6K4YkAxbc0vyjrE2eMB6Ta4FCDybbnnGJFg9wmT60J6+Qp44KsLCzYwRTdJyZoSTEO7s5eNNdvVn2NtvkFsfUNgfkJrvkJnvkXOtYL1FMP/r2yYfaLODMT2DM38He0ZwtvS3CuqZkHfG5D1z36HW+W2Bd4kdhpEyL4i4FsQZCZ4iIGQdHvfjhGSPoq8TW+YojhETScI5KdfJzd7JHFKgcPcLDcsNeVme9BjcNzQpkpZpImLBFB+K2QK1Vs/59b7MYqJAtJYia9ukkOOolBVoATcnrNA+1T+q+mCpuquVPM/nM2bSTNVDg1zVRGrIhT+dIuBJEUuSaCsOP4VYIi5pt9t4/fo1ib7BJQlv2w7Jb1LgmpSzoRlkv91swm2werD6xqy6ydGkU0gQZEi1/vvZc3S6fZWWko4GW4BkkgjXXPYRj/0jYAvwW01E1DSnQIFoJH4rISa6no/Fco2pPlN7KsongdWkg1ntFmz2ix2ri/nxI6xKBTtqGx5NLRHHkTKt0WxTwx5anS4Lx1AV5fIbRZuc2ZFRdcGpw++jSRwnLBKG4ut932oBfebQ0Q59s2P3c6Wdsk0GrMaioVCj7MHiS302R6PVVi2z3C+/EWgZfeV3OtidfYLXaChfevUaYgYr54klL7NjqZ/Pl8rkIs9v8baEllB1f0Q/NBvwhwNWkTmCxRwhfZsKkZPkmsgSgDUPavaGvFn41yQ/hSacC8ijgA0/pBkxT4n4QuGEj2J+HAbYRTHmrRqW0wn34i/4eqg2pXPvOPh2Rz9eCFYT4O2fN1l1ty/jUeP4U+gBv/0MRMGDX2oWk1vYLrMwXa2ZQnJxKqMoDT0MfGS//ICw9g4iLjhG+S60erOFT2fn+Fyp4rxygWa7g8pFDbV6U1Vvhwfs2EeSX39E/OQn2BTmsHE5PFCqjKUUuIEmoV6S/XNexwTS2URbOU0iqa541NhsVeCy38heeSf074m0un1VLuoqjc7Oq7igZv3hSHFMTB9djjEYXmKoL7DZmtiwCMxJLYFJdnzhw/1X6t+jwnUnPbXvLf8PtQHte4Q8BFHqf1USFQCODxGiAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"\n    >\n      <img\n        class=\"gatsby-resp-image-image\"\n        style=\"width: 100%; height: 100%; margin: 0; vertical-align: middle; position: absolute; top: 0; left: 0; box-shadow: inset 0px 0px 0px 400px white;\"\n        alt=\"Screenshot of Chrome DevTools > Elements > Computed > Rendered Fonts\"\n        title=\"\"\n        src=\"/static/dc6b98d142218bfc4e588ffbe34ab2d0/26dcc/2019-12-04-rendered-fonts.png\"\n        srcset=\"/static/dc6b98d142218bfc4e588ffbe34ab2d0/cf440/2019-12-04-rendered-fonts.png 148w,\n/static/dc6b98d142218bfc4e588ffbe34ab2d0/d2d38/2019-12-04-rendered-fonts.png 295w,\n/static/dc6b98d142218bfc4e588ffbe34ab2d0/26dcc/2019-12-04-rendered-fonts.png 538w\"\n        sizes=\"(max-width: 538px) 100vw, 538px\"\n      />\n    </span>\n  </span>\n  \n  </a>\n    </p><p>Chrome ä¼šå°†å½“å‰é€‰ä¸­å…ƒç´ çœŸå®ä½¿ç”¨çš„æ‰€æœ‰å­—ä½“éƒ½åˆ—å‡ºæ¥ã€‚éœ€è¦æ³¨æ„ä¸¤ç‚¹ï¼š</p><ol>\n<li>éœ€è¦é€‰ä¸­ä¸€ä¸ªæœ‰æ–‡å­—å†…å®¹çš„å…ƒç´ ï¼Œä¸ç„¶è¿™é‡Œå¹¶ä¸ä¼šæ˜¾ç¤ºï¼›</li>\n<li>\n<p>é€‰ä¸­çš„æ–‡å­—å†…å®¹å¯èƒ½éœ€è¦å¤šç§å­—ä½“ç±»å‹å…±åŒé…åˆæ¸²æŸ“ï¼ŒChrome ä¼šè®²æ‰€æœ‰ç”¨åˆ°çš„å…ƒç´ éƒ½åˆ—ä¸¾å‡ºæ¥ã€‚</p>\n<p>æ¯”å¦‚ï¼Œ<code class=\"language-text\">ç¬‘ï¼ŒğŸ˜Šï¼Œsmile</code> è¿™æ ·ä¸€æ®µæ–‡å­—ï¼Œåœ¨ MacOS Chrome ä¸‹ï¼Œé»˜è®¤å°±éœ€è¦ä»¥ä¸‹ä¸‰ç§å­—ä½“æ¥è¿›è¡Œæ¸²æŸ“ï¼š</p>\n<ul>\n<li>Timesï¼ˆæ¸²æŸ“è‹±æ–‡ï¼‰</li>\n<li>Songti SCï¼ˆæ¸²æŸ“ä¸­æ–‡ï¼‰</li>\n<li>Apple Color Emojiï¼ˆæ¸²æŸ“ emojiï¼‰</li>\n</ul>\n<p>ä»¥ä¸Šä¸‰ç§å­—ä½“åœ¨ Rendered Fonts ä¸­éƒ½ä¼šè¢«åˆ—ä¸¾å‡ºæ¥ã€‚</p>\n</li>\n</ol><p>Chrome çš„ Blog ä»‹ç»å¯ä»¥æŸ¥çœ‹<a href=\"https://developers.google.com/web/updates/2013/09/DevTools-answers-What-font-is-that\">è¿™é‡Œ</a>ã€‚</p><p>è¿™ä¸€æ–¹æ¡ˆæš‚æ—¶æ²¡æœ‰ JavaScript API å¯ä»¥ç›´æ¥è°ƒç”¨ï¼Œæ— æ³•åœ¨ç¨‹åºè¿è¡Œæ—¶è¿›è¡Œè‡ªåŠ¨çš„åˆ¤æ–­ã€‚</p></section>","frontmatter":{"date":"2019-12-04","title":"Rendered Fonts","category":"Chrome"}}},{"node":{"id":"ddf203aa-1bf8-5e71-9ad4-a9dbe9bd9530","html":"<p>åœ¨ JavaScript ä¸­ï¼Œç›´æ¥å®šä¹‰ä¸€ä¸ªå¯¹è±¡ï¼ˆObjectï¼‰ï¼Œæ€§èƒ½ä¸Šä¸è¿œå¦‚å®šä¹‰ä¸€ä¸ª <code class=\"language-text\">JSON.parse()</code> çš„è¡¨è¾¾å¼ã€‚å…·ä½“æ¥è¯´ï¼Œä¸‹é¢çš„ä¸¤è¡Œï¼Œ<code class=\"language-text\">JSON.parse</code> çš„è¡¨è¾¾å¼ä¼šæœ‰æ›´å¥½çš„æ€§èƒ½è¡¨ç°ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> slow <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> foo<span class=\"token punctuation\">:</span> <span class=\"token number\">42</span><span class=\"token punctuation\">,</span> bar<span class=\"token punctuation\">:</span> <span class=\"token number\">1337</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> fast <span class=\"token operator\">=</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span><span class=\"token string\">'{\"foo\":42,\"bar\":1337}'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>åŒæ ·çš„æ•ˆæœï¼Œä½†æ˜¯åœ¨ JavaScript å¼•æ“ä¸­çš„è¡¨ç°å´å·®åˆ«å¾ˆå¤§ã€‚æ ¹æ®<a href=\"https://github.com/GoogleChromeLabs/json-parse-benchmark\">è¿™é‡Œ</a>ç»™å‡ºçš„æµ‹è¯•æ•°æ®ï¼Œ<code class=\"language-text\">JSON.parse</code> çš„é€Ÿåº¦æ˜¯ç›´æ¥å†™å¯¹è±¡é€Ÿåº¦çš„ 1.7 å€ã€‚è€Œä¸”è¿™ä¸ä»…ä»…åªæ˜¯ V8 è¡¨ç°ä¸Šçš„ä¸åŒï¼Œåœ¨å„ç±» JavaScript å¼•æ“ä¸Šéƒ½æœ‰ç±»ä¼¼çš„è¡¨ç°ï¼Œæ€§èƒ½å·®å¼‚å‡éå¸¸æ˜æ˜¾ï¼ˆ<a href=\"https://developer.apple.com/documentation/javascriptcore\">JavaScriptCore</a> çš„æ€§èƒ½å·®å¼‚å¯ä»¥åˆ°ä¸¤å€ï¼‰ã€‚</p>\n<p>è¿™é‡Œå·®å¼‚çš„ä¸»è¦åŸå› åœ¨äºï¼Œå¼•æ“åœ¨è§£ææ—¶å€™ç®—æ³•å¤æ‚åº¦æœ‰ç€å·¨å¤§çš„å·®å¼‚ã€‚ç®€å•æ¥è¯´ï¼ŒJSON çš„æ•°æ®ç»“æ„æ˜¯éå¸¸ç®€å•ä¸”å›ºå®šçš„ï¼Œå› è€Œåœ¨è§£æçš„æ—¶å€™å¯ä»¥æœ‰æ›´å¥½çš„è¡¨ç°ã€‚è¿™ç§ç®€å•ä½“ç°åœ¨ä»¥ä¸‹å‡ ä¸ªæ–¹é¢ï¼š</p>\n<ol>\n<li>JSON çš„æ•°æ®æ”¯æŒç±»å‹ä¸å¤šï¼Œåªæœ‰å­—ç¬¦ä¸²ï¼Œæ•°ç»„ï¼Œæ•°å­—ï¼ŒNULLï¼Œå¯¹è±¡è¿™å‡ ç§ï¼›ç›¸æ¯”ä¹‹ä¸‹ï¼ŒJavaScript ä¸­ä¸€ä¸ªå¯¹è±¡çš„æ”¯æŒç±»å‹éå¸¸çš„å¤æ‚ï¼Œæƒ…å†µæ›´å¤šï¼›</li>\n<li>ä»æŠ½è±¡è¯­æ³•æ ‘ï¼ˆASTï¼‰çš„è§’åº¦çœ‹ï¼Œ<code class=\"language-text\">JSON.parse</code> çš„æƒ…å†µæ¯”å•çº¯å†™ä¸€ä¸ª JavaScript å¯¹è±¡è¦ç®€å•çš„å¤šã€‚å¯¹äºå‰è€…æ¥è¯´ï¼Œå°±æ˜¯ä¸€ä¸ª CallExpression å’Œä¸€ä¸ª StringLiteralï¼›è€Œå¯¹äºä¸€ä¸ª JavaScript å¯¹è±¡æ¥è¯´ï¼Œæ¶‰åŠåˆ°å¤§é‡çš„ ObjectExpressionï¼Œå½“ä¸­å¯èƒ½è¿˜åŒ…å« StringLiteralï¼ŒNumericLiteralï¼ŒIdentifier ç­‰ç­‰ï¼›</li>\n<li>JSON çš„è§£ææ˜¯ä¸Šä¸‹æ–‡æ— å…³çš„ï¼›è€Œ JavaScript å¯¹è±¡çš„è§£æå´éœ€è¦ç»“åˆå½“å‰çš„ä¸Šä¸‹æ–‡ï¼ˆcontextï¼‰æ¥ç¡®å®šï¼›</li>\n</ol>\n<p>ä¸¾ä¸€ä¸ªä¾‹å­æ¥è¯´æ˜ï¼šå‡è®¾æœ‰è¿™æ ·ä¸€ä¸ª JavaScript ä»£ç ç‰‡æ®µï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> x <span class=\"token operator\">=</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> y <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> x <span class=\"token punctuation\">}</span></code></pre></div>\n<p>è¿™é‡Œçš„ <code class=\"language-text\">x</code> ä»£è¡¨ä»€ä¹ˆå«ä¹‰ï¼Œå…¶å®æœ‰éå¸¸å¤šçš„å¯èƒ½æ€§ï¼Œæ¯”å¦‚ï¼š</p>\n<ul>\n<li><code class=\"language-text\">const y = ({ x })</code>ï¼Œæ­¤æ—¶ <code class=\"language-text\">x</code> çš„å€¼å’Œä¸Šä¸‹æ–‡ä¸­çš„ <code class=\"language-text\">x</code> å˜é‡æ˜¯ç›¸å…³çš„ï¼Œå®šä¹‰æ˜¯ä¸€ä¸ª JavaScript å¯¹è±¡ï¼›</li>\n<li><code class=\"language-text\">const y = ({ x } = { x: 2 })</code>ï¼Œæ­¤æ—¶ <code class=\"language-text\">x</code> å’Œä¸Šä¸‹æ–‡æ˜¯ç›¸å…³çš„ï¼Œä½†å®šä¹‰çš„æ˜¯ä¸€ä¸ªèµ‹å€¼è¯­å¥ï¼Œè€Œä¸æ˜¯å¯¹è±¡ï¼ˆæ ¹æ®è¯­æ³•ï¼Œå¯¹ <code class=\"language-text\">const</code> äºŒæ¬¡èµ‹å€¼å¯¼è‡´è¯­æ³•é”™è¯¯ï¼‰ï¼›</li>\n<li><code class=\"language-text\">const y = ({ x }) =&gt; x;</code>ï¼Œæ­¤æ—¶ <code class=\"language-text\">x</code> çš„å€¼å’Œä¸Šé¢çš„ <code class=\"language-text\">x</code> æ— å…³ï¼Œæ˜¯ä¸€ä¸ªå‡½æ•°çš„å‚æ•°ï¼›</li>\n</ul>\n<p>æ¢å¥è¯è¯´ï¼Œå½“ JavaScript å¼•æ“åœ¨è§£æä¸€ä¸ª JavaScript å¯¹è±¡çš„æ—¶å€™ï¼Œéœ€è¦è€ƒè™‘å¾ˆå¤šçš„å¯èƒ½æ€§ï¼Œåœ¨è§£æçš„è¿‡ç¨‹ä¸­å¾ˆå¯èƒ½æ— æ³•ç¡®å®šå½“å‰çš„ç±»å‹ï¼Œç”šè‡³è¿è¯­æ³•æ˜¯å¦æ­£ç¡®ä¹Ÿä¸èƒ½ç¡®å®šã€‚ä½†åè§‚ JSONï¼Œå®šä¹‰å°±ç®€å•çš„å¤šï¼Œåœ¨è§£æçš„å½“ä¸‹ï¼Œå¼•æ“å°±å¯ä»¥å¾ˆæ¸…æ¥šçš„çŸ¥é“å½“å‰çš„å†…å®¹æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¿˜æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œäº¦æˆ–æ˜¯æœ‰è¯­æ³•é”™è¯¯ã€‚</p>\n<p>é™¤äº†ä¸Šè¿°æåˆ°çš„æ€§èƒ½æ¯”è¾ƒæ•°æ®ä¹‹å¤–ï¼Œ<a href=\"https://joreteg.com/blog/improving-redux-state-transfer-performance\">è¿™é‡Œ</a>è¿˜æœ‰ä¸€ä»½é’ˆå¯¹ Redux åº”ç”¨çš„ä¼˜åŒ–åˆ†æã€‚æ•°æ®æ˜¾ç¤ºï¼Œä½¿ç”¨ <code class=\"language-text\">JSON.parse</code> è°ƒç”¨ä¹‹å TTI (Time To Interactive) æ—¶é—´ç¼©çŸ­äº† 0.74s (18%)ã€‚è€ƒè™‘åˆ°æ•´ä¸ªæ”¹åŠ¨æ˜¯éå¸¸â€œç®€å•â€çš„ï¼Œè¿™ä¸€æ€§èƒ½æå‡æ˜¾å¾—éå¸¸å®¢è§‚ã€‚</p>\n<p>è¿™é‡Œä¹‹æ‰€ä»¥è¯´æ”¹åŠ¨æ˜¯éå¸¸â€œç®€å•â€çš„ï¼Œæ˜¯å› ä¸ºæ•´ä¸ªä¼˜åŒ–æ€è·¯éå¸¸çš„æ˜ç¡®ï¼Œå®Œå…¨å¯ä»¥é€šè¿‡å¯¹åº”çš„å·¥å…·åœ¨ç¼–è¯‘æ—¶å®Œæˆã€‚ç›®å‰å¼€æºç¤¾åŒºå·²ç»æä¾›äº†å„ç±»ç›¸å…³çš„å·¥å…·ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œåˆ—ä¸¾ä¸€äº›å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>Webpackï¼ˆ<a href=\"https://github.com/webpack/webpack/releases/tag/v4.35.3\">v4.35.3</a> æˆ–ä»¥ä¸Šï¼‰é»˜è®¤ä¼šå°† JSON æ‰“åŒ…æˆ <code class=\"language-text\">JSON.parse()</code>ï¼›ä½¿ç”¨ <code class=\"language-text\">json-loader</code> å¯ä»¥å»æ‰è¿™ä¸€ä¼˜åŒ–ï¼ˆå…·ä½“è§è¿™ä¸ª <a href=\"https://github.com/webpack/webpack/pull/9349\">Pull Request</a>ï¼‰ï¼›</li>\n<li>ä¸€äº› Babel Plugin æ”¯æŒå°†æ»¡è¶³è¦æ±‚çš„ JavaScript å¯¹è±¡è½¬åŒ–æˆ <code class=\"language-text\">JSON.parse</code> è¯­æ³•ï¼Œæ¯”å¦‚ <a href=\"https://github.com/nd-02110114/babel-plugin-object-to-json-parse\">babel-plugin-object-to-json-parse</a> æˆ– <a href=\"https://github.com/keyz/babel-plugin-transform-optimize-object-literal\">babel-plugin-transform-optimize-object-literal</a>ã€‚</li>\n</ul>","frontmatter":{"date":"2019-12-03","title":"Cost of parsing JSON","category":"JavaScript"}}},{"node":{"id":"1f47e54e-3226-5831-b830-c394c36ddda6","html":"<p>Node.js çš„ Docker æœ‰åŸºäº Alpine çš„ç‰ˆæœ¬ã€‚åœ¨è¿™ä¸ª Docker ä¸­ä½¿ç”¨ <a href=\"https://github.com/develar/7zip-bin\">7zip-bin</a> åº“çš„æ—¶å€™é‡åˆ°äº†é”™è¯¯ï¼Œæ— æ³•æ­£å¸¸å¯åŠ¨ã€‚</p>\n<p>ä¸€ä¸ªç®€å•çš„é‡ç° <code class=\"language-text\">Dockerfile</code> å¯ä»¥è¿™ä¹ˆå†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token keyword\">FROM</span> node<span class=\"token punctuation\">:</span>10<span class=\"token punctuation\">-</span>alpine\n\n<span class=\"token keyword\">RUN</span> mkdir <span class=\"token punctuation\">-</span>p example &amp;&amp; \\\n  cd example &amp;&amp; \\\n  yarn init <span class=\"token punctuation\">-</span>y &amp;&amp; \\\n  yarn add 7zip<span class=\"token punctuation\">-</span>bin &amp;&amp; \\\n  mkdir /lib64 &amp;&amp; \\\n  ln <span class=\"token punctuation\">-</span>s /lib/libc.musl<span class=\"token punctuation\">-</span>x86_64.so.1 /lib64/ld<span class=\"token punctuation\">-</span>linux<span class=\"token punctuation\">-</span>x86<span class=\"token punctuation\">-</span>64.so.2\n\n<span class=\"token keyword\">ADD</span> run.sh /run.sh\n\n<span class=\"token keyword\">RUN</span> chmod +x /run.sh\n\n<span class=\"token keyword\">CMD</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"/run.sh\"</span><span class=\"token punctuation\">]</span></code></pre></div>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">run.sh</code> å¯ä»¥å†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">cd</span> example\n<span class=\"token variable\"><span class=\"token variable\">$(</span>node -e \"console.log<span class=\"token punctuation\">(</span>require<span class=\"token punctuation\">(</span><span class=\"token string\">'7zip-bin'</span><span class=\"token punctuation\">)</span>.path7za<span class=\"token variable\">)</span></span>\"<span class=\"token punctuation\">)</span></code></pre></div>\n<p>æŠ¥é”™çš„å†…å®¹æ˜¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">/run.sh: line 2: /example/node_modules/7zip-bin/linux/x64/7za: not found</code></pre></div>\n<p>é€šè¿‡è¿›å…¥ Docker å†…éƒ¨è§‚å¯Ÿä¸éš¾å‘ç°ï¼Œ<code class=\"language-text\">/example/node_modules/7zip-bin/linux/x64/7za</code> è¿™ä¸ªæ–‡ä»¶å®é™…æ˜¯çœŸå®å­˜åœ¨çš„ï¼Œä½†æ˜¯åœ¨ä½¿ç”¨çš„æ—¶å€™ç³»ç»Ÿå´æŠ¥é”™ <code class=\"language-text\">not found</code>ã€‚é€ æˆè¿™ä¸€é—®é¢˜çš„åŸå› ï¼Œå¯èƒ½æ˜¯åŠ¨æ€åº“ç¼ºå¤±ã€‚</p>\n<p>é€šè¿‡ <code class=\"language-text\">ldd</code> å‘½ä»¤å¯ä»¥åˆ—å‡ºåŠ¨æ€åº“ä¾èµ–å…³ç³»ï¼ˆ<a href=\"https://linux.die.net/man/1/ldd\">æ–‡æ¡£</a>ï¼‰ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">ldd /example/node_modules/7zip-bin/linux/x64/7za</code></pre></div>\n<p>è¾“å‡ºç»“æœæ˜¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">/lib64/ld-linux-x86-64.so.2 (0x7febe540e000)\nlibpthread.so.0 =&gt; /lib64/ld-linux-x86-64.so.2 (0x7febe540e000)\nlibstdc++.so.6 =&gt; /usr/lib/libstdc++.so.6 (0x7febe52b9000)\nlibm.so.6 =&gt; /lib64/ld-linux-x86-64.so.2 (0x7febe540e000)\nlibgcc_s.so.1 =&gt; /usr/lib/libgcc_s.so.1 (0x7febe52a5000)\nlibc.so.6 =&gt; /lib64/ld-linux-x86-64.so.2 (0x7febe540e000)</code></pre></div>\n<p>æ³¨æ„åˆ°ç¼ºå°‘äº† <code class=\"language-text\">/lib64/ld-linux-x86-64.so.2</code> è¿™ä¸ªåŠ¨æ€åº“ï¼Œå› æ­¤å¯¼è‡´äº† <code class=\"language-text\">7zip-bin</code> è¿™ä¸ªåº“æ— æ³•æ­£å¸¸ä½¿ç”¨ã€‚é€ æˆè¿™ä¸ªçš„åŸå› æ˜¯ï¼ŒAlpine ä½¿ç”¨çš„æ˜¯ <a href=\"https://www.musl-libc.org/\">musl</a>ï¼Œè€Œ <code class=\"language-text\">7zip-bin</code> ä½¿ç”¨çš„äºŒè¿›åˆ¶æ–‡ä»¶æ˜¯åŸºäº glibc ç¼–è¯‘å‡ºæ¥çš„ã€‚è¦è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæœ‰ä¸¤ç§æ€è·¯ï¼š</p>\n<ol>\n<li>åœ¨ Alpine ä¸­å®‰è£… libc çš„å…¼å®¹åº“ï¼š<code class=\"language-text\">RUN apk add --no-cache libc6-compat</code>ï¼›</li>\n<li>æˆ–è€…ï¼Œ<code class=\"language-text\">ln -s /lib/libc.musl-x86_64.so.1 /lib/ld-linux-x86-64.so.2</code> å°† musl çš„ç‰ˆæœ¬è½¯è¿è¿‡å»ï¼Œç›´æ¥è®© <code class=\"language-text\">7zip-bin</code> çš„äºŒè¿›åˆ¶ä½¿ç”¨</li>\n</ol>\n<p>å½“ç„¶ï¼Œæœ€ä½³çš„æ–¹æ¡ˆæ˜¯ä¸ä½¿ç”¨ <code class=\"language-text\">7zip-bin</code> ä¸­çš„ pre-build ç‰ˆæœ¬ï¼Œè€Œæ”¹ç”¨ Alpine çš„ <a href=\"https://pkgs.alpinelinux.org/package/edge/main/x86/p7zip\">p7zip</a> ç‰ˆæœ¬ã€‚ç”¨ Alpine çš„åŒ…ç®¡ç†å™¨å®‰è£…å¥½ <code class=\"language-text\">pz7ip</code> ä¹‹åï¼ˆ<code class=\"language-text\">apk add p7zip</code>ï¼‰ï¼Œä½¿ç”¨ç±»ä¼¼ä¸‹é¢çš„ä»£ç ç›´æ¥æ›¿æ¢è„šæœ¬å°±å¥½äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">cp</span> <span class=\"token variable\"><span class=\"token variable\">$(</span><span class=\"token builtin class-name\">type</span> -p 7za<span class=\"token variable\">)</span></span> <span class=\"token variable\"><span class=\"token variable\">$(</span>node -p <span class=\"token string\">\"require('7zip-bin').path7za\"</span><span class=\"token variable\">)</span></span></code></pre></div>\n<section><h2>å‚è€ƒé“¾æ¥</h2><ul>\n<li>åœ¨ 7zip-bin issue ä¸­çš„<a href=\"https://github.com/develar/7zip-bin/issues/8\">ç›¸å…³è®¨è®º</a></li>\n<li>é‡ç°çš„é…ç½®ä»£ç  <a href=\"https://gist.github.com/laysent/b12faceac4bcf10bee04aabfa505c244\">gist</a></li>\n<li>node-gyp åœ¨ Alpine ä¸­ä¹Ÿå¯èƒ½ä¼šé‡åˆ°ç±»ä¼¼çš„é—®é¢˜ï¼Œåœ¨<a href=\"https://medium.com/devgorilla/node-gyp-support-in-alpine-linux-9374c6191140\">è¿™é‡Œ</a>å¯ä»¥æ‰¾åˆ°ç›¸å…³çš„è®¨è®º</li>\n</ul></section>","frontmatter":{"date":"2019-12-02","title":"7zip-bin in Alpine Docker","category":"Docker"}}},{"node":{"id":"fd022b7a-07a5-588c-83eb-4dc5e5ec807c","html":"<p><code class=\"language-text\">arguments.callee</code> æ˜¯ä¸€ä¸ªä¸åº”è¯¥è¢«ä½¿ç”¨çš„ APIï¼Œåœ¨ä¸¥æ ¼æ¨¡å¼ä¸‹ä½¿ç”¨ä¼šç›´æ¥æŠ¥é”™ã€‚è¿™é‡Œä»…ä»…æ˜¯ä½œä¸ºäº†è§£ï¼Œè®°å½•ä¸€ä¸‹è¯¥ API çš„ä½œç”¨ã€‚</p>\n<p>åœ¨æ—©æœŸçš„ JavaScript ç‰ˆæœ¬ä¸­ï¼Œä¸å…è®¸å†™å¸¦åå­—çš„å‡½æ•°è¡¨è¾¾å¼ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚æœéœ€è¦åšé€’å½’è°ƒç”¨ï¼Œå°±æ— æ³•æ˜¾å¼å¾—æŒ‡æ˜éœ€è¦è°ƒç”¨çš„å‡½æ•°åç§°ã€‚<code class=\"language-text\">arguments.callee</code> è¿™ä¸ªå€¼ï¼ŒæŒ‡å‘äº†å½“å‰è¢«è°ƒç”¨çš„å‡½æ•°æœ¬èº«ï¼Œå› æ­¤å¯ä»¥åœ¨åŒ¿åå‡½æ•°é€’å½’è°ƒç”¨ä¸­è¢«ä½¿ç”¨ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œåœ¨æ—©æœŸçš„ JavaScript ä¸­ï¼Œ<code class=\"language-text\">Array.prototype.map</code> å‡½æ•°ç»™å®šçš„å›è°ƒå‡½æ•°åªèƒ½æ˜¯åŒ¿åçš„ï¼Œå¦‚æœè¦å®ç°ä¸€ä¸ªé˜¶ä¹˜å‡½æ•°ï¼Œåªèƒ½è¿™ä¹ˆå†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> arguments<span class=\"token punctuation\">.</span><span class=\"token function\">callee</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> num<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç„¶è€Œï¼Œ<code class=\"language-text\">arguments.callee</code> çš„è°ƒç”¨ä¼šå¯¼è‡´ <code class=\"language-text\">this</code> çš„æŒ‡å‘å‡ºç°é—®é¢˜ï¼ˆå…·ä½“è§ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee\">MDN</a>ï¼‰ï¼Œä½¿ç”¨èµ·æ¥æ¯”è¾ƒå±é™©ã€‚</p>\n<p>åœ¨ ECMAScript 3 ä¸­å·²ç»æ”¯æŒäº†å¸¦å‡½æ•°åçš„è¡¨è¾¾å¼ï¼Œå› æ­¤ä¸Šé¢çš„ä»£ç å¯ä»¥ç®€å•çš„æ”¹å†™ä¸ºä¸€ä¸‹è¿™ç§æ­£å¸¸çš„å†™æ³•ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">function</span> <span class=\"token function\">factorial</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>n <span class=\"token operator\">></span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">factorial</span><span class=\"token punctuation\">(</span>num <span class=\"token operator\">-</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> num<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ¢å¥è¯è¯´ï¼Œåªéœ€è¦ç»™å‡½æ•°æŒ‡å®šåç§°ï¼Œå°±å¯ä»¥è§„é¿ç»å¤§å¤šæ•°çš„ <code class=\"language-text\">arguments.callee</code> ä½¿ç”¨äº†ï¼ˆæ³¨ï¼šåŒ¿åå‡½æ•°/ç®­å¤´å‡½æ•°æ— æ³•æŒ‡å®šåç§°ï¼Œä½†åŒæ—¶è§„èŒƒä¹Ÿæ˜ç¡®äº†åŒ¿åå‡½æ•°ä¸­æ²¡æœ‰ <code class=\"language-text\">arguments</code>ï¼‰ã€‚</p>\n<p><a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Functions/arguments/callee\">MDN</a> ç»™å‡ºäº†ä¸€ä¸ª <code class=\"language-text\">arguments.callee</code> æ— æ³•æ›¿æ¢çš„åœºæ™¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">createPerson</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">sIdentity</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> oPerson <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Function</span><span class=\"token punctuation\">(</span><span class=\"token string\">'alert(arguments.callee.identity);'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  oPerson<span class=\"token punctuation\">.</span>identity <span class=\"token operator\">=</span> sIdentity<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> oPerson<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> john <span class=\"token operator\">=</span> <span class=\"token function\">createPerson</span><span class=\"token punctuation\">(</span><span class=\"token string\">'John Smith'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">john</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œçš„å‡½æ•° <code class=\"language-text\">oPerson</code> æ˜¯é€šè¿‡ <code class=\"language-text\">new Function</code> åˆ›å»ºçš„ã€‚åœ¨å­—ç¬¦ä¸²å†…æ— æ³•â€œå¾—çŸ¥â€å‡½æ•°ä¼šè¢«èµ‹å€¼çš„åç§°ï¼Œå› æ­¤åªèƒ½é€šè¿‡ <code class=\"language-text\">arguments.callee</code> å»è·å–ã€‚åœ¨æŸäº›éå¸¸ç‰¹æ®Šçš„ä¸šåŠ¡åœºæ™¯ä¸­ï¼Œå¯èƒ½ä¼šæœ‰éœ€æ±‚å°†æŸäº›è¡¨è¾¾å¼é€šè¿‡å­—ç¬¦ä¸²è¿›è¡Œå­˜å‚¨ï¼Œå¹¶é€šè¿‡ <code class=\"language-text\">new Function</code> æ„å»ºæ‰§è¡Œã€‚è¿™ç§æ—¶å€™ï¼Œä½¿ç”¨ <code class=\"language-text\">arguments.callee</code> è·å–æ•°æ®ç±»ä¼¼äºä¼ å‚ã€‚å½“ç„¶ï¼Œå¦‚æœåªæ˜¯ä¼ å‚çš„éœ€æ±‚ï¼Œå…¶å®å¯ä»¥å†™æˆï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> script <span class=\"token operator\">=</span> <span class=\"token string\">'alert(arg.identity)'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">createPerson</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">identity</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> closure <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Function</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'const arg = arguments[0];'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">return function () { </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>script<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> }</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">closure</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> identity <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">var</span> john <span class=\"token operator\">=</span> <span class=\"token function\">createPerson</span><span class=\"token punctuation\">(</span><span class=\"token string\">'John Smith'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">john</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"date":"2019-12-01","title":"arguments.callee","category":"JavaScript"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"startInMonth":"2019-12-01","endInMonth":"2019-12-31","time":"2019-12","previous":"2019-11","next":null}}}
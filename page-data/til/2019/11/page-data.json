{"componentChunkName":"component---src-templates-til-per-month-js","path":"/til/2019/11","result":{"data":{"site":{"siteMetadata":{"title":"LaySent's Site"}},"allMarkdownRemark":{"edges":[{"node":{"id":"96f3c780-0e41-571e-abef-50a625e53a84","html":"<section><h2>ç°çŠ¶</h2><p>å½“å‰çš„ Ant Designï¼Œå¸¸è§çš„æ ·å¼è¦†ç›–æ–¹æ¡ˆï¼Œå¤§ä½“ä¸Šæœ‰ä¸¤ç§ï¼š</p><ol>\n<li>ä½¿ç”¨ Ant Design æä¾›çš„ LESS å˜é‡æ¥è¦†ç›–åŸæœ‰çš„æ ·å¼ï¼ˆè¯¦æƒ…å¯ä»¥å‚è€ƒå®˜æ–¹çš„<a href=\"https://ant.design/docs/react/customize-theme-cn\">æ–‡æ¡£</a>ï¼‰ï¼›</li>\n<li>å…ˆä¸€æ¬¡æ€§è½½å…¥å®Œæ•´çš„ Ant Design CSS/LESS æ–‡ä»¶ï¼Œç„¶åå†è½½å…¥æ–°çš„è¦†ç›–æ ·å¼ï¼ˆä¸€äº›æ–‡ç« æåˆ°äº†è¿™æ ·çš„å¤„ç†æ–¹æ³•ï¼Œæ¯”å¦‚<a href=\"https://www.jianshu.com/p/a2e7728d8717\">è¿™é‡Œ</a>ï¼‰ã€‚</li>\n</ol><p>ç¬¬ä¸€ç§æ–¹æ¡ˆçš„ä¸»è¦ç¼ºç‚¹æ˜¯å†™æ³•ä¸å¤ªç›´è§‚ï¼Œä¼˜ç‚¹æ˜¯æ›¿æ¢éå¸¸å½»åº•ï¼Œè€Œä¸”æ˜¯å®˜æ–¹æ¨èçš„æ–¹æ¡ˆï¼›ç¬¬äºŒç§æ–¹æ¡ˆï¼Œä¼˜ç‚¹æ˜¯è¦†ç›–çš„å†™æ³•éå¸¸çš„ç›´è§‚ï¼Œç›´æ¥å†™ CSS/LESS è¦†ç›–åŸæœ‰æ ·å¼å°±å¯ä»¥äº†ï¼Œä½†æ˜¯ç¼ºç‚¹æ˜¯éœ€è¦ä¸€æ¬¡æ€§åŠ è½½æ‰€æœ‰çš„æ ·å¼ï¼Œå†è¦†ç›–ã€‚</p></section>\n<section><h2>æŒ‰éœ€åŠ è½½çš„å›°éš¾ç‚¹</h2><p>å¦‚æœä½¿ç”¨äº† <code class=\"language-text\">babel-plugin-import</code> å¯¹æ ·å¼è¿›è¡ŒæŒ‰éœ€åŠ è½½ï¼Œå†æƒ³è¦è¿›è¡Œæ ·å¼çš„è¦†ç›–ï¼Œå°±å¾ˆå®¹æ˜“å‡ºç°é—®é¢˜ã€‚</p><p>åœ¨äº†è§£å…·ä½“å¯èƒ½å­˜åœ¨çš„é—®é¢˜å‰ï¼Œå…ˆæ¥çœ‹ä¸€ä¸‹ <code class=\"language-text\">babel-plugin-import</code> çš„æŒ‰éœ€åŠ è½½æ˜¯å¦‚ä½•è¿ä½œçš„ï¼šåœ¨ JavaScript / TypeScript æ–‡ä»¶é‡åˆ°ä»»ä½• Ant Design ç»„ä»¶çš„å¼•ç”¨ï¼Œå°±ä¼šåŒæ—¶å°†è¯¥ç»„ä»¶çš„æ ·å¼ä¹Ÿæ’å…¥åˆ°å¼•ç”¨çš„ä½ç½®ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæœ‰ä¸‹é¢çš„ JavaScript ä»£ç ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Select <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'antd'</span><span class=\"token punctuation\">;</span></code></pre></div><p>é‚£ä¹ˆï¼Œç¼–è¯‘è½¬åŒ–åçš„ä»£ç å¤§ä½“å¦‚ä¸‹ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">import</span> <span class=\"token string\">'antd/lib/select/style'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> Select <span class=\"token keyword\">from</span> <span class=\"token string\">'antd/lib/select'</span><span class=\"token punctuation\">;</span></code></pre></div><p>è¿™é‡Œå®é™…è½½å…¥çš„æ ·å¼æ–‡ä»¶æ¥è‡ª <code class=\"language-text\">antd/lib/select/style</code> ç›®å½•ä¸‹çš„ <code class=\"language-text\">index.js</code> æ–‡ä»¶ã€‚åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå…·ä½“å¼•ç”¨äº†éœ€è¦ç”¨åˆ°çš„å„ä¸ª LESS æ–‡ä»¶ã€‚å¯¹ Select æ¥è¯´ï¼Œè¿™ä¸ªæ ·å¼å¼•ç”¨çš„ä»£ç æ˜¯ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../style/index.less\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./index.less\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../empty/style\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº† Select è‡ªèº«çš„ <code class=\"language-text\">index.less</code> æ–‡ä»¶å¤–ï¼Œå…ˆåè¿˜å¼•ç”¨äº† <code class=\"language-text\">../../style/index.less</code> æ–‡ä»¶å’Œ <code class=\"language-text\">../../empty/style</code> æ–‡ä»¶ã€‚æ¢å¥è¯è¯´ï¼Œ<code class=\"language-text\">babel-plugin-import</code> åœ¨å¤„ç†æŒ‰éœ€åŠ è½½çš„æ—¶å€™ï¼Œå¹¶ä¸æ˜¯ä»…åŠ è½½äº†å½“å‰ä½¿ç”¨ç»„ä»¶çš„æ ·å¼ï¼Œè¿˜åŒ…å«äº†ä¸€äº›ç»„ä»¶éœ€è¦çš„éšå«ä¾èµ–æ ·å¼ã€‚è¿™ä¸€ç‚¹ï¼Œåœ¨ AutoComplete è¿™æ ·çš„å¤æ‚ç»„ä»¶ä¸­æ›´ä¸ºæ˜æ˜¾ã€‚åœ¨ä½¿ç”¨ AutoComplete çš„æ—¶å€™ï¼Œå…¶ <code class=\"language-text\">style/index.js</code> å†…å®¹å¦‚ä¸‹ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../style/index.less\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./index.less\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../select/style\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"../../input/style\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œé™¤äº†è‡ªèº«çš„æ ·å¼ä¹‹å¤–ï¼ŒSelect å’Œ Input çš„æ ·å¼ä»£ç ä¹Ÿè¢«åŠ è½½äº†ä¸€éã€‚æ¢å¥è¯è¯´ï¼Œå¦‚æœå¸Œæœ›åšæŒ‰éœ€åŠ è½½çš„æ ·å¼è¦†ç›–ï¼Œåœ¨åŠ è½½ AutoComplete ç»„ä»¶çš„æ—¶å€™ï¼Œé™¤äº†éœ€è¦åŠ è½½æ ·å¼è¦†ç›– AutoComplete çš„éƒ¨åˆ†ï¼Œè¿˜éœ€è¦é¢å¤–åŠ è½½æ ·å¼å°† Select å’Œ Input çš„æ ·å¼ä¹Ÿè¦†ç›–ä¸€éã€‚è€Œè¿™äº›éšå«çš„æ ·å¼ä¾èµ–ï¼Œåœ¨ä»£ç ä¸Šæ˜¯ä¸å®¹æ˜“è¢«å¯Ÿè§‰çš„ã€‚ä¸€æ—¦æ¼äº† Select å’Œ Input çš„æ ·å¼è¦†ç›–ï¼Œå°±å®¹æ˜“å‡ºç°é—®é¢˜ï¼šæ˜æ˜ Select çš„æ ·å¼åœ¨åŠ è½½çš„æ—¶å€™å·²ç»è¦†ç›–è¿‡äº†ï¼Œä½†æ˜¯åœ¨åŠ è½½äº† AutoComplete ç»„ä»¶ä¹‹åï¼ŒåŸå…ˆå·²ç»è¢«è¦†ç›–çš„æ ·å¼ï¼Œåˆè¢«æ–°è½½å…¥çš„ Select åŸå§‹æ ·å¼ç»™è¦†ç›–å›å»äº†ã€‚</p><p>å› ä¸º Ant Design çš„æ ·å¼æ²¡æœ‰é‡‡ç”¨ CSS Moduleï¼Œå› æ­¤ CSS/LESS çš„æ ·å¼è¦†ç›–å°±å¼ºä¾èµ–äºæ­£ç¡®çš„åŠ è½½é¡ºåºã€‚è¦†ç›–çš„æ ·å¼å¿…é¡»åœ¨åŸå§‹æ ·å¼çš„åé¢åŠ è½½ï¼Œå¦åˆ™ç»“æœå°±ä¼šå‡ºç°é”™ä¹±ã€‚</p></section>\n<section><h2>è§£å†³æ–¹æ¡ˆ</h2><p>ä¸ºäº†ç¡®ä¿æŒ‰éœ€åŠ è½½çš„æƒ…å†µä¸‹ï¼Œæ ·å¼çš„è¦†ç›–é¡ºåºä¹Ÿæ˜¯æ­£ç¡®çš„ï¼Œä¸€ä¸ªå¯è¡Œçš„æ€è·¯æ˜¯ä½¿ç”¨ Webpack ä¸­çš„ loader åŠŸèƒ½ã€‚æ ¹æ® Webpack æ‰“åŒ…çš„åŸç†ï¼Œä»»ä½•çš„é JavaScript ä»£ç ï¼Œéƒ½éœ€è¦é€šè¿‡åˆé€‚çš„ loader è½¬åŒ–æˆ JavaScript æ–‡ä»¶ï¼Œæœ€ç»ˆè¢«æ‰“åŒ…åˆ° bundle ä¸­ã€‚è€Œä¸ç®¡ <code class=\"language-text\">babel-plugin-import</code> æ’ä»¶å¦‚ä½•å¤„ç† Ant Design çš„æ ·å¼åŠ è½½ï¼Œè¿™äº›æœ€ç»ˆè¢«å¼•ç”¨çš„ LESS æ–‡ä»¶ï¼Œéƒ½éœ€è¦ç»è¿‡ä¸€äº› loader æœ€ç»ˆå¤„ç†æˆå¯æ‰§è¡Œçš„æ–‡ä»¶ï¼ˆä¸€èˆ¬éœ€è¦ç”¨åˆ°çš„ loader åŒ…æ‹¬ <code class=\"language-text\">less-loader</code>ï¼Œ<code class=\"language-text\">css-loader</code> å’Œ <code class=\"language-text\">style-loader</code>ï¼‰ã€‚</p><p>æ—¢ç„¶ Webpack çš„æ‰“åŒ…å·²ç»ä¿è¯äº†ç»Ÿä¸€çš„å¤„ç†å…¥å£ï¼Œé‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘åœ¨ loader è¿™ä¸€å±‚ï¼Œå°†æ ·å¼çš„è¦†ç›–å¤„ç†æ‰ã€‚</p><p>ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> path <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> pattern <span class=\"token operator\">=</span> <span class=\"token regex\">/antd\\/lib\\/([^\\/]+)\\/style\\/index.less/</span><span class=\"token punctuation\">;</span>\n\nmodule<span class=\"token punctuation\">.</span><span class=\"token function-variable function\">exports</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span>content<span class=\"token comment\">/*, map, meta */</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">/**\n   * è¿™é‡Œçš„ resourcePath å°±æ˜¯å…·ä½“è¢«ä½¿ç”¨çš„ LESS æ–‡ä»¶çš„ç›®å½•ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒ Webpack æ–‡æ¡£ï¼š\n   * https://webpack.js.org/api/loaders/#thisresourcepath\n   */</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> resourcePath <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> match <span class=\"token operator\">=</span> pattern<span class=\"token punctuation\">.</span><span class=\"token function\">exec</span><span class=\"token punctuation\">(</span>resourcePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">/**\n   * 1. å¦‚æœä¸æ˜¯ Antd ç›¸å…³çš„ LESS æ–‡ä»¶ï¼Œç›´æ¥å¿½ç•¥ä¸å¤„ç†\n   */</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>match<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> content<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> component <span class=\"token operator\">=</span> match<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">/**\n   * 2. æ ¹æ®ä½¿ç”¨çš„ Component ç»„ä»¶ï¼Œæ‰¾åˆ°å¯¹åº”çš„è¦†ç›–æ ·å¼æ–‡ä»¶ï¼Œèµ‹å€¼ç»™ customizedLessPath\n   */</span>\n  <span class=\"token keyword\">const</span> customizedLessPath <span class=\"token operator\">=</span> <span class=\"token function\">getCustomizedLessFile</span><span class=\"token punctuation\">(</span>component<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>customizedLessPath<span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> content<span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">/**\n   * 3. å¦‚æœæ‰¾åˆ°äº†è¦†ç›–æ–‡ä»¶ï¼Œå°±å°†è¦†ç›–æ–‡ä»¶æ’å…¥åˆ° LESS çš„æœ€åé¢ï¼Œä¿è¯è°ƒç”¨é¡ºåº\n   */</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span>\n    content<span class=\"token punctuation\">,</span>\n    <span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">@import \"</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>customizedLessPath<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">\";</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">join</span><span class=\"token punctuation\">(</span><span class=\"token string\">'\\n'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div><p>æ¥ä¸‹æ¥ï¼Œåœ¨ Webpack ä¸­é…ç½®å¯¹åº”çš„ LESS æ–‡ä»¶å¤„ç† loaderï¼Œç¡®ä¿è¿™ä¸ªè‡ªå®šä¹‰çš„ loader åœ¨ less-loader çš„å‰é¢ï¼š</p><div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token punctuation\">{</span>\n  test<span class=\"token punctuation\">:</span> <span class=\"token regex\">/\\.less$/</span><span class=\"token punctuation\">,</span>\n  use<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'postcss-loader'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      loader<span class=\"token punctuation\">:</span> <span class=\"token string\">'less-loader'</span><span class=\"token punctuation\">,</span>\n      options<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token comment\">// ...</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      loader<span class=\"token punctuation\">:</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'path-to-custom-loader'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span></code></pre></div><p>è¿™æ ·ï¼Œå‡è®¾ <code class=\"language-text\">babel-plugin-import</code> æ’ä»¶æ’å…¥äº†ä¸€æ®µ Select çš„ LESS æ–‡ä»¶ï¼š</p><div class=\"gatsby-highlight\" data-language=\"less\"><pre class=\"language-less\"><code class=\"language-less\"><span class=\"token atrule\">@select-prefix-cls<span class=\"token punctuation\">:</span> ~'@</span><span class=\"token punctuation\">{</span>ant<span class=\"token operator\">-</span>prefix<span class=\"token punctuation\">}</span><span class=\"token operator\">-</span>select'<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span></code></pre></div><p>ç»è¿‡ä¸Šé¢çš„è‡ªå®šä¹‰ loader å¤„ç†ä¹‹åï¼Œå°±ä¼šå˜æˆï¼š</p><div class=\"gatsby-highlight\" data-language=\"less\"><pre class=\"language-less\"><code class=\"language-less\"><span class=\"token atrule\">@select-prefix-cls<span class=\"token punctuation\">:</span> ~'@</span><span class=\"token punctuation\">{</span>ant<span class=\"token operator\">-</span>prefix<span class=\"token punctuation\">}</span><span class=\"token operator\">-</span>select'<span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n<span class=\"token variable\">@import</span> <span class=\"token string\">\"customized-less-path\"</span><span class=\"token punctuation\">;</span></code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œè‡ªå®šä¹‰çš„ LESS æ–‡ä»¶ä¸€å®šä¼šåœ¨åŸå§‹ LESS æ–‡ä»¶çš„åé¢ï¼Œä»é¡ºåºä¸Šå¯ä»¥ä¿è¯æ ·å¼ä¸€å®šå¯ä»¥æ­£ç¡®çš„è¢«è¦†ç›–ã€‚å‰©ä¸‹çš„äº‹æƒ…ï¼Œå°±äº¤ç»™ less-loader åŠåç»­ loader å»å¤„ç†å°±å¯ä»¥äº†ã€‚</p></section>\n<section><h2>å»¶ä¼¸é˜…è¯»</h2><p>å…³äº Webpack loader çš„å†™æ³•ï¼Œå¯ä»¥å‚è€ƒ Webpack å®˜æ–¹çš„<a href=\"https://webpack.js.org/contribute/writing-a-loader/\">æ•™å­¦æ–‡æ¡£</a>ã€‚</p></section>","frontmatter":{"date":"2019-11-18","title":"Ant Design Style Overwrite","category":"JavaScript"}}},{"node":{"id":"265be941-4b2a-5bcb-b8e5-b5bb85a52bb5","html":"<p>åœ¨ JavaScript çš„ DOM äº‹ä»¶ä¸­ï¼Œå¯ä»¥é€šè¿‡ <code class=\"language-text\">.stopPropagation</code> æ¥é˜»æ­¢äº‹ä»¶å†’æ³¡ã€‚æ¯”å¦‚ï¼Œå¦‚æœæœ‰å¦‚ä¸‹çš„ä¸€ä¸ª DOM ç»“æ„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>parent</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span> <span class=\"token attr-name\">id</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>child</span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>åŒæ—¶æœ‰å¦‚ä¸‹çš„ JavaScript ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> parent <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'parent'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> child <span class=\"token operator\">=</span> document<span class=\"token punctuation\">.</span><span class=\"token function\">getElementById</span><span class=\"token punctuation\">(</span><span class=\"token string\">'child'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nparent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nchild<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (child): capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nchild<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (child): bubble'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nparent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): bubble'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é‚£ä¹ˆï¼Œç‚¹å‡» child å…ƒç´ ï¼Œconsole ä¸­çš„è¾“å‡ºçš„ç»“æœå¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">click(parent): capture\nclick(child): capture\nclick(child): bubble\nclick(parent): bubble</code></pre></div>\n<p>è¿™é‡Œï¼Œä»£ç æœ‰æ„ä¿æŒè¾“å‡ºé¡ºåºå’Œå›è°ƒå‡½æ•°æ³¨å†Œé¡ºåºçš„ä¸€è‡´æ€§ã€‚å¦‚æœåœ¨ä¸Šé¢å››ä¸ªå›è°ƒå‡½æ•°ä¸­ä¾æ¬¡åŠ ä¸Š <code class=\"language-text\">event.stopPropagation()</code>ï¼Œé‚£ä¹ˆä¹‹åæ‰€æœ‰çš„å†…å®¹å°†ä¸ä¼šåœ¨ç»§ç»­è¾“å‡ºã€‚</p>\n<p>ä»¥ä¸Šæ˜¯å…³äº DOM ä¸­å†’æ³¡å’Œæ•è·äº‹ä»¶å¤„ç†çš„ä¸€èˆ¬æµç¨‹ã€‚è¿™é‡Œï¼Œå¦‚æœåœ¨ä¸€ä¸ª DOM èŠ‚ç‚¹ä¸Šæ³¨å†Œäº†ä¸æ­¢ä¸€ä¸ªçš„äº‹ä»¶å›è°ƒå‡½æ•°ï¼Œé‚£ä¹ˆæµè§ˆå™¨å°†æŒ‰ç…§äº‹ä»¶æ³¨å†Œçš„å…ˆåé¡ºåºï¼Œä¾æ¬¡æ‰§è¡Œå¯¹åº”çš„å›è°ƒå‡½æ•°ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œ<code class=\"language-text\">event.stopPropagation()</code> æ˜¯æ— æ³•é˜»æ­¢åŒçº§å›è°ƒå‡½æ•°è¢«æ‰§è¡Œçš„ã€‚ç®€å•å°†ä¸Šé¢çš„ä»£ç è¿›è¡Œä¿®æ”¹ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„æµ‹è¯•ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">parent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">stopPropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): first capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nparent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): second capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nchild<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (child): capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é‚£ä¹ˆï¼Œåœ¨ç‚¹å‡» child å…ƒç´ çš„æ—¶å€™ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹çš„è¾“å‡ºç»“æœï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">click (parent): first capture\nclick (parent): second capture</code></pre></div>\n<p>parent ä¸Šçš„ click å›è°ƒå‡½æ•°éƒ½ä¾æ¬¡æ‰§è¡Œå®Œæ¯•äº†ï¼Œè€Œ child ä¸Šçš„éƒ¨åˆ†åˆ™å› ä¸º <code class=\"language-text\">event.stopPropagation()</code> æ²¡æœ‰è¢«æ‰§è¡Œåˆ°ã€‚è¿™é‡Œï¼Œå¦‚æœå¸Œæœ›è¿åŒå±‚çš„å…¶ä»–å›è°ƒå‡½æ•°ä¹Ÿä¸è¦ç»§ç»­æ‰§è¡Œï¼Œå¯ä»¥æ”¹ç”¨ <code class=\"language-text\">event.stopImmediatePropagation()</code>ï¼Œä»£ç ä¿®æ”¹å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">parent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">stopImmediatePropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): first capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nparent<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (parent): second capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nchild<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click'</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">function</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'click (child): capture'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¿®æ”¹åçš„ä»£ç ï¼Œæ‰§è¡Œæ•ˆæœå¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">click (parent): first capture</code></pre></div>\n<p>å‡ ç‚¹è¯´æ˜ï¼š</p>\n<ol>\n<li>React çš„åˆæˆäº‹ä»¶åªæœ‰ <code class=\"language-text\">stopPropagation</code> æ²¡æœ‰ <code class=\"language-text\">stopImmediatePropagation</code>ï¼Œå¦‚æœéœ€è¦ä½¿ç”¨çš„è¯ï¼Œå¯ä»¥ç”¨å¦‚ä¸‹çš„æ–¹æ³•è°ƒç”¨çœŸæ­£çš„ DOM APIï¼š<code class=\"language-text\">.nativeEvent.stopImmediatePropagation</code>ã€‚è¿™é‡Œ React ä¸éœ€è¦ <code class=\"language-text\">stopImmediatePropagation</code> çš„ç†ç”±éå¸¸ç®€å•ï¼Œå› ä¸ºåœ¨ JSX ä¸­ï¼Œæ¯ä¸ªäº‹ä»¶åœ¨ Component ä¸Šåªèƒ½ç»‘å®šä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œå› æ­¤ <code class=\"language-text\">stopImmediatePropagation</code> æ˜¯å¤šä½™çš„ï¼›</li>\n<li>ç”±äºæµè§ˆå™¨å¤©ç„¶ç»´æŠ¤äº†ä¸€ä¸ª EventListener çš„é˜Ÿåˆ—ç”¨äºæŒ‰é¡ºåºæ‰§è¡Œå›è°ƒå‡½æ•°ï¼Œ<code class=\"language-text\">stopImmediatePropagation</code> é…åˆä¸Šå›è°ƒå‡½æ•°çš„æ³¨é”€ï¼ˆ<code class=\"language-text\">removeEventListener</code>ï¼‰ï¼Œå¯ä»¥ç”¨äºå°æˆæœ¬å®ç°ä¸€ä¸ª FIFO çš„é˜Ÿåˆ—ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</li>\n</ol>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">register</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">dom</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">callback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>key <span class=\"token operator\">!==</span> <span class=\"token string\">'Escape'</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">stopImmediatePropagation</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    window<span class=\"token punctuation\">.</span><span class=\"token function\">removeEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keydown'</span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    dom<span class=\"token punctuation\">.</span>attributeStyleMap<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'display'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  dom<span class=\"token punctuation\">.</span>attributeStyleMap<span class=\"token punctuation\">.</span><span class=\"token function\">set</span><span class=\"token punctuation\">(</span><span class=\"token string\">'display'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'block'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  window<span class=\"token punctuation\">.</span><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">'keydown'</span><span class=\"token punctuation\">,</span> callback<span class=\"token punctuation\">,</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\nArray<span class=\"token punctuation\">.</span><span class=\"token function\">from</span><span class=\"token punctuation\">(</span>document<span class=\"token punctuation\">.</span><span class=\"token function\">querySelectorAll</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ul li'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>register<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä»¥ä¸Šä»£ç æ‰§è¡Œåï¼ŒæŒ‰ä¸‹ ESC é”®ï¼Œå°†ä¼šä¾æ¬¡å°† <code class=\"language-text\">ul</code> ä¸‹çš„ <code class=\"language-text\">li</code> å…ƒç´ ä¸€ä¸ªä¸€ä¸ªçš„éšè—ã€‚</p>\n<ol start=\"3\">\n<li><code class=\"language-text\">stopImmediatePropagation</code> API çš„æµè§ˆå™¨æ”¯æŒæ¯”è¾ƒå¥½ï¼Œåœ¨ IE 9 åŠä»¥ä¸Šçš„æµè§ˆå™¨ä¸­éƒ½å¯ä»¥ä½¿ç”¨ï¼Œå‚è€ƒ <a href=\"https://caniuse.com/#search=stopimmediatepropagation\">Can I Use</a>ï¼›</li>\n<li>æ›´å¤šå…³äºè¿™ä¸ª API çš„ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Event/stopImmediatePropagation\">MDN</a>ã€‚</li>\n</ol>","frontmatter":{"date":"2019-11-17","title":"stopImmediatePropagation","category":"JavaScript"}}},{"node":{"id":"e3c0f3bd-e7cf-579e-8fb1-d24187f5acdb","html":"<p>Google Chrome çš„ DevTools æœ¬è´¨ä¸Šä¹Ÿæ˜¯ä¸€ä¸ªç”± Web æŠ€æœ¯ç¼–å†™çš„åº”ç”¨ï¼Œåœ¨å¿…è¦çš„æ—¶å€™ï¼Œå¯ä»¥é€šè¿‡ä»¥ä¸‹çš„æ–¹å¼æ‰“å¼€ DevTools çš„ DevToolsï¼š</p>\n<ol>\n<li>é¦–å…ˆæ‰“å¼€ DevToolsï¼›</li>\n<li>é€‰æ‹©å°† DevTools åœ¨ç‹¬ç«‹çª—å£ä¸­æ‰“å¼€ï¼Œç„¶åæŒ‰ä¸‹ Cmd + Opt + Iï¼ˆMacï¼‰æˆ– Ctrl + Shift + Iï¼ˆWindowsï¼‰</li>\n</ol>\n<p>è¿™æ ·ï¼Œå°±å¯ä»¥æ‰“å¼€ DevTools çš„ DevTools äº†ã€‚</p>\n<p>æ³¨ï¼šè¿™é‡Œä¸€å®šè¦é€‰æ‹©å°†æœ€å¼€å§‹çš„ DevTools åœ¨ç‹¬ç«‹çª—å£æ‰“å¼€ï¼Œç„¶åå†æŒ‰ Cmd + Opt + Iï¼›å¦åˆ™å¯¹äºåµŒå…¥åœ¨é¡µé¢ä¸­çš„ DevTools æ¥è¯´ï¼ŒæŒ‰ä¸‹ä¸Šé¢è¿™ä¸ªç»„åˆé”®ï¼Œä¼šå°† DevTools æ”¶å›ï¼Œè€Œä¸æ˜¯æ‰“å¼€ DevTools çš„ DevToolsã€‚</p>\n<p>å¦ä¸€ä¸ªç¨å¾®éº»çƒ¦ä¸€äº›çš„æ–¹æ³•æ˜¯ï¼š</p>\n<ol>\n<li>æ‰“å¼€ä¸€ä¸ª DevToolsï¼›</li>\n<li>åœ¨ Chrome ä¸­æ‰“å¼€ï¼š<a href=\"chrome://inspect\">chrome://inspect</a>ï¼›</li>\n<li>é€‰æ‹© Otherï¼Œå°±å¯ä»¥æ‰¾åˆ°åˆšæ‰æ‰“å¼€çš„ DevTools äº†ï¼Œç‚¹å‡» <code class=\"language-text\">inspect</code> é“¾æ¥ï¼Œå°±å¯ä»¥æ‰“å¼€è¿™ä¸ªæŒ‡å®š DevTools çš„ DevTools äº†ã€‚</li>\n</ol>\n<p>ä¸€ä¸ªå¯ä»¥åœ¨ DevTools çš„ DevTools ä¸­è¿›è¡Œçš„æ“ä½œï¼Œæ˜¯æŸ¥çœ‹å’Œä¿®æ”¹ DevTools ä¸­è®°å½•çš„ snippetsã€‚å¯¹åº”çš„ API åˆ†åˆ«æ˜¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">InspectorFrontendHost<span class=\"token punctuation\">.</span><span class=\"token function\">getPreferences</span><span class=\"token punctuation\">(</span>\n  <span class=\"token parameter\">_</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">.</span>scriptSnippets<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nInspectorFrontendHost<span class=\"token punctuation\">.</span><span class=\"token function\">setPreference</span><span class=\"token punctuation\">(</span>\n  <span class=\"token string\">'scriptSnippets'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>yourSnippets<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å…³äºé€šè¿‡ä»£ç æ¥ç®¡ç† Chrome DevTools ä¸­çš„ snippetsï¼Œå¯ä»¥å‚è€ƒ GitHub ä¸Šçš„è¿™ä¸ª<a href=\"https://github.com/bahmutov/code-snippets/issues/23\">è®¨è®º</a>ã€‚</p>\n<p>åŒæ—¶ï¼ŒChrome DevTools æœ¬èº«ä¹Ÿæ˜¯å¼€æºçš„ï¼Œä»£ç å¯ä»¥åœ¨ <a href=\"https://github.com/ChromeDevTools/devtools-frontend\">GitHub</a> ä¸Šæ‰¾åˆ°ã€‚</p>","frontmatter":{"date":"2019-11-15","title":"DevTools of DevTools","category":"Chrome"}}},{"node":{"id":"17386daf-da8d-53b5-8e80-73d9d610875a","html":"<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">\b<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'incorrect statement'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'correct statement'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä¸Šé¢çš„è¿™æ®µä»£ç ï¼Œçœ‹ä¸Šå»ä¸¤ä¸ª <code class=\"language-text\">if</code> è¯­å¥å¹¶æ— å·®åˆ«ã€‚ä½†æ˜¯åœ¨å®é™…æ‰§è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå´ä¼šå‘ç°ï¼Œç¬¬ä¸€ä¸ª <code class=\"language-text\">if</code> è¯­å¥æœ‰è¯­æ³•æŠ¥é”™ï¼Œè€Œç¬¬äºŒä¸ª <code class=\"language-text\">if</code> è¯­å¥å´æ²¡æœ‰ã€‚TypeScript ç»™å‡ºçš„æŠ¥é”™ä¿¡æ¯æ˜¯ï¼š<code class=\"language-text\">Invalid character.(1127)</code>ã€‚</p>\n<p>â€œçœ‹ä¸Šå»â€ä¸€æ ·çš„ä»£ç ï¼Œåœ¨è§£é‡Šå™¨çœ‹æ¥å´éå¸¸ä¸åŒã€‚ç©¶å…¶åŸå› ï¼Œæ˜¯å› ä¸ºç¬¬ä¸€ä¸ª <code class=\"language-text\">if</code> è¯­å¥ä¸­ï¼Œæœ‰ä¸€ä¸ªâ€œçœ‹ä¸è§â€çš„å­—ç¬¦ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">\bif (true) {</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">.</span><span class=\"token function\">charCodeAt</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æ‰§è¡Œä¸Šé¢çš„è¿™æ®µä»£ç ï¼Œä¼šçœ‹åˆ°åœ¨ console ä¸­è¾“å‡º 8ã€‚è¿™é‡Œï¼Œ8 æ˜¯ Backspace çš„ ASCII ç ç¼–å·ã€‚åœ¨å¾ˆå¤šçš„æ–‡æœ¬ç¼–è¾‘å™¨ä¸­ï¼Œè¿™ç±»ç‰¹æ®Šå­—ç¬¦å¹¶ä¸ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œä½†å¯¹äºè§£é‡Šå™¨æ¥è¯´ï¼Œè¿™ä¸ªå­—ç¬¦ç¡®å®çœŸæ˜¯å­˜åœ¨çš„ã€‚ï¼ˆå½“ç„¶ï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„æ–‡æœ¬ç¼–è¾‘å™¨éƒ½ä¸ä¼šæ˜¾ç¤ºï¼Œæ¯”å¦‚æŠŠä¸Šé¢çš„ä»£ç å¤åˆ¶åˆ° Chrome DevTools ä¸­ï¼Œå°±ä¼šçœ‹åˆ°ä¸€ä¸ª <code class=\"language-text\">ğŸ”´</code> ç¬¦å·ï¼Œç”¨äºè¡¨ç¤ºè¿™ä¸ªçœ‹ä¸è§çš„ Backspaceï¼‰</p>\n<p>è¿™ä¸€ç±»çš„ç‰¹æ®Šå­—ç¬¦é™¤äº† Backspace è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚ Unicode ä¸­çš„é›¶å®½ç©ºæ ¼ï¼ˆU+200bï¼‰ã€å·¦è‡³å³ç¬¦å·ï¼ˆU+200eï¼‰ã€å³è‡³å·¦ç¬¦å·ï¼ˆU+200fï¼‰ç­‰ã€‚</p>","frontmatter":{"date":"2019-11-13","title":"Invisible Characters","category":"JavaScript"}}},{"node":{"id":"65cd384a-ec80-5942-bc9e-9ab8ad9814f5","html":"<p>Node.js ä¸­çš„ <code class=\"language-text\">require</code> API åœ¨åŠ è½½ commonjs æ¨¡å—çš„æ—¶å€™ï¼Œä¼šåšä¸¤ä¸ªäº‹æƒ…ï¼š</p>\n<ol>\n<li>æ ¹æ® Node.js çš„ç®—æ³•ï¼ŒæŸ¥æ‰¾åˆ°å¯¹åº”çš„æ¨¡å—æ–‡ä»¶ï¼›</li>\n<li>åŠ è½½æŸ¥æ‰¾åˆ°çš„æ¨¡å—æ–‡ä»¶å¹¶è¿è¡Œã€‚</li>\n</ol>\n<p>è¿™é‡Œï¼Œå¦‚æœåªæ˜¯æƒ³æ‰§è¡Œç¬¬ä¸€æ­¥ï¼Œä½†å¹¶ä¸çœŸçš„è¿è¡Œè¿™ä¸ªè¢«æ‰¾åˆ°çš„æ¨¡å—ï¼Œå¯ä»¥ä½¿ç”¨ Node.js æä¾›çš„ <code class=\"language-text\">require.resolve</code> APIã€‚å…·ä½“çš„è°ƒç”¨ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> modulePath <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'some-package'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>modulePath<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¸Šé¢ä»£ç ä¸­ï¼Œ<code class=\"language-text\">modulePath</code> æ˜¯ä¸€ä¸ªå®Œæ•´çš„æ–‡ä»¶è·¯å¾„ï¼ŒæŒ‡å‘çš„ä½ç½®å°±æ˜¯ <code class=\"language-text\">some-package</code> è¿™ä¸ªæ¨¡å—çš„ entry æ–‡ä»¶ï¼ˆå®šä¹‰åœ¨ package.json çš„ <code class=\"language-text\">main</code> ä¸­ï¼‰ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¿™ä¸ª <code class=\"language-text\">require.resolve</code> çš„æŸ¥æ‰¾è·¯å¾„æ˜¯å’Œ <code class=\"language-text\">require</code> API ä¸€è‡´çš„ï¼šåœ¨æŸ¥æ‰¾çš„æ—¶å€™ï¼Œä¼šä»å½“å‰æ–‡ä»¶çš„ç›®å½•å¼€å§‹ï¼Œé€çº§å¾€ä¸ŠæŸ¥æ‰¾ <code class=\"language-text\">node_modules</code> ç›®å½•ä¸‹æ˜¯å¦æœ‰éœ€è¦çš„åº“ã€‚</p>\n<p>ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾æœ‰ä¸‹é¢è¿™æ ·ä¸€ä¸ªç›®å½•ç»“æ„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">A.js\nnode_modules\n|- some-package\n   |- index.js\n|- other-package\n   |- index.js\nutils\n|- B.js\n   node_modules\n   |- some-package\n      |- index.js</code></pre></div>\n<p>ä¸”ï¼Œå‡è®¾ A.js çš„ä»£ç ä¸ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./utils/B'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A: '</span><span class=\"token punctuation\">,</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'some-package'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'A: '</span><span class=\"token punctuation\">,</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'other-package'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>B.js çš„ä»£ç ä¸ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'B: '</span><span class=\"token punctuation\">,</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'some-package'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'B: '</span><span class=\"token punctuation\">,</span> require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'other-package'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é‚£ä¹ˆï¼Œè¾“å‡ºçš„ç»“æœä¸ºï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">B: utils/node_modules/some-package/index.js\nB: node_modules/other-package/index.js\nA: node_modules/some-package/index.js\nA: node_modules/other-package/index.js</code></pre></div>\n<p>ä½†æœ‰çš„æ—¶å€™ï¼Œåªæ˜¯å¸Œæœ›å¯ä»¥ä½¿ç”¨ Node.js çš„æŸ¥æ‰¾ç®—æ³•ï¼Œä½†æ˜¯æŸ¥æ‰¾çš„ç›®å½•ä½ç½®ï¼Œå¹¶ä¸ä¸€å®šæ˜¯ä»å½“å‰æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•å¼€å§‹çš„ã€‚è¿™ç§æ—¶å€™ï¼Œå°±éœ€è¦ç”¨åˆ° <code class=\"language-text\">require.resolve</code> çš„ç¬¬äºŒä¸ªå‚æ•°äº†ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\">require<span class=\"token punctuation\">.</span><span class=\"token function\">resolve</span><span class=\"token punctuation\">(</span><span class=\"token string\">'some-package'</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n  paths<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token string\">'where-to-start-searching'</span><span class=\"token punctuation\">,</span>\n    <span class=\"token string\">'other-possible-search-location'</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œï¼Œ<code class=\"language-text\">paths</code> æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„æœç´¢èµ·å§‹ä½ç½®ã€‚Node.js ä¼šä¾æ¬¡ä»¥è¿™äº›è·¯å¾„ä¸ºèµ·å§‹ç‚¹ï¼ŒæŸ¥æ‰¾å„ä¸ªå±‚çº§å¾€ä¸Šçš„ node_modules ç›®å½•ã€‚ä¸€æ—¦æ‰¾åˆ°éœ€è¦çš„åº“ï¼Œå°±åœæ­¢æŸ¥æ‰¾ï¼Œå¦åˆ™å°±ä¼šä¸€ç›´å¾€ä¸Šç›´åˆ°æ ¹ç›®å½•ã€‚åˆ°è¾¾æ ¹ç›®å½•åï¼Œå½“å‰çš„æŸ¥æ‰¾å°±ä»¥å¤±è´¥å‘Šç»ˆã€‚å¦‚æœè¿˜æœ‰å…¶ä»–çš„æŸ¥æ‰¾è·¯å¾„ï¼Œå°±ä¼šç»§ç»­ä¸Šé¢çš„æ“ä½œï¼Œå¦åˆ™ç¨‹åºä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</p>\n<p>ç¬¬äºŒä¸ªå‚æ•°çš„ä¸€ä¸ªå®é™…åº”ç”¨åœºæ™¯å¦‚ä¸‹ï¼šå‡è®¾æœ‰ä¸€ä¸ª CLI å¯ä»¥ç”¨äºä»£ç†æ‰§è¡Œ Webpack å‘½ä»¤ï¼Œè¿™æ—¶å€™å°±éœ€è¦é¦–å…ˆé€šè¿‡ <code class=\"language-text\">require.resolve</code> å‘½ä»¤æ‰¾å‡ºå½“å‰æ‰§è¡Œ CLI å‘½ä»¤çš„ç›®å½•å†…ï¼ŒWebpack åº“åœ¨ä»€ä¹ˆä½ç½®ã€‚ç„¶åæ‰å¯ä»¥ç”¨ <code class=\"language-text\">require</code> å‘½ä»¤å»åŠ è½½çœŸæ­£åœ¨é¡¹ç›®ä¸­ä½¿ç”¨åˆ°çš„ Webpack ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯ CLI å†…éƒ¨å¯èƒ½ä¾èµ–çš„ä¸€ä¸ª Webpack ç‰ˆæœ¬ã€‚</p>\n<p>æ›´å¤šå…³äº <code class=\"language-text\">require.resolve</code> å‘½ä»¤çš„è¯´æ˜ï¼Œå¯ä»¥å‚è€ƒå®˜æ–¹çš„<a href=\"https://nodejs.org/api/modules.html#modules_require_resolve_request_options\">æ–‡æ¡£</a>ã€‚</p>","frontmatter":{"date":"2019-11-12","title":"Require Resolve","category":"Node.js"}}},{"node":{"id":"bdf22101-4989-5baa-9054-a528719b9619","html":"<p><a href=\"https://github.com/tc39/proposal-nullish-coalescing\">Nullish Coalescing</a> å½“å‰åœ¨ TC39 Stage 3 çš„é˜¶æ®µï¼ŒTypeScript åœ¨ <a href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-3-7/#nullish-coalescing\">3.7</a> ä¸­ä¹Ÿå°†è¿™ä¸€åŠŸèƒ½å¼•å…¥äº†è¿›æ¥ã€‚ï¼ˆ<a href=\"http://dict.cn/Coalesce\">Coalesce</a> æ˜¯â€œåˆå¹¶ï¼›è”åˆï¼›æ¥åˆâ€çš„æ„æ€ï¼‰</p>\n<p>Nullish Coalescing çš„ç®€å•ç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> foo <span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å½“ <code class=\"language-text\">foo</code> çš„å€¼æ˜¯ <code class=\"language-text\">null</code> æˆ–è€… <code class=\"language-text\">undefined</code> çš„æ—¶å€™ï¼Œ<code class=\"language-text\">x</code> çš„å€¼ç”±åé¢çš„ <code class=\"language-text\">bar()</code> å†³å®šï¼Œå¦åˆ™ <code class=\"language-text\">x</code> çš„å€¼å°±æ˜¯ <code class=\"language-text\">foo</code> æœ¬èº«ã€‚è¿™ä¸€è¡Œä¸ºï¼Œä¸€èˆ¬ä¼šè¢«ç”¨äºç»™å˜é‡èµ‹åˆå§‹å€¼ã€‚åœ¨ä¹‹å‰çš„ JavaScript / TypeScript ä¸­ï¼Œä¸€èˆ¬ä¼šè¿™ä¹ˆå†™ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getNumber</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> num <span class=\"token operator\">||</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ä½†æ˜¯ï¼Œè¿™æ ·å†™æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å½“ <code class=\"language-text\">num</code> çš„å€¼æ˜¯ <code class=\"language-text\">0</code> çš„æ—¶å€™ï¼Œæœ€ç»ˆçš„å€¼ä¾ç„¶æ˜¯ <code class=\"language-text\">5</code> è€Œä¸æ˜¯ <code class=\"language-text\">0</code>ã€‚è¿™ä¸€è¡Œä¸ºå¾ˆå¯èƒ½å¹¶ä¸æ˜¯å¼€å‘è€…å¸Œæœ›çš„ã€‚</p>\n<p>å’Œ Optional Chaining ä¸€æ ·ï¼ŒNullish Coalescing åªæœ‰åœ¨åŸå€¼æ˜¯ <code class=\"language-text\">null</code> æˆ–è€… <code class=\"language-text\">undefined</code> çš„æ—¶å€™ï¼Œæ‰è¿›è¡Œæ“ä½œï¼›å…¶ä»–çš„ falsy å€¼ï¼Œéƒ½ä¼šä¿æŒåŸæ ·ï¼Œå¹¶ä¸ä¼šåšç‰¹æ®Šçš„å¤„ç†ï¼ˆæ ¹æ® <a href=\"https://github.com/tc39/proposal-nullish-coalescing/blob/master/README.md#overview-and-motivation\">Proposal</a> ä¸­çš„è¯´æ˜ï¼Œè¿™ä¸¤ä¸ªè§„èŒƒå°†ä¼šåœ¨â€œä½•æ—¶å¤„ç†â€ä¸Šä¿æŒä¸€è‡´ï¼‰ã€‚è¿™å¾ˆå¤§ç¨‹åº¦ä¸Šå‡å°‘äº† JavaScript åœ¨ç±»å‹ä¸Šå¯¼è‡´éšè—é—®é¢˜çš„å¯èƒ½æ€§ã€‚</p>\n<p>éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè¿™ä¸€è¡Œä¸ºå’Œ JavaScript ä¸­çš„é»˜è®¤å‚æ•°æ˜¯æœ‰ä¸€ç‚¹ä¸ä¸€æ ·çš„ã€‚ä¸Šé¢çš„ä»£ç å¦‚æœæ”¹å†™æˆé»˜è®¤å‚æ•°çš„å½¢å¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">function</span> <span class=\"token function\">getNumber</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">num<span class=\"token punctuation\">:</span> <span class=\"token builtin\">number</span> <span class=\"token operator\">=</span> <span class=\"token number\">5</span></span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> num<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>é‚£ä¹ˆï¼Œå°†ä¼šåœ¨ <code class=\"language-text\">getNumber(null)</code> çš„æ—¶å€™äº§ç”Ÿè¡Œä¸ºä¸Šçš„åˆ†æ­§ã€‚ä½¿ç”¨ Nullish Coalescing å°†ä¼šè¿”å› <code class=\"language-text\">5</code>ï¼Œä¹Ÿå°±æ˜¯è¿›è¡Œäº†é»˜è®¤å€¼èµ‹å€¼ï¼›è€Œé»˜è®¤å‚æ•°çš„æ–¹æ¡ˆå°†ä¼šè¿”å› <code class=\"language-text\">null</code>ï¼Œå› ä¸ºé»˜è®¤å‚æ•°åªæœ‰åœ¨ <code class=\"language-text\">undefined</code> çš„æƒ…å†µä¸‹æ‰ä¼šè¿›è¡Œé»˜è®¤å€¼èµ‹å€¼æ“ä½œã€‚</p>\n<p>Optional Chaining å’Œ Nullish Coalescing å¯ä»¥æ”¾åœ¨ä¸€èµ·æ“ä½œï¼Œç¡®ä¿å€¼ä¸å­˜åœ¨çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªå…œåº•çš„é»˜è®¤å€¼å¯ä»¥ç»™ç¨‹åºä½¿ç”¨ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> foo<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>bar<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">?</span><span class=\"token operator\">?</span> <span class=\"token string\">'default'</span><span class=\"token punctuation\">;</span></code></pre></div>","frontmatter":{"date":"2019-11-11","title":"Nullish Coalescing","category":"TypeScript"}}},{"node":{"id":"d7ace064-8159-5fe0-ba4d-0b04683a001d","html":"<p>åœ¨ JavaScript ä¸­ï¼Œæ–°çš„<a href=\"https://github.com/tc39/proposal-object-rest-spread\">è§„èŒƒ</a>å®šä¹‰äº† object rest spread è¿ç®—ç¬¦ï¼Œå¯ä»¥ç”¨äºå¯¹è±¡çš„è§£æ„ã€‚</p>\n<p>ç®€å•çš„ç”¨æ³•å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span> others<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>é™¤äº†è¿™ç§è§£æ„åŒæ—¶èµ‹å€¼ç»™æ–°å˜é‡çš„æƒ…å†µï¼Œä¹Ÿå¯ä»¥é€šè¿‡è§£æ„è¿ç®—ï¼Œèµ‹å€¼ç»™ä¸€ä¸ªå·²æœ‰çš„å˜é‡ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token string\">'old'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">:</span> <span class=\"token string\">'new'</span><span class=\"token punctuation\">,</span> others<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œè§£æ„åŠ èµ‹å€¼çš„è¿ç®—ï¼Œå¿…é¡»è¦åŠ ä¸Šæ‹¬å·ã€‚ä¸‹é¢çš„å†™æ³•ä¼šæŠ¥è¯­æ³•é”™è¯¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">let</span> value <span class=\"token operator\">=</span> <span class=\"token string\">'old'</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">{</span> value <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> value<span class=\"token punctuation\">:</span> <span class=\"token string\">'new'</span><span class=\"token punctuation\">,</span> others<span class=\"token punctuation\">:</span> <span class=\"token string\">'value'</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ä¼šæŠ¥é”™çš„åŸå› æ˜¯ï¼Œå‰é¢çš„ <code class=\"language-text\">{ value } =</code>ï¼Œå¦‚æœä¸åŠ ä¸Šæ‹¬å·ï¼Œä¼šè¢«å½“æˆä¸€èˆ¬çš„ä»£ç å—ï¼ˆBlockï¼‰ï¼Œè€Œä¸æ˜¯ä¸€ä¸ªè§£æ„çš„å¯¹è±¡ï¼ˆObjectï¼‰ï¼Œå› æ­¤è§£æè¯­æ³•æ ‘çš„æ—¶å€™ï¼Œåœ¨ <code class=\"language-text\">=</code> è¿™é‡Œå°±æŠ¥é”™äº†ï¼ˆ<code class=\"language-text\">Uncaught SyntaxError: Unexpected token &#39;=&#39;</code>ï¼‰ã€‚æ³¨ï¼šå¦‚æœä¸åŠ æœ€åçš„ <code class=\"language-text\">;</code>ï¼Œè¯­æ³•ä¹Ÿæ˜¯æ­£ç¡®çš„ã€‚</p>\n<p>æ›´å¤šç›¸å…³çš„ç›¸å…³ä»‹ç»ï¼Œå¯ä»¥å‚è€ƒ <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/Destructuring_assignment#Object_destructuring\">MDN</a>ã€‚</p>","frontmatter":{"date":"2019-11-07","title":"Object Deconstructing without Declaration","category":"JavaScript"}}},{"node":{"id":"04dc3c68-fa9d-535f-94d9-f7a404f1d2dc","html":"<p>åœ¨ TC39 å°† <a href=\"https://github.com/tc39/proposal-optional-chaining/\">Optional Chaining</a> è½¬ç§»åˆ° Stage 3 ä¹‹åï¼ŒTypeScript åœ¨ 3.7 ç‰ˆæœ¬ä¸­ä¹Ÿå¸¦æ¥äº†å¯¹åº”çš„ Optional Chaining åŠŸèƒ½ã€‚æ€»ä½“ä¸Šï¼ŒTypeScript çš„ Optional Chaining åŠŸèƒ½å’Œ JavaScript çš„ææ¡ˆæ˜¯ä¿æŒä¸€è‡´çš„ã€‚æ€»ç»“æ¥è¯´ï¼Œå°±æ˜¯ï¼š</p>\n<blockquote>\n<p>å¦‚æœå±æ€§å€¼æ˜¯ <code class=\"language-text\">undefined</code> æˆ–è€… <code class=\"language-text\">null</code>ï¼Œå°±ä¼šç›´æ¥è¿”å› <code class=\"language-text\">undefined</code>ï¼Œå¦åˆ™ä¼šè¿›ä¸€æ­¥è·å–çœŸå®çš„å±æ€§å€¼ã€‚</p>\n</blockquote>\n<p>åœ¨ <a href=\"https://www.typescriptlang.org/play/index.html\">TypeScript Playground</a> ä¸­å¯ä»¥å°è¯•ä¸€ä¸‹è¿™ä¸ªæ–°çš„åŠŸèƒ½ã€‚ä»¥ä¸‹é¢è¿™æ®µ TypeScript ä¸ºä¾‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> foo<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span>bar<span class=\"token operator\">?</span><span class=\"token punctuation\">.</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>æœ€ç»ˆä¼šè¢«è½¬è¯‘æˆä¸‹é¢çš„è¿™æ®µ JavaScriptï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token string\">\"use strict\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">var</span> _a<span class=\"token punctuation\">,</span> _b<span class=\"token punctuation\">,</span> _c<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">let</span> x <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>_c <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>_a <span class=\"token operator\">=</span> foo<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> _a <span class=\"token operator\">===</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span>\n  <span class=\"token keyword\">void</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span>\n  <span class=\"token punctuation\">(</span>_b <span class=\"token operator\">=</span> _a<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>bar<span class=\"token punctuation\">)</span> <span class=\"token operator\">===</span> <span class=\"token keyword\">null</span> <span class=\"token operator\">||</span> _c <span class=\"token operator\">===</span> <span class=\"token keyword\">void</span> <span class=\"token number\">0</span> <span class=\"token operator\">?</span>\n    <span class=\"token keyword\">void</span> <span class=\"token number\">0</span> <span class=\"token punctuation\">:</span>\n    <span class=\"token function\">_c</span><span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span>_b<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å‡ ç‚¹ç®€å•çš„è¯´æ˜ï¼š</p>\n<ol>\n<li>å³ä½¿å€¼æ˜¯ <code class=\"language-text\">null</code>ï¼Œæœ€ç»ˆè¿”å›çš„ç»“æœä¹Ÿä¼šæ˜¯ <code class=\"language-text\">undefined</code>ï¼ˆä¸Šé¢ä»£ç ä¸­æ˜¯ <code class=\"language-text\">void 0</code>ï¼Œæ˜¯ç­‰ä»·çš„ï¼‰ï¼›</li>\n<li>åªæœ‰ <code class=\"language-text\">null</code> å’Œ <code class=\"language-text\">undefined</code> çš„æƒ…å†µä¼šè¢«ç›´æ¥è¿”å›ã€‚è¿™ä¸€ç‚¹ï¼Œå’Œä¹‹å‰ <code class=\"language-text\">foo &amp;&amp; foo.bar</code> è¿™æ ·çš„å†™æ³•æ˜¯æœ‰åŒºåˆ«çš„ã€‚ä¸»è¦æ˜¯ JavaScript å¯¹å“ªäº›å€¼æ˜¯ falsy çš„åˆ¤æ–­ï¼ŒèŒƒå›´ä¼šæ¯” <code class=\"language-text\">null</code> &#x26; <code class=\"language-text\">undefined</code> æ›´å¹¿ï¼Œè¿˜åŒ…æ‹¬äº† <code class=\"language-text\">NaN</code>ï¼Œ<code class=\"language-text\">0</code>ï¼Œ<code class=\"language-text\">false</code> ç­‰ï¼›</li>\n<li>Optional Chaining åœ¨å‡½æ•°è°ƒç”¨ä¸­ä¹Ÿæ˜¯å¯ä»¥ç”¨çš„ï¼Œå†™æ³•æ˜¯ <code class=\"language-text\">xx?.()</code>ï¼Œå¦‚æœä¸å­˜åœ¨ï¼Œå‡½æ•°ä¸ä¼šè°ƒç”¨ï¼Œè€Œæ˜¯ç›´æ¥è¿”å› <code class=\"language-text\">undefined</code>ï¼›</li>\n<li>Optional Chaining ä¹Ÿå¯ä»¥ä½¿ç”¨å¦‚ä¸‹çš„å†™æ³•ï¼š<code class=\"language-text\">foo?.[0]</code>ï¼Œ <code class=\"language-text\">foo?.[&#39;var-name&#39;]</code> æˆ– <code class=\"language-text\">foo?.[variableName]</code></li>\n</ol>\n<p>å®˜æ–¹çš„å‘å¸ƒä»‹ç»æ–‡æ¡£è§<a href=\"https://devblogs.microsoft.com/typescript/announcing-typescript-3-7/#optional-chaining\">è¿™é‡Œ</a>ã€‚</p>","frontmatter":{"date":"2019-11-06","title":"Optional Chaining in TypeScript","category":"TypeScript"}}},{"node":{"id":"4c12371e-1261-52ed-8522-aacc2f3a7626","html":"<p><code class=\"language-text\">console.assert</code> API å¯ä»¥ç”¨äºåˆ¤æ–­æŸä¸ªæ¡ä»¶æ˜¯å¦æ»¡è¶³ï¼Œå¹¶åœ¨ä¸æ»¡è¶³çš„æ—¶å€™ï¼Œåœ¨ Console é‡Œæ‰“å°å‡ºç›¸å…³çš„æ•°æ®ã€‚æ•´ä½“ API å’Œ <code class=\"language-text\">console.error</code> æ¯”è¾ƒç±»ä¼¼ï¼Œä½†æ˜¯ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ä¸€ä¸ªåˆ¤æ–­æ¡ä»¶ã€‚æ•´ä¸ªè°ƒç”¨ï¼Œåªä¼šåœ¨ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯ falsy å€¼çš„æ—¶å€™ï¼Œæ‰ä¼šå°†åé¢çš„æ•°æ®æ‰“å°å‡ºæ¥ã€‚æ‰“å°çš„æ–¹å¼å’Œ <code class=\"language-text\">console.error</code> ç±»ä¼¼ï¼Œè¾“å‡ºçš„æ˜¯ error ä¿¡æ¯ã€‚éœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯ï¼Œæ ¹æ® <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Console/assert\">MDN</a> çš„æè¿°ï¼Œåœ¨ Node.js 10 ç‰ˆæœ¬å‰ï¼Œé™¤äº†è¾“å‡ºä¹‹å¤–ï¼Œè¿˜ä¼šæŠ›å‡ºä¸€ä¸ª <code class=\"language-text\">AssertionError</code>ã€‚è¿™ä¸ªè¡Œä¸ºæ˜¯é”™è¯¯çš„ï¼Œconsole API ä¸åº”è¯¥å½±å“ä¸»æµç¨‹çš„ä»£ç ï¼ŒNode.js åœ¨ 10 ä¿®å¤äº†é—®é¢˜ã€‚</p>\n<p>ä¸‹é¢æ˜¯ä¸€æ®µç¤ºä¾‹ä»£ç ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'before'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">assert</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'incorrect with error message'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'after'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¾“å‡ºçš„ç»“æœæ˜¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">before\nincorrect with error message\nafter</code></pre></div>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">incorrect with error message</code> è¿™ä¸€æ¡ï¼Œè¿˜ä¼šé¢å¤–è¾“å‡ºè°ƒç”¨çš„å †æ ˆä¿¡æ¯ï¼Œæ–¹ä¾¿è°ƒè¯•ã€‚</p>\n<p>æ€»ç»“æ¥è¯´ï¼Œåœ¨ä»£ç ä¸­å®ç°ç±»ä¼¼ Chrome ä¸­ conditional breakpointï¼Œä½¿ç”¨ <code class=\"language-text\">console.assert</code> æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼šåªåœ¨å‡ºç°é—®é¢˜çš„æ—¶å€™æ‰“å°å¿…è¦çš„ä¿¡æ¯ï¼Œå¯ä»¥å°½å¯èƒ½çš„å‡å°‘å¯¹ Console è¾“å‡ºçš„æ±¡æŸ“ã€‚</p>","frontmatter":{"date":"2019-11-05","title":"console.assert","category":"JavaScript"}}},{"node":{"id":"df525546-37d6-5170-90fd-2fe8e78bc734","html":"<p><code class=\"language-text\">console.trace</code> API æ”¯æŒå¯é€‰å‚æ•°ï¼Œè¾“å‡ºçš„æ•ˆæœå’Œ <code class=\"language-text\">console.log</code> / <code class=\"language-text\">console.info</code> ç±»ä¼¼ã€‚ä½†æ˜¯é™¤äº†è¾“å‡ºå‚æ•°æŒ‡å®šçš„å†…å®¹ä¹‹å¤–ï¼Œè¿˜ä¼šè¿å¸¦å°†å½“å‰çš„è°ƒç”¨å †æ ˆä¸€èµ·è¾“å‡ºã€‚å¯ä»¥çœ‹ <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/Console/trace\">MDN</a> ä¸­ç»™å‡ºçš„ä¸€ä¸ªä¾‹å­ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">trace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¾“å‡ºçš„ç»“æœç±»ä¼¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">bar\nfoo\n&lt;anonymous&gt;</code></pre></div>\n<p>å…¶ä¸­ï¼Œ<code class=\"language-text\">&lt;anonymous&gt;</code> æ˜¯å› ä¸º <code class=\"language-text\">foo</code> å‡½æ•°æ˜¯åœ¨ console ä¸­ç›´æ¥è¿è¡Œçš„ã€‚å½“ç„¶ï¼Œè¿™ä¸ªåªèƒ½åœ¨è°ƒè¯•é˜¶æ®µè¿›è¡Œä»£ç çš„æ£€æŸ¥ã€‚å¦‚æœéœ€è¦åœ¨çº¿ä¸Šç¯å¢ƒï¼Œå¯¹å¯èƒ½å‡ºé—®é¢˜çš„åœ°æ–¹æ”¶é›†è°ƒç”¨å †æ ˆä¿¡æ¯ï¼Œç›´æ¥ä½¿ç”¨ <code class=\"language-text\">console.trace</code> å°±ä¸æ»¡è¶³éœ€æ±‚äº†ã€‚å¯ä»¥è½¬è€Œä½¿ç”¨ Error ä¸­çš„ stack å­—æ®µï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">function</span> <span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">function</span> <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> error <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Error</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>error<span class=\"token punctuation\">.</span>stack<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">bar</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token function\">foo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¾“å‡ºç»“æœç±»ä¼¼ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"plain\"><pre class=\"language-plain\"><code class=\"language-plain\">Error\n    at bar (&lt;anonymous&gt;:3:19)\n    at foo (&lt;anonymous&gt;:6:3)\n    at &lt;anonymous&gt;:9:1</code></pre></div>","frontmatter":{"date":"2019-11-04","title":"console.trace","category":"JavaScript"}}},{"node":{"id":"0e49e733-98a8-5e79-bcb5-c4ef0b27aaf8","html":"<p>åœ¨ Node.js ä¸­ï¼Œå¯ä»¥é€šè¿‡ä½¿ç”¨ Performance API æ¥å¯¹ <code class=\"language-text\">require</code> æ¨¡å—çš„æ€§èƒ½è¿›è¡Œæ£€æµ‹ã€‚è¿™é‡Œçš„ Performance æ¨¡å—ï¼Œæ˜¯ Node.js æ ¹æ® <a href=\"https://w3c.github.io/performance-timeline/\">W3C Performance Timeline è§„èŒƒ</a>ï¼Œå®ç°çš„ä¸€å¥—å’Œ Web ç›¸åŒçš„ API æ¥å£é›†åˆã€‚ä¸€èˆ¬çš„æ—¶é—´æµ‹é‡ï¼Œå¯ä»¥é€šè¿‡ <code class=\"language-text\">Performance.mark</code> å’Œ <code class=\"language-text\">Performance.measure</code> çš„ç»„åˆæ¥è¿›è¡Œï¼Œä½¿ç”¨çš„æ–¹æ³•å¤§ä½“ä¸Šå’Œ Web ä¸­ä¸€è‡´ï¼ˆä½†æ˜¯éœ€è¦ä½¿ç”¨ <code class=\"language-text\">PerformanceObserver</code> æ¥è·å–æµ‹é‡çš„ç»“æœï¼Œè¿™ä¸€ç‚¹å’Œ Web ä¸å¤ªç›¸åŒï¼Œå…·ä½“å¯ä»¥å‚è€ƒå®˜æ–¹çš„<a href=\"https://nodejs.org/api/perf_hooks.html\">æ–‡æ¡£</a>ï¼‰ã€‚</p>\n<p>å’Œ Web ä¸åŒçš„æ˜¯ï¼Œåœ¨ Node.js çš„ Performance æ¨¡å—ä¸­ï¼Œè¿˜æä¾›äº†ä¸€ä¸ª <a href=\"https://nodejs.org/api/perf_hooks.html#perf_hooks_performance_timerify_fn\">timerify</a> çš„æ¥å£ï¼Œå¯ä»¥ç®€ä¾¿çš„å¯¹ä¸€ä¸ªå‡½æ•°è¿›è¡Œå°è£…ï¼Œä»è€Œæµ‹é‡å‡ºè¿™ä¸ªå‡½æ•°çš„å®é™…è°ƒç”¨æ—¶é—´ã€‚</p>\n<p>æœ‰äº†è¿™ä¸ªæ¥å£ï¼Œå°±å¯ä»¥å¾ˆå®¹æ˜“çš„æµ‹é‡ Node.js ä¸­åŠ è½½æ¨¡å—çš„è€—æ—¶äº†ã€‚ç¤ºä¾‹ä»£ç å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span>\n  performance<span class=\"token punctuation\">,</span>\n  PerformanceObserver\n<span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'perf_hooks'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> fs <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'fs'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> mod <span class=\"token operator\">=</span> <span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'module'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nmod<span class=\"token punctuation\">.</span><span class=\"token class-name\">Module</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>require <span class=\"token operator\">=</span>\n  performance<span class=\"token punctuation\">.</span><span class=\"token function\">timerify</span><span class=\"token punctuation\">(</span>mod<span class=\"token punctuation\">.</span><span class=\"token class-name\">Module</span><span class=\"token punctuation\">.</span>prototype<span class=\"token punctuation\">.</span>require<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> obs <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">PerformanceObserver</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">list</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> entries <span class=\"token operator\">=</span> list<span class=\"token punctuation\">.</span><span class=\"token function\">getEntries</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">'./profile.json'</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>entries<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'utf8'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  obs<span class=\"token punctuation\">.</span><span class=\"token function\">disconnect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nobs<span class=\"token punctuation\">.</span><span class=\"token function\">observe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  entryTypes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">'function'</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  name<span class=\"token punctuation\">:</span> <span class=\"token string\">'Module.require'</span><span class=\"token punctuation\">,</span>\n  buffered<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">require</span><span class=\"token punctuation\">(</span><span class=\"token string\">'some-path'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>è¿™é‡Œæœ‰å‡ ç‚¹å¯ä»¥è¯´æ˜ä¸€ä¸‹ï¼š</p>\n<ol>\n<li><code class=\"language-text\">mod.Module.prototype.require</code> è¢« <code class=\"language-text\">timerify</code> ä¹‹åï¼Œæ‰€æœ‰æ¨¡å—åœ¨ <code class=\"language-text\">require</code> çš„æ—¶å€™ï¼Œéƒ½ä¼šä½¿ç”¨è¢« <code class=\"language-text\">timerify</code> è¿‡çš„ç‰ˆæœ¬ï¼›</li>\n<li>PerformanceObserver çš„ä½œç”¨æ˜¯è·å– entries çš„ç»“æœï¼›</li>\n<li><code class=\"language-text\">obs.disconnect</code> ç”¨äºè§£é™¤è¿æ¥ï¼Œä¸å†è¿›è¡Œåç»­çš„æ¥å¬ï¼›</li>\n<li><code class=\"language-text\">obs.observer</code> è®¾ç½® <code class=\"language-text\">entryTypes: [&#39;function&#39;]</code>ï¼Œç¡®ä¿è¿™é‡Œ <code class=\"language-text\">timerify</code> çš„ç»“æœéƒ½å¯ä»¥è¢«è·å–åˆ°ï¼›</li>\n<li><code class=\"language-text\">obs.observer</code> ä¸­è®¾ç½® <code class=\"language-text\">buffered: true</code>ï¼Œç¡®ä¿ observer çš„å›è°ƒå‡½æ•°ä¸ä¼šè¢«ç«‹åˆ»æ‰§è¡Œï¼Œè€Œæ˜¯ç”¨ <code class=\"language-text\">setImmediate</code> å»¶è¿Ÿè°ƒç”¨ã€‚è¿™æ ·çš„å¥½å¤„æ˜¯ï¼Œä¸€æ¬¡ <code class=\"language-text\">require</code> åï¼Œè¯¥æ¨¡å—çš„è°ƒç”¨æ—¶é—´å’Œè¯¥æ¨¡å—å†…éƒ¨è°ƒç”¨å­æ¨¡å—çš„è€—æ—¶éƒ½ä¼šä¸€æ¬¡æ€§é€šè¿‡å›è°ƒå‡½æ•°è¿”å›ã€‚ï¼ˆæ³¨ï¼šé»˜è®¤è¿™é‡Œçš„å€¼æ˜¯ <code class=\"language-text\">false</code>ï¼Œè§<a href=\"https://nodejs.org/docs/latest-v10.x/api/perf_hooks.html#perf_hooks_performanceobserver_observe_options\">æ–‡æ¡£</a>ï¼‰;</li>\n<li>å®˜æ–¹ç»™å‡ºçš„ç¤ºä¾‹ï¼Œè¿˜ <code class=\"language-text\">timerify</code> äº† <code class=\"language-text\">require</code> å‡½æ•°ï¼ˆè§<a href=\"https://nodejs.org/api/perf_hooks.html#perf_hooks_measuring_how_long_it_takes_to_load_dependencies\">è¿™é‡Œ</a>ï¼‰ï¼Œè¿™æ ·åšä¼šå¯¼è‡´å½“å‰æ¨¡å—ä¸­ <code class=\"language-text\">require</code> çš„è°ƒç”¨ï¼Œç”Ÿæˆä¸¤ä»½ Performance æ•°æ®ï¼ˆä¸€ä»½æ¥è‡ª <code class=\"language-text\">require</code>ï¼Œä¸€ä»½æ¥è‡ª <code class=\"language-text\">Module.require</code>ï¼‰ã€‚å‡ºäºç²¾ç®€çš„è€ƒè™‘ï¼Œä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­å»æ‰äº†å¯¹ <code class=\"language-text\">require</code> å‡½æ•°çš„ <code class=\"language-text\">timerify</code>ã€‚</li>\n</ol>\n<p>åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä»£ç ä¸­ï¼Œæœ€ç»ˆå¾—åˆ°çš„ç»“æœï¼Œå­˜æ”¾åœ¨äº†ä¸€ä¸ª JSON æ–‡ä»¶å†…ï¼Œå¤§ä½“çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"0\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"required-module-name\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"name\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"Module.require\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"entryType\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"function\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"startTime\"</span><span class=\"token operator\">:</span> <span class=\"token number\">7397.399892</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"duration\"</span><span class=\"token operator\">:</span> <span class=\"token number\">112.681678</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>è¿™é‡Œï¼Œ<code class=\"language-text\">0</code> è¡¨ç¤ºç¬¬ä¸€ä¸ªå‚æ•°çš„å€¼ï¼Œå¯¹äº <code class=\"language-text\">require</code> æ¥è¯´å°±æ˜¯å…·ä½“å¼•ç”¨çš„æ¨¡å—çš„åç§°/åœ°å€ï¼›<code class=\"language-text\">name</code> è¡¨ç¤ºæ˜¯å“ªä¸ªå‡½æ•°çš„è°ƒç”¨ï¼Œåœ¨ç¤ºä¾‹ä¸­å°±æ˜¯è¢« <code class=\"language-text\">timerify</code> è¿‡çš„ <code class=\"language-text\">Module.require</code> å‡½æ•°ï¼›<code class=\"language-text\">entryType</code> æ˜¯å›ºå®šçš„ <code class=\"language-text\">function</code>ï¼Œå› ä¸ºè¿™ä¸ªå€¼æ˜¯é€šè¿‡ <code class=\"language-text\">timerify</code> æ‹¿åˆ°çš„ï¼›<code class=\"language-text\">startTime</code> å’Œ <code class=\"language-text\">duration</code> åˆ†åˆ«è¡¨ç¤ºè°ƒç”¨å¼€å§‹çš„æ—¶é—´ä»¥åŠå®é™…è°ƒç”¨çš„è€—æ—¶ã€‚</p>","frontmatter":{"date":"2019-11-03","title":"Require Performance in Node.js","category":"Node.js"}}}]}},"pageContext":{"isCreatedByStatefulCreatePages":false,"startInMonth":"2019-11-01","endInMonth":"2019-11-31","time":"2019-11","previous":"2019-10","next":null}}}